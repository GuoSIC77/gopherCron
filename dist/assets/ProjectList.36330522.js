var me=Object.defineProperty,pe=Object.defineProperties;var fe=Object.getOwnPropertyDescriptors;var G=Object.getOwnPropertySymbols;var we=Object.prototype.hasOwnProperty,ve=Object.prototype.propertyIsEnumerable;var K=(t,l,o)=>l in t?me(t,l,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[l]=o,W=(t,l)=>{for(var o in l||(l={}))we.call(l,o)&&K(t,o,l[o]);if(G)for(var o of G(l))ve.call(l,o)&&K(t,o,l[o]);return t},X=(t,l)=>pe(t,fe(l));import{j as I,c as x,B as ge,u as N,l as v,m as h,z as d,A as L,r as _,o as ee,k as ye,q as a,s as e,E as j,f as S,Q,a as _e,h as xe,b as be,g as ke,w as he,x as g,N as te,I as D,J as Y,F as $,ct as Ve,cm as R,cu as je,cv as Qe,c3 as P,y as O,cw as Ce,bp as le,t as z,aI as oe,D as ae}from"./index.858abf03.js";import{Q as F}from"./QInput.39515e5e.js";import{Q as se}from"./QList.53c0d763.js";import{Q as Ee}from"./QScrollArea.ce37051a.js";import{_ as ne}from"./Confirm.200ef114.js";import{a as E,b as H,Q as J,c as $e,r as Se}from"./QDialog.eb528cda.js";import{Q as Be}from"./QForm.44afa5f8.js";import{C as B,Q as ue}from"./ClosePopup.411262dd.js";import{a as q,b as A,Q as T}from"./QItem.b0539e07.js";import{Q as Ie}from"./QBtnDropdown.2416f369.js";import{u as De,a as Fe}from"./focus-manager.2ec597e1.js";import{Q as M}from"./QSeparator.d5e61ebf.js";import{Q as Ue}from"./QSelect.b4c9e565.js";import{f as Pe}from"./datetime.6205e5a7.js";import{t as qe,b as Ae}from"./thumbStyle.856de4cb.js";import"./use-key-composition.89abe8dc.js";import"./uid.42677368.js";import"./use-prevent-scroll.a5760f87.js";import"./touch.9357bf86.js";import"./format.865294d5.js";import"./QChip.48edc830.js";import"./rtl.b51694b1.js";const re=I({props:{projectId:{type:Number,required:!0},modelValue:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(t,{emit:l}){const o=t,i=x({get:()=>o.modelValue,set:f=>l("update:modelValue",f)}),c=ge(),m=N(),w=x(()=>m.state.Project.projects.find(f=>f.id===o.projectId));async function p(f){m.commit("cleanError"),await m.dispatch("deleteProject",{projectId:f}),m.state.Root.currentError===void 0&&(c.push({name:"projects"}),i.value=!1)}return(f,y)=>{var b;return v(),h(ne,{modelValue:d(i),"onUpdate:modelValue":y[0]||(y[0]=s=>L(i)?i.value=s:null),content:"\u662F\u5426\u8981\u5220\u9664\u9879\u76EE"+((b=d(w))==null?void 0:b.title)+"?",type:"warning",onConfirm:y[1]||(y[1]=s=>d(w)&&p(d(w).id))},null,8,["modelValue","content"])}}}),Te={key:0,class:"text-h6"},Ne={key:1,class:"text-h6"},ie=I({props:{projectId:{type:Number,default:0},modelValue:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(t,{emit:l}){const o=t,i=x({get:()=>o.modelValue,set:s=>l("update:modelValue",s)}),c=N(),m=x(()=>c.state.Project.projects.find(s=>s.id===o.projectId)),w=x(()=>{const s=m.value;return{title:(s==null?void 0:s.title)||"",remark:(s==null?void 0:s.remark)||""}}),p=_(w.value),f=x(()=>{const s=p.value,u=w.value;return s.title.trim()===u.title.trim()&&s.remark.trim()===u.remark.trim()}),y=x(()=>p.value.title.trim()!==""&&!f.value);ee(()=>{ye(()=>{i.value||(p.value=Object.assign({},w.value))})});async function b(){const s=p.value;c.commit("cleanError"),o.projectId>0?await c.dispatch("updateProject",{projectId:o.projectId,title:s.title.trim(),remark:s.remark.trim()}):await c.dispatch("createProject",{title:s.title.trim(),remark:s.remark.trim()}),c.state.Root.currentError===void 0&&(i.value=!1)}return(s,u)=>(v(),h(J,{modelValue:d(i),"onUpdate:modelValue":u[2]||(u[2]=r=>L(i)?i.value=r:null),"no-backdrop-dismiss":!d(f)},{default:a(()=>[e(H,{class:"tw-w-96 q-pa-sm"},{default:a(()=>[e(Be,{onSubmit:b},{default:a(()=>[e(E,null,{default:a(()=>[d(m)===void 0?(v(),j("div",Te,"\u521B\u5EFA\u9879\u76EE")):(v(),j("div",Ne,"\u7F16\u8F91\u9879\u76EE"))]),_:1}),e(E,null,{default:a(()=>[e(F,{modelValue:p.value.title,"onUpdate:modelValue":u[0]||(u[0]=r=>p.value.title=r),type:"text",label:"\u9879\u76EE\u540D",square:"",filled:"",class:"tw-mb-4"},null,8,["modelValue"]),e(F,{modelValue:p.value.remark,"onUpdate:modelValue":u[1]||(u[1]=r=>p.value.remark=r),type:"textarea",label:"\u5907\u6CE8",square:"",filled:""},null,8,["modelValue"])]),_:1}),e(E,{align:"right",class:"tw-flex tw-gap-4 tw-flex-col-reverse lg:tw-flex-row lg:tw-justify-end"},{default:a(()=>[S(e(Q,{flat:"",label:"\u53D6\u6D88",class:"lg:tw-w-24 tw-w-full"},null,512),[[B]]),e(Q,{color:"primary","text-color":"black",type:"submit",label:d(m)===void 0?"\u521B\u5EFA":"\u4FDD\u5B58",disable:!d(y),class:"lg:tw-w-24 tw-w-full"},null,8,["label","disable"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","no-backdrop-dismiss"]))}}),Re=["text","rect","circle","QBtn","QBadge","QChip","QToolbar","QCheckbox","QRadio","QToggle","QSlider","QRange","QInput","QAvatar"],ze=["wave","pulse","pulse-x","pulse-y","fade","blink","none"];var Me=_e({name:"QSkeleton",props:X(W({},De),{tag:{type:String,default:"div"},type:{type:String,validator:t=>Re.includes(t),default:"rect"},animation:{type:String,validator:t=>ze.includes(t),default:"wave"},animationSpeed:{type:[String,Number],default:1500},square:Boolean,bordered:Boolean,size:String,width:String,height:String}),setup(t,{slots:l}){const o=ke(),i=Fe(t,o.proxy.$q),c=x(()=>{const w=t.size!==void 0?[t.size,t.size]:[t.width,t.height];return{"--q-skeleton-speed":`${t.animationSpeed}ms`,width:w[0],height:w[1]}}),m=x(()=>`q-skeleton q-skeleton--${i.value===!0?"dark":"light"} q-skeleton--type-${t.type}`+(t.animation!=="none"?` q-skeleton--anim q-skeleton--anim-${t.animation}`:"")+(t.square===!0?" q-skeleton--square":"")+(t.bordered===!0?" q-skeleton--bordered":""));return()=>xe(t.tag,{class:m.value,style:c.value},be(l.default))}});function Oe(t){const l=document.createElement("textarea");l.value=t,l.contentEditable="true",l.style.position="fixed";const o=()=>{};$e(o),document.body.appendChild(l),l.focus(),l.select();const i=document.execCommand("copy");return l.remove(),Se(o),i}function Le(t){return navigator.clipboard!==void 0?navigator.clipboard.writeText(t):new Promise((l,o)=>{const i=Oe(t);i?l(!0):o(i)})}function Ye(t){return t?t.indexOf("manager")!==-1||t.indexOf("admin")!==-1:!1}const de=[{value:"admin",label:"\u7BA1\u7406\u5458"},{value:"manager",label:"\u53EF\u7F16\u8F91"},{value:"user",label:"\u4EC5\u67E5\u770B"}],ce=new Map;de.forEach((t,l,o)=>{ce.set(t.value,t.label)});function He(t){return ce.get(t)}const Je=g("div",{class:"text-h6"},"\u9879\u76EE\u6210\u5458\u7BA1\u7406",-1),Ge=$(" \u6DFB\u52A0 "),Ke={role:"list",class:"tw-divide-y tw-divide-white/5"},We={class:"tw-min-w-0 tw-flex-auto"},Xe={class:"tw-flex tw-items-center tw-gap-x-3"},Ze=g("div",{class:"flex-none rounded-full p-1"},[g("div",{class:"tw-h-2 tw-w-2 tw-rounded-full tw-bg-current"})],-1),et={class:"tw-min-w-0 tw-text-sm tw-font-semibold tw-leading-6 tw-text-white"},tt={class:"tw-flex tw-gap-x-2"},lt={class:"tw-whitespace-nowrap"},ot=g("span",{class:"tw-text-gray-400"}," - ",-1),at={class:"tw-whitespace-nowrap tw-opacity-75"},st={class:"tw-mt-1 tw-flex tw-items-center tw-gap-x-2.5 tw-text-xs tw-leading-5 tw-text-gray-400"},nt={class:"tw-truncate"},ut=g("svg",{viewbox:"0 0 2 2",class:"tw-h-0.5 tw-w-0.5 tw-flex-none tw-fill-gray-300"},[g("circle",{cx:"1",cy:"1",r:"1"})],-1),rt={class:"tw-whitespace-nowrap"},it={class:"rounded-full flex-none py-1 px-2 text-xs font-medium ring-1 ring-inset"},dt=$("\u79FB\u9664"),Z=I({props:{projectId:{type:Number,default:0},modelValue:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(t,{emit:l}){const o=t,i=_("user"),c=x({get:()=>o.modelValue,set:C=>l("update:modelValue",C)}),m=_([]);async function w(){m.value=await Ve(R,o.projectId)}he(()=>[o.projectId,c.value],async([,C])=>{C&&w(),p.value=""});const p=_(""),f=_(!1);async function y(){f.value=!0;try{await je(R,o.projectId,p.value,i.value),p.value="",await w()}finally{f.value=!1}}const b=_(),s=_(!1);function u(C){b.value=C,s.value=!0}function r(){b.value=void 0,s.value=!1}async function n(C){f.value=!0;try{await Qe(R,o.projectId,C.id),await w()}finally{f.value=!1}}return(C,V)=>(v(),h(J,{modelValue:d(c),"onUpdate:modelValue":V[4]||(V[4]=U=>L(c)?c.value=U:null)},{default:a(()=>{var U;return[e(ne,{modelValue:s.value,"onUpdate:modelValue":V[0]||(V[0]=k=>s.value=k),type:"warning",content:`\u786E\u5B9A\u8981\u79FB\u9664\u7528\u6237 ${(U=b.value)==null?void 0:U.name} \u5417\uFF1F`,onConfirm:V[1]||(V[1]=k=>b.value&&n(b.value).then(r))},null,8,["modelValue","content"]),e(H,{class:"tw-w-full tw-mx-6 lg:tw-w-1/2"},{default:a(()=>[e(E,null,{default:a(()=>[Je]),_:1}),e(M),e(E,{class:"tw-flex md:tw-flex-row tw-flex-col tw-gap-2"},{default:a(()=>[e(F,{modelValue:p.value,"onUpdate:modelValue":V[2]||(V[2]=k=>p.value=k),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u5E10\u53F7",dense:"",outlined:"",class:"tw-grow"},null,8,["modelValue"]),e(Ue,{modelValue:i.value,"onUpdate:modelValue":V[3]||(V[3]=k=>i.value=k),outlined:"",dense:"",class:"tw-w-full md:tw-w-32","emit-value":"","map-options":"",placeholder:"\u8BF7\u9009\u62E9\u7528\u6237\u6743\u9650",options:d(de)},null,8,["modelValue","options"]),e(Q,{loading:f.value,outline:"","text-color":"primary",onClick:y},{default:a(()=>[Ge]),_:1},8,["loading"])]),_:1}),e(M),e(E,{style:{"max-height":"60vh",height:"60vh"},class:"scroll"},{default:a(()=>[g("ul",Ke,[(v(!0),j(Y,null,te(m.value,k=>(v(),j("li",{key:k.id,class:"tw-relative tw-flex tw-items-center tw-space-x-4 tw-py-2"},[g("div",We,[g("div",Xe,[Ze,g("h2",et,[g("a",tt,[g("span",lt,D(k.name),1),ot,g("span",at,D(k.permissions&&d(He)(k.permissions[0])),1)])])]),g("div",st,[g("p",nt,D(k.account),1),ut,g("p",rt,D(d(Pe)(k.createTime*1e3,"YYYY-MM-DD HH:mm")),1)])]),g("div",it,[e(Q,{type:"primary",unelevated:"",class:"tw-text-red-500",onClick:ht=>u(k)},{default:a(()=>[dt]),_:2},1032,["onClick"])])]))),128))])]),_:1}),e(M),e(ue,{align:"right"},{default:a(()=>[S(e(Q,{flat:"",label:"\u5173\u95ED",color:"primary"},null,512),[[B]])]),_:1})]),_:1})]}),_:1},8,["modelValue"]))}}),ct=$("\u7F16\u8F91"),mt=$("\u4EBA\u5458\u7BA1\u7406"),pt=$("\u9879\u76EEtoken"),ft=$("\u5220\u9664"),wt=g("div",{class:"text-h6"},"\u9879\u76EE Token",-1),vt=I({props:{projectId:{type:Number,required:!0}},setup(t){const l=t,o=_(!1),i=N(),c=_(!1),m=_(!1),w=_(!1),p=_(!1),f=_(!1),y=_("");async function b(){y.value="",p.value=!0,f.value=!0;try{const u=await Ce(l.projectId);y.value=u}catch(u){console.error(u)}f.value=!1}function s(){Le(y.value).then(()=>{i.commit("success",{message:"token\u5DF2\u590D\u5236"})})}return(u,r)=>(v(),j(Y,null,[e(re,{modelValue:c.value,"onUpdate:modelValue":r[0]||(r[0]=n=>c.value=n),"project-id":l.projectId},null,8,["modelValue","project-id"]),e(ie,{modelValue:m.value,"onUpdate:modelValue":r[1]||(r[1]=n=>m.value=n),"project-id":l.projectId},null,8,["modelValue","project-id"]),e(Z,{modelValue:w.value,"onUpdate:modelValue":r[2]||(r[2]=n=>w.value=n),"project-id":l.projectId},null,8,["modelValue","project-id"]),e(Z),e(Ie,{modelValue:o.value,"onUpdate:modelValue":r[6]||(r[6]=n=>o.value=n),flat:"","dropdown-icon":"more_horiz","no-icon-animation":""},{default:a(()=>[e(se,{dense:""},{default:a(()=>[S((v(),h(T,{clickable:"",class:"hover:tw-bg-primary hover:tw-text-black",onClick:r[3]||(r[3]=P(n=>m.value=!0,["stop"]))},{default:a(()=>[e(q,null,{default:a(()=>[e(A,null,{default:a(()=>[ct]),_:1})]),_:1})]),_:1})),[[B]]),S((v(),h(T,{clickable:"",class:"hover:tw-bg-primary hover:tw-text-black",onClick:r[4]||(r[4]=P(n=>w.value=!0,["stop"]))},{default:a(()=>[e(q,null,{default:a(()=>[e(A,null,{default:a(()=>[mt]),_:1})]),_:1})]),_:1})),[[B]]),S((v(),h(T,{clickable:"",class:"hover:tw-bg-primary hover:tw-text-black",onClick:P(b,["stop"])},{default:a(()=>[e(q,null,{default:a(()=>[e(A,null,{default:a(()=>[pt]),_:1})]),_:1})]),_:1},8,["onClick"])),[[B]]),S((v(),h(T,{clickable:"",class:"hover:tw-bg-primary hover:tw-text-black",onClick:r[5]||(r[5]=P(n=>c.value=!0,["stop"]))},{default:a(()=>[e(q,null,{default:a(()=>[e(A,null,{default:a(()=>[ft]),_:1})]),_:1})]),_:1})),[[B]])]),_:1})]),_:1},8,["modelValue"]),e(J,{modelValue:p.value,"onUpdate:modelValue":r[8]||(r[8]=n=>p.value=n)},{default:a(()=>[e(H,{class:"tw-w-[400px] tw-max-w-full"},{default:a(()=>[e(E,null,{default:a(()=>[wt]),_:1}),e(E,{class:"q-pt-none"},{default:a(()=>[f.value?(v(),h(Me,{key:0,type:"rect"})):(v(),h(F,{key:1,modelValue:y.value,"onUpdate:modelValue":r[7]||(r[7]=n=>y.value=n),dark:"",borderless:"",readonly:!0},{append:a(()=>[e(O,{name:"file_copy",class:"tw-cursor-pointer",onClick:s})]),_:1},8,["modelValue"]))]),_:1}),e(ue,{align:"right"},{default:a(()=>[S(e(Q,{flat:"",label:"\u5173\u95ED",color:"primary"},null,512),[[B]])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}}),gt={class:"tw-h-full tw-w-full tw-flex tw-flex-col"},yt={class:"q-pa-md tw-flex tw-justify-around"},_t={key:0,class:"tw-w-full tw-text-center tw-m-auto tw-text-gray-500"},xt=$(" \u6682\u65E0\u6570\u636E "),bt=I({setup(t){const l=N(),o=x(()=>l.state.Project.loadingProjects);async function i(){await l.dispatch("Project/fetchProjects")}ee(i);const c=_(""),m=x(()=>l.state.Project.projects.filter(s=>s.title.indexOf(c.value)>=0||s.id.toString().indexOf(c.value)>=0));function w(s){return ae().params.projectId===s.id.toString()}const p=_(!1),f=_(!1),y=x(()=>m.value.filter(w).pop()),b=x(()=>l.getters.isAdmin);return(s,u)=>{const r=le("router-link");return v(),j("div",gt,[d(y)?(v(),h(re,{key:0,modelValue:f.value,"onUpdate:modelValue":u[0]||(u[0]=n=>f.value=n),"project-id":d(y).id},null,8,["modelValue","project-id"])):z("",!0),e(ie,{modelValue:p.value,"onUpdate:modelValue":u[1]||(u[1]=n=>p.value=n)},null,8,["modelValue"]),g("div",yt,[e(F,{modelValue:c.value,"onUpdate:modelValue":u[2]||(u[2]=n=>c.value=n),borderless:"",dense:"",debounce:"300",placeholder:"Search"},{append:a(()=>[e(O,{name:"search"})]),_:1},8,["modelValue"]),e(Q,{flat:"",dense:"",loading:d(o),icon:"refresh",onClick:i},null,8,["loading"]),e(Q,{flat:"",dense:"",icon:"add",onClick:u[3]||(u[3]=n=>p.value=!0)}),e(Q,{flat:"",dense:"",class:"tw-text-red-300 lg:tw-flex tw-hidden",icon:"delete",disable:!d(y),onClick:u[4]||(u[4]=n=>f.value=!0)},null,8,["disable"])]),e(Ee,{class:"tw-grow tw-px-[15px]",visible:"","thumb-style":d(qe),"bar-style":d(Ae)},{default:a(()=>[e(se,{class:"tw-flex tw-flex-col tw-gap-2 tw-pb-4"},{default:a(()=>[(v(!0),j(Y,null,te(d(m),n=>(v(),j("div",{key:n.id,class:oe((w(n)?"tw-bg-primary tw-text-black ":"tw-bg-[#27272a] ")+"tw-w-full tw-flex tw-flex-row tw-rounded-md")},[e(r,{class:"tw-grow tw-p-4",to:{name:"project",params:{projectId:n.id}}},{default:a(()=>[$(D(n.title),1)]),_:2},1032,["to"]),d(b)||d(Ye)(n.permission)?(v(),h(vt,{key:0,"project-id":n.id},null,8,["project-id"])):z("",!0)],2))),128))]),_:1}),!d(o)&&(!d(m)||d(m).length===0)?(v(),j("div",_t,[e(O,{name:"outlet",style:{"font-size":"3rem"}}),xt])):z("",!0)]),_:1},8,["thumb-style","bar-style"])])}}}),kt={class:"lg:tw-flex lg:tw-flex-row tw-w-full tw-h-full"},Ht=I({setup(t){const l=ae(),o=x(()=>l.name&&l.name.toString()!=="projects"?"tw-hidden lg:tw-block":"");return(i,c)=>{const m=le("router-view");return v(),j("div",kt,[g("div",{class:oe("xl:tw-basis-1/5 tw-basis-1/4 tw-h-full tw-w-full tw-min-w-[280px] "+d(o))},[e(bt)],2),e(m)])}}});export{Ht as default};
