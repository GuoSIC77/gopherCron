var P=Object.defineProperty,q=Object.defineProperties;var N=Object.getOwnPropertyDescriptors;var v=Object.getOwnPropertySymbols;var O=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable;var b=(u,a,s)=>a in u?P(u,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):u[a]=s,y=(u,a)=>{for(var s in a||(a={}))O.call(a,s)&&b(u,s,a[s]);if(v)for(var s of v(a))S.call(a,s)&&b(u,s,a[s]);return u},g=(u,a)=>q(u,N(a));import{a as V,b as j,Q as _}from"./QDialog.fd4f138b.js";import{Q as n}from"./QInput.18ea454a.js";import{_ as I,j as M,r as J,c as B,bf as i,l as w,m as c,q as m,s as r,x as E,I as z,z as f,t as x,Q as A,A as L,bg as R,bh as $}from"./index.8ec00635.js";import{Q as G}from"./QForm.558588c8.js";const H={class:"text-h6"},K={class:"tw-flex tw-flex-row-reverse tw-gap-4"},T=M({props:{modelValue:{type:Boolean,default:!1},user:{type:Object,default:null}},emits:["update:modelValue","modify"],setup(u,{emit:a}){const s=u,p=s.user!=null?g(y({},s.user),{password:"",passwordAgain:"",newPassword:""}):{id:void 0,account:"",password:"",newPassword:"",passwordAgain:"",name:""},e=J(Object.assign({},p)),C=B(()=>JSON.stringify(p)===JSON.stringify(e.value)),D=i.getters.isAdmin,k=()=>{e.value=Object.assign({},p)},d=B({get(){return s.modelValue},set(t){t||k(),a("update:modelValue",t)}}),F=async()=>{try{if(e.value.newPassword!==e.value.passwordAgain){i.commit("error",{error:new Error("\u4E24\u6B21\u5BC6\u7801\u4E0D\u4E00\u81F4")});return}(await R({userID:e.value.id?e.value.id:0,password:e.value.password,newPassword:e.value.newPassword})).meta.code===0&&(i.commit("success",{message:"\u4FEE\u6539\u6210\u529F"}),d.value=!1,a("modify",{}))}catch(t){console.log(t)}},Q=async()=>{try{if(e.value.password!==e.value.passwordAgain){i.commit("error",{error:new Error("\u4E24\u6B21\u5BC6\u7801\u4E0D\u4E00\u81F4")});return}(await $({account:e.value.account,password:e.value.password,name:e.value.name})).meta.code===0&&(i.commit("success",{message:"\u65B0\u589E\u6210\u529F"}),d.value=!1,a("modify",{}))}catch(t){console.log(t)}},U=async()=>s.user?await F():await Q();return(t,l)=>(w(),c(_,{modelValue:f(d),"onUpdate:modelValue":l[6]||(l[6]=o=>L(d)?d.value=o:null),"no-backdrop-dismiss":!f(C)},{default:m(()=>[r(j,{style:{width:"300px"}},{default:m(()=>[r(V,null,{default:m(()=>[E("div",H,z(u.user?"\u7F16\u8F91":"\u65B0\u589E"),1)]),_:1}),r(V,{class:"q-pt-none"},{default:m(()=>[r(G,{class:"tw-w-full",onSubmit:U},{default:m(()=>[r(n,{key:"name",modelValue:e.value.name,"onUpdate:modelValue":l[0]||(l[0]=o=>e.value.name=o),disable:e.value.id!==void 0,type:"textarea",label:"\u540D\u79F0",autogrow:"",square:"",filled:"",class:"tw-mb-4"},null,8,["modelValue","disable"]),r(n,{key:"account",modelValue:e.value.account,"onUpdate:modelValue":l[1]||(l[1]=o=>e.value.account=o),disable:e.value.id!==void 0,type:"text",label:"\u8D26\u53F7(\u90AE\u7BB1)",square:"",filled:"",class:"tw-mb-4"},null,8,["modelValue","disable"]),e.value.id===void 0||!f(D)?(w(),c(n,{key:"password_again",modelValue:e.value.password,"onUpdate:modelValue":l[2]||(l[2]=o=>e.value.password=o),type:"password",label:e.value.id===void 0?"\u5BC6\u7801":"\u65E7\u5BC6\u7801",square:"",filled:"",class:"tw-mb-4"},null,8,["modelValue","label"])):x("v-if",!0),e.value.id!==void 0?(w(),c(n,{key:"password",modelValue:e.value.newPassword,"onUpdate:modelValue":l[3]||(l[3]=o=>e.value.newPassword=o),type:"password",label:"\u65B0\u5BC6\u7801",square:"",filled:"",class:"tw-mb-4"},null,8,["modelValue"])):x("v-if",!0),r(n,{key:"password_again",modelValue:e.value.passwordAgain,"onUpdate:modelValue":l[4]||(l[4]=o=>e.value.passwordAgain=o),type:"password",label:"\u786E\u8BA4\u65B0\u5BC6\u7801",square:"",filled:"",class:"tw-mb-4"},null,8,["modelValue"]),E("div",K,[r(A,{color:"primary","text-color":"black",type:"submit",label:"\u63D0\u4EA4",class:"lg:tw-w-24 tw-w-full"}),r(A,{flat:"",type:"reset",label:"\u53D6\u6D88",class:"lg:tw-w-24 tw-w-full",onClick:l[5]||(l[5]=o=>d.value=!1)})])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","no-backdrop-dismiss"]))}});var ee=I(T,[["__file","/Users/boyan/development/opensource/gopherCronFE/src/pages/UserListAdmin/ModifyBox.vue"]]);export{ee as M};
