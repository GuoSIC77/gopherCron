import{_ as C,k as F,o as h,K as B,b as o,a2 as q,r as i,u as I,J as S,H as A,aS as x,aT as E,a as n,c as M,w as y,h as p,p as N,M as Q,d as V,aU as T,aV as P,f as b}from"./index.1e2cf3d3.js";const $=["src"],j=o("div",{class:"tw-font-bold tw-text-md tw-text-center"},"GOPHERCRON",-1),H=F({props:{class:{type:String,default:""},src:{type:String,default:"/logo.png"}},setup(m){const l=m;return(u,a)=>(h(),B("div",{class:q(l.class+" tw-flex tw-items-center tw-flex-col")},[o("img",{src:m.src,alt:"logo"},null,8,$),j],2))}});var z=C(H,[["__file","/Users/boyan/development/opensource/gopherCronFE/src/components/LogoTpl.vue"]]);const G={class:"tw-h-full tw-bg-gradient-to-tl tw-from-primary tw-to-black tw-w-full tw-px-4"},J={class:"tw-flex tw-flex-col tw-items-center tw-justify-center tw-h-full tw-w-full"},K={class:"tw-bg-[#1D1D1D] tw-shadow tw-rounded-2xl tw-max-w-md lg:tw-w-1/3 sm:tw-w-2/3 tw-w-full tw-p-10 md:tw-mt-6 tw-mt-2"},W=V(" \u4F7F\u7528 OIDC \u767B\u5F55 "),X=o("p",{tabindex:"0",class:"focus:tw-outline-none tw-text-2xl tw-font-extrabold tw-leading-6"}," \u8D26\u53F7\u5BC6\u7801\u767B\u5F55 ",-1),Y=o("p",{tabindex:"0",class:"tw-pb-8 focus:tw-outline-none tw-text-sm tw-mt-4 tw-font-medium tw-leading-none tw-text-gray-500"},[V(" \u6CA1\u6709\u8D26\u53F7? "),o("a",{href:"javascript:void(0)",class:"hover:text-gray-500 focus:text-gray-500 focus:outline-none focus:underline hover:underline text-sm font-medium leading-none text-gray-800 cursor-pointer"},"\u8BF7\u8054\u7CFB\u7BA1\u7406\u5458\u5F00\u901A")],-1),Z=o("label",{id:"email",class:"tw-text-sm tw-font-medium tw-leading-none tw-text-white"},"\u8D26\u53F7",-1),tt={class:"tw-mt-6 tw-w-full"},et=o("label",{for:"pass",class:"tw-text-sm tw-font-medium tw-leading-none tw-text-white"},"\u5BC6\u7801",-1),ot={class:"tw-mt-8"},at=F({setup(m){const l=i(""),u=i(""),a=I(),L=S(),c=A(),r=i(!1),s=i(!1);let d=x("code"),w=x("state");d||(d=c.query.code),w||(w=c.query.state),d&&w&&D(d,w);const _=i();async function k(){try{_.value=await T()}catch(t){console.error(t),a.commit("error",{error:t})}}k();async function D(t,e){s.value=!0,await a.dispatch("loginWithOIDC",{code:t,state:e}),a.state.Root.logined&&await v(c.query.redirect),s.value=!1}async function v(t){const e={name:"",path:"",params:{}};if(t&&t.length>0&&t.indexOf("/summary")===-1)e.path=t||e.path;else{const f=localStorage.getItem("gc_choosed_org")||"baseorg";e.name="summary",e.params={orgId:f}}await L.push(e)}async function R(){s.value=!0;try{const t=await P();window.location.href=t}catch(t){console.error(t),s.value=!1,a.commit("error",{error:t})}}async function O(){r.value=!0,await a.dispatch("login",{username:l.value,password:u.value}),a.state.Root.logined&&await v(c.query.redirect),r.value=!1}function U(){l.value="",u.value=""}return E(()=>a.dispatch("logout")),(t,e)=>{var f;return h(),B("div",G,[o("div",J,[n(z,{class:"tw-w-24 md:tw-w-32",src:"./logo_white.png"}),o("div",K,[(f=_.value)!=null&&f.oidc?(h(),M(p,{key:0,outline:"","text-color":"white",loading:s.value,disable:s.value||r.value,class:"focus:tw-ring-2 tw-mb-6 focus:tw-ring-offset-2 tw-font-semibold tw-leading-none tw-text-black tw-outline-non tw-border tw-rounded tw-py-2 tw-w-full",onClick:R},{default:y(()=>[W]),_:1},8,["loading","disable"])):N("v-if",!0),X,Y,n(Q,{onSubmit:O,onReset:U},{default:y(()=>[o("div",null,[Z,n(b,{modelValue:l.value,"onUpdate:modelValue":e[0]||(e[0]=g=>l.value=g),dense:"",type:"text",square:"",filled:""},null,8,["modelValue"])]),o("div",tt,[et,n(b,{modelValue:u.value,"onUpdate:modelValue":e[1]||(e[1]=g=>u.value=g),dense:"",type:"password",square:"",filled:""},null,8,["modelValue"])]),o("div",ot,[n(p,{color:"primary",type:"submit",label:"\u767B\u5F55","text-color":"black",loading:r.value,disable:s.value||r.value,class:"focus:tw-ring-2 focus:tw-ring-offset-2 tw-font-semibold tw-leading-none tw-text-black tw-outline-non tw-border tw-rounded tw-py-2 tw-w-full"},null,8,["loading","disable"]),n(p,{color:"primary",type:"reset",label:"\u91CD\u7F6E",flat:"",class:"tw-text-sm tw-w-full tw-mt-3 tw-border tw-rounded"})])]),_:1})])])])}}});var lt=C(at,[["__file","/Users/boyan/development/opensource/gopherCronFE/src/pages/LoginPage.vue"]]);export{lt as default};
