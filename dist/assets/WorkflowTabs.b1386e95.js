var St=Object.defineProperty,Vt=Object.defineProperties;var Ot=Object.getOwnPropertyDescriptors;var ze=Object.getOwnPropertySymbols;var Tt=Object.prototype.hasOwnProperty,Bt=Object.prototype.propertyIsEnumerable;var Qe=(e,t,o)=>t in e?St(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,qe=(e,t)=>{for(var o in t||(t={}))Tt.call(t,o)&&Qe(e,o,t[o]);if(ze)for(var o of ze(t))Bt.call(t,o)&&Qe(e,o,t[o]);return e},Je=(e,t)=>Vt(e,Ot(t));import{I as Y,aE as Mt,_ as oe,k as ne,l as D,r as B,u as me,o as M,c as $,w as F,a as b,T as K,S as H,A as N,E as at,z as lt,d as P,m as ie,aF as Dt,aD as Ke,P as Ae,ap as Pt,ag as $t,K as ge,a2 as Lt,p as J,F as Wt,aG as Rt,Y as Ut,n as Se,i as st,Q as se,b as ue,D as zt,h as q,al as Qt,x as re,t as he,e as it,C as ae,aH as qt,aI as Jt,aJ as Kt,aK as Ht,J as Gt,H as ut,f as Ee,B as Yt,M as Xt,aL as Zt,aM as eo,R as to,U as ke,V as oo,a3 as He,a6 as no,a5 as le,a7 as Ie}from"./index.a78b90e1.js";import{u as ft}from"./index.1225a1d0.js";import{C as Ge}from"./Confirm.356f7c34.js";import{J as ro}from"./JSONViewer.e1d1ed6c.js";import{f as Ye}from"./datetime.561112b0.js";var ao=Object.defineProperty,lo=Object.defineProperties,so=Object.getOwnPropertyDescriptors,Xe=Object.getOwnPropertySymbols,io=Object.prototype.hasOwnProperty,uo=Object.prototype.propertyIsEnumerable,Ze=(e,t,o)=>t in e?ao(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,je=(e,t)=>{for(var o in t||(t={}))io.call(t,o)&&Ze(e,o,t[o]);if(Xe)for(var o of Xe(t))uo.call(t,o)&&Ze(e,o,t[o]);return e},fo=(e,t)=>lo(e,so(t));function dt(e,t){var o,n=1;e==null&&(e=0),t==null&&(t=0);function r(){var s,i=o.length,l,u=0,a=0;for(s=0;s<i;++s)l=o[s],u+=l.x,a+=l.y;for(u=(u/i-e)*n,a=(a/i-t)*n,s=0;s<i;++s)l=o[s],l.x-=u,l.y-=a}return r.initialize=function(s){o=s},r.x=function(s){return arguments.length?(e=+s,r):e},r.y=function(s){return arguments.length?(t=+s,r):t},r.strength=function(s){return arguments.length?(n=+s,r):n},r}function co(e){const t=+this._x.call(null,e),o=+this._y.call(null,e);return ct(this.cover(t,o),t,o,e)}function ct(e,t,o,n){if(isNaN(t)||isNaN(o))return e;var r,s=e._root,i={data:n},l=e._x0,u=e._y0,a=e._x1,d=e._y1,m,w,h,x,p,f,c,v;if(!s)return e._root=i,e;for(;s.length;)if((p=t>=(m=(l+a)/2))?l=m:a=m,(f=o>=(w=(u+d)/2))?u=w:d=w,r=s,!(s=s[c=f<<1|p]))return r[c]=i,e;if(h=+e._x.call(null,s.data),x=+e._y.call(null,s.data),t===h&&o===x)return i.next=s,r?r[c]=i:e._root=i,e;do r=r?r[c]=new Array(4):e._root=new Array(4),(p=t>=(m=(l+a)/2))?l=m:a=m,(f=o>=(w=(u+d)/2))?u=w:d=w;while((c=f<<1|p)===(v=(x>=w)<<1|h>=m));return r[v]=s,r[c]=i,e}function po(e){var t,o,n=e.length,r,s,i=new Array(n),l=new Array(n),u=1/0,a=1/0,d=-1/0,m=-1/0;for(o=0;o<n;++o)isNaN(r=+this._x.call(null,t=e[o]))||isNaN(s=+this._y.call(null,t))||(i[o]=r,l[o]=s,r<u&&(u=r),r>d&&(d=r),s<a&&(a=s),s>m&&(m=s));if(u>d||a>m)return this;for(this.cover(u,a).cover(d,m),o=0;o<n;++o)ct(this,i[o],l[o],e[o]);return this}function vo(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var o=this._x0,n=this._y0,r=this._x1,s=this._y1;if(isNaN(o))r=(o=Math.floor(e))+1,s=(n=Math.floor(t))+1;else{for(var i=r-o||1,l=this._root,u,a;o>e||e>=r||n>t||t>=s;)switch(a=(t<n)<<1|e<o,u=new Array(4),u[a]=l,l=u,i*=2,a){case 0:r=o+i,s=n+i;break;case 1:o=r-i,s=n+i;break;case 2:r=o+i,n=s-i;break;case 3:o=r-i,n=s-i;break}this._root&&this._root.length&&(this._root=l)}return this._x0=o,this._y0=n,this._x1=r,this._y1=s,this}function ho(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function go(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function z(e,t,o,n,r){this.node=e,this.x0=t,this.y0=o,this.x1=n,this.y1=r}function wo(e,t,o){var n,r=this._x0,s=this._y0,i,l,u,a,d=this._x1,m=this._y1,w=[],h=this._root,x,p;for(h&&w.push(new z(h,r,s,d,m)),o==null?o=1/0:(r=e-o,s=t-o,d=e+o,m=t+o,o*=o);x=w.pop();)if(!(!(h=x.node)||(i=x.x0)>d||(l=x.y0)>m||(u=x.x1)<r||(a=x.y1)<s))if(h.length){var f=(i+u)/2,c=(l+a)/2;w.push(new z(h[3],f,c,u,a),new z(h[2],i,c,f,a),new z(h[1],f,l,u,c),new z(h[0],i,l,f,c)),(p=(t>=c)<<1|e>=f)&&(x=w[w.length-1],w[w.length-1]=w[w.length-1-p],w[w.length-1-p]=x)}else{var v=e-+this._x.call(null,h.data),C=t-+this._y.call(null,h.data),k=v*v+C*C;if(k<o){var j=Math.sqrt(o=k);r=e-j,s=t-j,d=e+j,m=t+j,n=h.data}}return n}function mo(e){if(isNaN(d=+this._x.call(null,e))||isNaN(m=+this._y.call(null,e)))return this;var t,o=this._root,n,r,s,i=this._x0,l=this._y0,u=this._x1,a=this._y1,d,m,w,h,x,p,f,c;if(!o)return this;if(o.length)for(;;){if((x=d>=(w=(i+u)/2))?i=w:u=w,(p=m>=(h=(l+a)/2))?l=h:a=h,t=o,!(o=o[f=p<<1|x]))return this;if(!o.length)break;(t[f+1&3]||t[f+2&3]||t[f+3&3])&&(n=t,c=f)}for(;o.data!==e;)if(r=o,!(o=o.next))return this;return(s=o.next)&&delete o.next,r?(s?r.next=s:delete r.next,this):t?(s?t[f]=s:delete t[f],(o=t[0]||t[1]||t[2]||t[3])&&o===(t[3]||t[2]||t[1]||t[0])&&!o.length&&(n?n[c]=o:this._root=o),this):(this._root=s,this)}function yo(e){for(var t=0,o=e.length;t<o;++t)this.remove(e[t]);return this}function ko(){return this._root}function _o(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function xo(e){var t=[],o,n=this._root,r,s,i,l,u;for(n&&t.push(new z(n,this._x0,this._y0,this._x1,this._y1));o=t.pop();)if(!e(n=o.node,s=o.x0,i=o.y0,l=o.x1,u=o.y1)&&n.length){var a=(s+l)/2,d=(i+u)/2;(r=n[3])&&t.push(new z(r,a,d,l,u)),(r=n[2])&&t.push(new z(r,s,d,a,u)),(r=n[1])&&t.push(new z(r,a,i,l,d)),(r=n[0])&&t.push(new z(r,s,i,a,d))}return this}function bo(e){var t=[],o=[],n;for(this._root&&t.push(new z(this._root,this._x0,this._y0,this._x1,this._y1));n=t.pop();){var r=n.node;if(r.length){var s,i=n.x0,l=n.y0,u=n.x1,a=n.y1,d=(i+u)/2,m=(l+a)/2;(s=r[0])&&t.push(new z(s,i,l,d,m)),(s=r[1])&&t.push(new z(s,d,l,u,m)),(s=r[2])&&t.push(new z(s,i,m,d,a)),(s=r[3])&&t.push(new z(s,d,m,u,a))}o.push(n)}for(;n=o.pop();)e(n.node,n.x0,n.y0,n.x1,n.y1);return this}function No(e){return e[0]}function Fo(e){return arguments.length?(this._x=e,this):this._x}function Eo(e){return e[1]}function Io(e){return arguments.length?(this._y=e,this):this._y}function Te(e,t,o){var n=new Be(t==null?No:t,o==null?Eo:o,NaN,NaN,NaN,NaN);return e==null?n:n.addAll(e)}function Be(e,t,o,n,r,s){this._x=e,this._y=t,this._x0=o,this._y0=n,this._x1=r,this._y1=s,this._root=void 0}function et(e){for(var t={data:e.data},o=t;e=e.next;)o=o.next={data:e.data};return t}var Q=Te.prototype=Be.prototype;Q.copy=function(){var e=new Be(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,o,n;if(!t)return e;if(!t.length)return e._root=et(t),e;for(o=[{source:t,target:e._root=new Array(4)}];t=o.pop();)for(var r=0;r<4;++r)(n=t.source[r])&&(n.length?o.push({source:n,target:t.target[r]=new Array(4)}):t.target[r]=et(n));return e};Q.add=co;Q.addAll=po;Q.cover=vo;Q.data=ho;Q.extent=go;Q.find=wo;Q.remove=mo;Q.removeAll=yo;Q.root=ko;Q.size=_o;Q.visit=xo;Q.visitAfter=bo;Q.x=Fo;Q.y=Io;function L(e){return function(){return e}}function G(e){return(e()-.5)*1e-6}function jo(e){return e.x+e.vx}function Co(e){return e.y+e.vy}function pt(e){var t,o,n,r=1,s=1;typeof e!="function"&&(e=L(e==null?1:+e));function i(){for(var a,d=t.length,m,w,h,x,p,f,c=0;c<s;++c)for(m=Te(t,jo,Co).visitAfter(l),a=0;a<d;++a)w=t[a],p=o[w.index],f=p*p,h=w.x+w.vx,x=w.y+w.vy,m.visit(v);function v(C,k,j,_,S){var I=C.data,T=C.r,V=p+T;if(I){if(I.index>w.index){var R=h-I.x-I.vx,W=x-I.y-I.vy,U=R*R+W*W;U<V*V&&(R===0&&(R=G(n),U+=R*R),W===0&&(W=G(n),U+=W*W),U=(V-(U=Math.sqrt(U)))/U*r,w.vx+=(R*=U)*(V=(T*=T)/(f+T)),w.vy+=(W*=U)*V,I.vx-=R*(V=1-V),I.vy-=W*V)}return}return k>h+V||_<h-V||j>x+V||S<x-V}}function l(a){if(a.data)return a.r=o[a.data.index];for(var d=a.r=0;d<4;++d)a[d]&&a[d].r>a.r&&(a.r=a[d].r)}function u(){if(!!t){var a,d=t.length,m;for(o=new Array(d),a=0;a<d;++a)m=t[a],o[m.index]=+e(m,a,t)}}return i.initialize=function(a,d){t=a,n=d,u()},i.iterations=function(a){return arguments.length?(s=+a,i):s},i.strength=function(a){return arguments.length?(r=+a,i):r},i.radius=function(a){return arguments.length?(e=typeof a=="function"?a:L(+a),u(),i):e},i}function Ao(e){return e.index}function tt(e,t){var o=e.get(t);if(!o)throw new Error("node not found: "+t);return o}function vt(e){var t=Ao,o=m,n,r=L(30),s,i,l,u,a,d=1;e==null&&(e=[]);function m(f){return 1/Math.min(l[f.source.index],l[f.target.index])}function w(f){for(var c=0,v=e.length;c<d;++c)for(var C=0,k,j,_,S,I,T,V;C<v;++C)k=e[C],j=k.source,_=k.target,S=_.x+_.vx-j.x-j.vx||G(a),I=_.y+_.vy-j.y-j.vy||G(a),T=Math.sqrt(S*S+I*I),T=(T-s[C])/T*f*n[C],S*=T,I*=T,_.vx-=S*(V=u[C]),_.vy-=I*V,j.vx+=S*(V=1-V),j.vy+=I*V}function h(){if(!!i){var f,c=i.length,v=e.length,C=new Map(i.map((j,_)=>[t(j,_,i),j])),k;for(f=0,l=new Array(c);f<v;++f)k=e[f],k.index=f,typeof k.source!="object"&&(k.source=tt(C,k.source)),typeof k.target!="object"&&(k.target=tt(C,k.target)),l[k.source.index]=(l[k.source.index]||0)+1,l[k.target.index]=(l[k.target.index]||0)+1;for(f=0,u=new Array(v);f<v;++f)k=e[f],u[f]=l[k.source.index]/(l[k.source.index]+l[k.target.index]);n=new Array(v),x(),s=new Array(v),p()}}function x(){if(!!i)for(var f=0,c=e.length;f<c;++f)n[f]=+o(e[f],f,e)}function p(){if(!!i)for(var f=0,c=e.length;f<c;++f)s[f]=+r(e[f],f,e)}return w.initialize=function(f,c){i=f,a=c,h()},w.links=function(f){return arguments.length?(e=f,h(),w):e},w.id=function(f){return arguments.length?(t=f,w):t},w.iterations=function(f){return arguments.length?(d=+f,w):d},w.strength=function(f){return arguments.length?(o=typeof f=="function"?f:L(+f),x(),w):o},w.distance=function(f){return arguments.length?(r=typeof f=="function"?f:L(+f),p(),w):r},w}var So={value:()=>{}};function ht(){for(var e=0,t=arguments.length,o={},n;e<t;++e){if(!(n=arguments[e]+"")||n in o||/[\s.]/.test(n))throw new Error("illegal type: "+n);o[n]=[]}return new _e(o)}function _e(e){this._=e}function Vo(e,t){return e.trim().split(/^|\s+/).map(function(o){var n="",r=o.indexOf(".");if(r>=0&&(n=o.slice(r+1),o=o.slice(0,r)),o&&!t.hasOwnProperty(o))throw new Error("unknown type: "+o);return{type:o,name:n}})}_e.prototype=ht.prototype={constructor:_e,on:function(e,t){var o=this._,n=Vo(e+"",o),r,s=-1,i=n.length;if(arguments.length<2){for(;++s<i;)if((r=(e=n[s]).type)&&(r=Oo(o[r],e.name)))return r;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<i;)if(r=(e=n[s]).type)o[r]=ot(o[r],e.name,t);else if(t==null)for(r in o)o[r]=ot(o[r],e.name,null);return this},copy:function(){var e={},t=this._;for(var o in t)e[o]=t[o].slice();return new _e(e)},call:function(e,t){if((r=arguments.length-2)>0)for(var o=new Array(r),n=0,r,s;n<r;++n)o[n]=arguments[n+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],n=0,r=s.length;n<r;++n)s[n].value.apply(t,o)},apply:function(e,t,o){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var n=this._[e],r=0,s=n.length;r<s;++r)n[r].value.apply(t,o)}};function Oo(e,t){for(var o=0,n=e.length,r;o<n;++o)if((r=e[o]).name===t)return r.value}function ot(e,t,o){for(var n=0,r=e.length;n<r;++n)if(e[n].name===t){e[n]=So,e=e.slice(0,n).concat(e.slice(n+1));break}return o!=null&&e.push({name:t,value:o}),e}var fe=0,pe=0,ce=0,gt=1e3,xe,ve,be=0,te=0,Ne=0,we=typeof performance=="object"&&performance.now?performance:Date,wt=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function mt(){return te||(wt(To),te=we.now()+Ne)}function To(){te=0}function Ve(){this._call=this._time=this._next=null}Ve.prototype=yt.prototype={constructor:Ve,restart:function(e,t,o){if(typeof e!="function")throw new TypeError("callback is not a function");o=(o==null?mt():+o)+(t==null?0:+t),!this._next&&ve!==this&&(ve?ve._next=this:xe=this,ve=this),this._call=e,this._time=o,Oe()},stop:function(){this._call&&(this._call=null,this._time=1/0,Oe())}};function yt(e,t,o){var n=new Ve;return n.restart(e,t,o),n}function Bo(){mt(),++fe;for(var e=xe,t;e;)(t=te-e._time)>=0&&e._call.call(void 0,t),e=e._next;--fe}function nt(){te=(be=we.now())+Ne,fe=pe=0;try{Bo()}finally{fe=0,Do(),te=0}}function Mo(){var e=we.now(),t=e-be;t>gt&&(Ne-=t,be=e)}function Do(){for(var e,t=xe,o,n=1/0;t;)t._call?(n>t._time&&(n=t._time),e=t,t=t._next):(o=t._next,t._next=null,t=e?e._next=o:xe=o);ve=e,Oe(n)}function Oe(e){if(!fe){pe&&(pe=clearTimeout(pe));var t=e-te;t>24?(e<1/0&&(pe=setTimeout(nt,e-we.now()-Ne)),ce&&(ce=clearInterval(ce))):(ce||(be=we.now(),ce=setInterval(Mo,gt)),fe=1,wt(nt))}}const Po=1664525,$o=1013904223,rt=4294967296;function Lo(){let e=1;return()=>(e=(Po*e+$o)%rt)/rt}function Wo(e){return e.x}function Ro(e){return e.y}var Uo=10,zo=Math.PI*(3-Math.sqrt(5));function kt(e){var t,o=1,n=.001,r=1-Math.pow(n,1/300),s=0,i=.6,l=new Map,u=yt(m),a=ht("tick","end"),d=Lo();e==null&&(e=[]);function m(){w(),a.call("tick",t),o<n&&(u.stop(),a.call("end",t))}function w(p){var f,c=e.length,v;p===void 0&&(p=1);for(var C=0;C<p;++C)for(o+=(s-o)*r,l.forEach(function(k){k(o)}),f=0;f<c;++f)v=e[f],v.fx==null?v.x+=v.vx*=i:(v.x=v.fx,v.vx=0),v.fy==null?v.y+=v.vy*=i:(v.y=v.fy,v.vy=0);return t}function h(){for(var p=0,f=e.length,c;p<f;++p){if(c=e[p],c.index=p,c.fx!=null&&(c.x=c.fx),c.fy!=null&&(c.y=c.fy),isNaN(c.x)||isNaN(c.y)){var v=Uo*Math.sqrt(.5+p),C=p*zo;c.x=v*Math.cos(C),c.y=v*Math.sin(C)}(isNaN(c.vx)||isNaN(c.vy))&&(c.vx=c.vy=0)}}function x(p){return p.initialize&&p.initialize(e,d),p}return h(),t={tick:w,restart:function(){return u.restart(m),t},stop:function(){return u.stop(),t},nodes:function(p){return arguments.length?(e=p,h(),l.forEach(x),t):e},alpha:function(p){return arguments.length?(o=+p,t):o},alphaMin:function(p){return arguments.length?(n=+p,t):n},alphaDecay:function(p){return arguments.length?(r=+p,t):+r},alphaTarget:function(p){return arguments.length?(s=+p,t):s},velocityDecay:function(p){return arguments.length?(i=1-p,t):1-i},randomSource:function(p){return arguments.length?(d=p,l.forEach(x),t):d},force:function(p,f){return arguments.length>1?(f==null?l.delete(p):l.set(p,x(f)),t):l.get(p)},find:function(p,f,c){var v=0,C=e.length,k,j,_,S,I;for(c==null?c=1/0:c*=c,v=0;v<C;++v)S=e[v],k=p-S.x,j=f-S.y,_=k*k+j*j,_<c&&(I=S,c=_);return I},on:function(p,f){return arguments.length>1?(a.on(p,f),t):a.on(p)}}}function _t(){var e,t,o,n,r=L(-30),s,i=1,l=1/0,u=.81;function a(h){var x,p=e.length,f=Te(e,Wo,Ro).visitAfter(m);for(n=h,x=0;x<p;++x)t=e[x],f.visit(w)}function d(){if(!!e){var h,x=e.length,p;for(s=new Array(x),h=0;h<x;++h)p=e[h],s[p.index]=+r(p,h,e)}}function m(h){var x=0,p,f,c=0,v,C,k;if(h.length){for(v=C=k=0;k<4;++k)(p=h[k])&&(f=Math.abs(p.value))&&(x+=p.value,c+=f,v+=f*p.x,C+=f*p.y);h.x=v/c,h.y=C/c}else{p=h,p.x=p.data.x,p.y=p.data.y;do x+=s[p.data.index];while(p=p.next)}h.value=x}function w(h,x,p,f){if(!h.value)return!0;var c=h.x-t.x,v=h.y-t.y,C=f-x,k=c*c+v*v;if(C*C/u<k)return k<l&&(c===0&&(c=G(o),k+=c*c),v===0&&(v=G(o),k+=v*v),k<i&&(k=Math.sqrt(i*k)),t.vx+=c*h.value*n/k,t.vy+=v*h.value*n/k),!0;if(h.length||k>=l)return;(h.data!==t||h.next)&&(c===0&&(c=G(o),k+=c*c),v===0&&(v=G(o),k+=v*v),k<i&&(k=Math.sqrt(i*k)));do h.data!==t&&(C=s[h.data.index]*n/k,t.vx+=c*C,t.vy+=v*C);while(h=h.next)}return a.initialize=function(h,x){e=h,o=x,d()},a.strength=function(h){return arguments.length?(r=typeof h=="function"?h:L(+h),d(),a):r},a.distanceMin=function(h){return arguments.length?(i=h*h,a):Math.sqrt(i)},a.distanceMax=function(h){return arguments.length?(l=h*h,a):Math.sqrt(l)},a.theta=function(h){return arguments.length?(u=h*h,a):Math.sqrt(u)},a}function Qo(e,t,o){var n,r=L(.1),s,i;typeof e!="function"&&(e=L(+e)),t==null&&(t=0),o==null&&(o=0);function l(a){for(var d=0,m=n.length;d<m;++d){var w=n[d],h=w.x-t||1e-6,x=w.y-o||1e-6,p=Math.sqrt(h*h+x*x),f=(i[d]-p)*s[d]*a/p;w.vx+=h*f,w.vy+=x*f}}function u(){if(!!n){var a,d=n.length;for(s=new Array(d),i=new Array(d),a=0;a<d;++a)i[a]=+e(n[a],a,n),s[a]=isNaN(i[a])?0:+r(n[a],a,n)}}return l.initialize=function(a){n=a,u()},l.strength=function(a){return arguments.length?(r=typeof a=="function"?a:L(+a),u(),l):r},l.radius=function(a){return arguments.length?(e=typeof a=="function"?a:L(+a),u(),l):e},l.x=function(a){return arguments.length?(t=+a,l):t},l.y=function(a){return arguments.length?(o=+a,l):o},l}function qo(e){var t=L(.1),o,n,r;typeof e!="function"&&(e=L(e==null?0:+e));function s(l){for(var u=0,a=o.length,d;u<a;++u)d=o[u],d.vx+=(r[u]-d.x)*n[u]*l}function i(){if(!!o){var l,u=o.length;for(n=new Array(u),r=new Array(u),l=0;l<u;++l)n[l]=isNaN(r[l]=+e(o[l],l,o))?0:+t(o[l],l,o)}}return s.initialize=function(l){o=l,i()},s.strength=function(l){return arguments.length?(t=typeof l=="function"?l:L(+l),i(),s):t},s.x=function(l){return arguments.length?(e=typeof l=="function"?l:L(+l),i(),s):e},s}function Jo(e){var t=L(.1),o,n,r;typeof e!="function"&&(e=L(e==null?0:+e));function s(l){for(var u=0,a=o.length,d;u<a;++u)d=o[u],d.vy+=(r[u]-d.y)*n[u]*l}function i(){if(!!o){var l,u=o.length;for(n=new Array(u),r=new Array(u),l=0;l<u;++l)n[l]=isNaN(r[l]=+e(o[l],l,o))?0:+t(o[l],l,o)}}return s.initialize=function(l){o=l,i()},s.strength=function(l){return arguments.length?(t=typeof l=="function"?l:L(+l),i(),s):t},s.y=function(l){return arguments.length?(e=typeof l=="function"?l:L(+l),i(),s):e},s}var Ko=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",forceCenter:dt,forceCollide:pt,forceLink:vt,forceManyBody:_t,forceRadial:Qo,forceSimulation:kt,forceX:qo,forceY:Jo});class Ho{constructor(t={}){this.options=t}activate(t){const{layouts:o,nodes:n,edges:r,emitter:s,svgPanZoom:i}=t;let{nodeLayouts:l,nodeLayoutMap:u}=this.buildNodeLayouts(n.value,o,{x:0,y:0});const a=this.createSimulation(l,this.forceLayoutEdges(r.value));a.on("tick",()=>{var p,f;for(const c of l){const v=o==null?void 0:o[c.id];v&&(v.x=(p=c.x)!=null?p:0,v.y=(f=c.y)!=null?f:0)}});const d=()=>{a.alpha(.1).restart()},m=p=>{for(const[f,c]of Object.entries(p)){const v=u[f];v.fx=c.x,v.fy=c.y}d()},w=p=>{var f;for(const[c,v]of Object.entries(p)){const C=this.getNodeLayout(o,c),k=(f=u==null?void 0:u[c])!=null?f:{x:0,y:0};C.value.fixed||this.options.positionFixedByDrag?(k.fx=v.x,k.fy=v.y,C.value.fixed=!0):(k.x=v.x,k.y=v.y,delete k.fx,delete k.fy)}d()},h=({node:p,event:f})=>{if(this.options.positionFixedByClickWithAltKey&&f.altKey){const c=this.getNodeLayout(o,p);let v=u==null?void 0:u[p];v||(v={id:p,x:0,y:0},u[p]=v),c.value.fixed?(delete c.value.fixed,v.x=v.fx||v.x,v.y=v.fy||v.y,delete v.fx,delete v.fy):(c.value.fixed=!0,v.fx=v.x,v.fy=v.y),d()}},x=Y(()=>[Object.keys(n.value),r.value],()=>{const p=i.getViewArea();({nodeLayouts:l,nodeLayoutMap:u}=this.buildNodeLayouts(n.value,o,p.center)),a.nodes(l);const f=a.force("edge");f&&f.links(this.forceLayoutEdges(r.value)),d()},{deep:!0});s.on("node:dragstart",m),s.on("node:pointermove",m),s.on("node:dragend",w),s.on("node:click",h),this.onDeactivate=()=>{a.stop(),x(),s.off("node:dragstart",m),s.off("node:pointermove",m),s.off("node:dragend",w),s.off("node:click",h)}}deactivate(){this.onDeactivate&&this.onDeactivate()}createSimulation(t,o){if(this.options.createSimulation)return this.options.createSimulation(Ko,t,o);{const n=vt(o).id(r=>r.id);return kt(t).force("edge",n.distance(100)).force("charge",_t()).force("collide",pt(50).strength(.2)).force("center",dt().strength(.05)).alphaMin(.001)}}buildNodeLayouts(t,o,n){const r=Object.keys(t).filter(l=>!(l in o));for(const l of r)o[l]=je({},n);const s=this.forceNodeLayouts(o),i=Object.fromEntries(s.map(l=>[l.id,l]));return{nodeLayouts:s,nodeLayoutMap:i}}forceNodeLayouts(t){return Object.entries(t).map(([o,n])=>n.fixed?fo(je({id:o},n),{fx:n.x,fy:n.y}):je({id:o},n))}forceLayoutEdges(t){return Object.values(t).map(o=>({source:o.source,target:o.target}))}getNodeLayout(t,o){const n=Mt(t,o);return n.value||(n.value={x:0,y:0}),n}}const Go=P(" No results "),Yo=ne({props:{modelValue:{type:Object,default:null},orgId:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e,n=D({get(){return o.modelValue},set(u){t("update:modelValue",u)}}),r=B(""),s=me(),i=D(()=>s.state.Project.projects.filter(u=>u.title.indexOf(r.value)>=0||u.id.toString().indexOf(r.value)>=0)),l=(u,a,d)=>{const m=()=>r.value=u;i.value.length===0?s.dispatch("Project/fetchProjects",{orgId:o.orgId}).then(()=>a(m)):a(m)};return(u,a)=>(M(),$(N(lt),{modelValue:N(n),"onUpdate:modelValue":a[0]||(a[0]=d=>at(n)?n.value=d:null),label:"\u9879\u76EE\u5217\u8868","map-options":"","emit-value":"",dark:"",color:"text-white",standout:"bg-white text-black",behavior:"menu",options:N(i).map(d=>({label:d.title,value:d})),onFilter:l},{"no-option":F(()=>[b(H,null,{default:F(()=>[b(K,{class:"text-grey"},{default:F(()=>[Go]),_:1})]),_:1})]),_:1},8,["modelValue","options"]))}});var Xo=oe(Yo,[["__file","/Users/boyan/development/opensource/gopherCronFE/src/components/SelectProject.vue"]]);const Zo=ne({props:{modelValue:{type:Array,default:null},projectId:{type:Number,required:!0},workflowId:{type:Number,required:!0},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e,n=D({get(){return o.modelValue},set(u){t("update:modelValue",u)}}),r=B(""),s=me(),i=D(()=>{var u;return((u=s.state.WorkFlowTask.tasks.get(o.projectId))==null?void 0:u.filter(a=>(a.workflowId===0||a.workflowId===o.workflowId)&&(a.name.indexOf(r.value)>=0||a.id.indexOf(r.value)>=0)))||[]}),l=(u,a,d)=>{const m=()=>r.value=u;i.value.length===0?s.dispatch("WorkFlowTask/fetchTasks",{projectId:o.projectId}).then(()=>a(m)):a(m)};return ie(()=>{Y(()=>o.projectId,(u,a)=>{t("update:modelValue",void 0)})}),(u,a)=>(M(),$(N(lt),{modelValue:N(n),"onUpdate:modelValue":a[0]||(a[0]=d=>at(n)?n.value=d:null),label:"\u4EFB\u52A1\u5217\u8868","map-options":"","emit-value":"",dark:"",color:"text-white",standout:"bg-white text-black",behavior:"menu",multiple:"",disable:o.disabled,options:N(i).map(d=>({label:d.name,value:d})),onFilter:l},null,8,["modelValue","disable","options"]))}});var en=oe(Zo,[["__file","/Users/boyan/development/opensource/gopherCronFE/src/components/SelectWorkFlowTask.vue"]]);function Ce(e){const t=Object.assign({},e);return t.deps&&(t.deps=Object.assign([],t.deps)),t}function tn(e){const t=new Map,o=new Map;for(const l of e)if(t.set(l.id,l.deps||[]),l.deps)for(const u of l.deps){const a=o.get(u)||[];a.push(l.id),o.set(u,a)}let n=[];const r=new Map;t.forEach((l,u)=>{r.set(u,l.length),r.get(u)===0&&n.push(u)});const s=[];s.push(Object.assign([],n)),n=n.reverse();let i=[];for(;;){const l=n.pop();if(l===void 0){if(i.length===0)break;n=i.reverse(),s.push(Object.assign([],i)),i=[]}else{const u=o.get(l);if(!u)continue;for(const a of u){let d=r.get(a);d!==void 0&&(d--,r.set(a,d),d===0&&i.push(a))}}}return s}const on=ue("div",{class:"text-h6"},"\u6DFB\u52A0\u65B0\u7684\u4EFB\u52A1\u8282\u70B9",-1),nn={class:"tw-flex tw-flex-col tw-gap-2"},rn=P("\u6DFB\u52A0"),an=P("\u6DFB\u52A0"),ln=P("\u91CD\u7F6E\u89C6\u56FE"),sn=P("\u91CD\u7F6E"),un=ne({props:{workflowId:{type:Number,required:!0},tasks:{type:Object,required:!0},modelValue:{type:Object,default:new Array(0)},orgId:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{expose:t,emit:o}){const n=e,r=B(!1),s=B(!1),i=B(),l=B(),u=B([]),a=B([]),d=y=>k[y].name||y,m=y=>y.join(" -> "),w=y=>y.map(g=>k[g].name).join(" -> "),h=y=>{const g=y.split(" -> ");if(g.length!==2)throw new Error(`Invalid edge name: ${y}`);return[g[0],g[1]]},x="#99F6e4",p=new Ho,f=y=>y?y.color:x,c=y=>y?y.color:x,v={view:{layoutHandler:p,scalingObjects:!1,fit:!1},node:{selectable:!0,label:{direction:Dt.NORTH,color:f},normal:{color:f},hover:{color:f},focusring:{color:x}},edge:{selectable:!0,normal:{color:c},hover:{color:c},selected:{color:c,width:4,dasharray:"10",linecap:"round",animate:!0,animationSpeed:10},marker:{source:{type:"none",width:4,height:4,margin:-1,units:"strokeWidth",color:null},target:{type:"arrow",width:4,height:4,margin:-1,units:"strokeWidth",color:null}}}},C=D(()=>{const y=()=>{var E;(E=l.value)==null||E.hide()};return{"view:load":()=>{},"view:contextmenu":E=>{const{event:A}=E;A.stopPropagation(),A.preventDefault();const O=l.value;O&&(y(),O.show(A))},"node:select":E=>{y()},"edge:select":E=>{y()}}}),k=Ke({}),j=y=>{var E;const g=(E=y.state)==null?void 0:E.currentStatus;return g==="done"?x:g==="running"?"green":g==="failed"?"red":g==="starting"?"white":"gray"},_=D(()=>{const y={};for(const g of n.modelValue)y[g.id]={id:g.id,name:g.name,color:j(g)};return y}),S=D(()=>{const y=new Map;for(const g of n.modelValue)y.set(g.id,g);return y});function I(y){for(const g of Object.keys(k))delete k[g];for(const g of Object.keys(y))k[g]=Object.assign({},y[g]);u.value=[]}const T=Ke({}),V=D(()=>{const y={};for(const g of n.modelValue)if(!!g.deps)for(const E of g.deps)y[m([E,g.id])]={source:E,target:g.id,color:j(g)};return y});function R(y){for(const g of Object.keys(T))delete T[g];for(const g of Object.keys(y))T[g]=Object.assign({},y[g]);a.value=[]}const W=B({nodes:{}}),U=D(()=>{const y={},g=tn(n.modelValue),E=50,A=50;let O=0;for(const ee of g){let de=0;for(const At of ee)y[At]={x:de*E+O*E/2,y:O*A,fixed:!1},de++;O++}return{nodes:y}});function Me(y){const g=W.value.nodes;for(const E of Object.keys(g))delete g[E];for(const E of Object.keys(y.nodes))g[E]=Object.assign({},y.nodes[E])}function De(){I(_.value),R(V.value),Me(U.value)}function xt(y,g){let E=0,A=!1;for(const O of y){if(O.id===g){y.splice(E,1),A=!0;break}E++}if(!A)throw new Error(`Can not remove node: ${g}`);for(const O of y)if(O.deps!==void 0){const ee=O.deps.indexOf(g,0);ee>-1&&(O.deps.splice(ee,1),O.deps.length===0&&delete O.deps)}}function Pe(y){const g=n.modelValue.map(Ce);y.forEach(E=>xt(g,E)),o("update:modelValue",g)}function Fe(y,g){const E=n.modelValue.map(Ce);for(const A of E)if(A.id===g){A.deps||(A.deps=[]),A.deps.push(y),Nt(),o("update:modelValue",E);return}throw new Error(`Can not add edge: ${m([y,g])}`)}function bt(y,g,E){for(const A of y)if(A.id===E&&A.deps!==void 0){const O=A.deps.indexOf(g,0);if(O>-1){A.deps.splice(O,1),A.deps.length===0&&delete A.deps;return}}throw new Error(`Can not remove edge: ${m([g,E])}`)}function $e(y){const g=n.modelValue.map(Ce);for(const E of y){const[A,O]=h(E);bt(g,A,O)}o("update:modelValue",g)}function Nt(){a.value.splice(0,a.value.length),u.value.splice(0,u.value.length)}function Le(){o("update:modelValue",n.tasks)}const We=(y,g)=>T[m([y,g])]===void 0&&T[m([g,y])]===void 0,Ft=D(()=>{const y=u.value;if(y.length===2){const[g,E]=y;return We(g,E)}return!1}),ye=B(!1),X=B(),Z=B([]);function Re(){ye.value=!0}function Ue(){X.value=void 0,Z.value=[],ye.value=!1}function Et(){const y=[];Z.value.forEach((g,E,A)=>{var O;y.push({name:g.name,id:`${(O=X.value)==null?void 0:O.id}_${g.id}`,origin:g})}),o("update:modelValue",[...n.modelValue,...y]),Ue()}ie(()=>{Y(()=>n.tasks,(E,A)=>{r.value=!1,s.value=!1,g.value=void 0,Le()}),Y(()=>n.modelValue,E=>{I(_.value),R(V.value),JSON.stringify(E)===JSON.stringify(n.tasks)&&Me(U.value),r.value=!0});function y(E,A){try{for(const O of Object.keys(E)){const ee=E[O],de=A[O];if(Math.abs(ee.x-de.x)>.5||Math.abs(ee.y-de.y)>.5)return!1}}catch{return!1}return!0}const g=B();Y(()=>[W.value,i.value,r.value],([E,A,O])=>{!s.value&&A&&O&&y(E.nodes,g.value)&&setTimeout(()=>{Ae(()=>{A.panToCenter(),s.value=!0})},500),g.value=JSON.parse(JSON.stringify(Pt(W.value.nodes)))},{deep:!0})});function It(){Pe(u.value)}function jt(){$e(a.value)}function Ct(){const[y]=u.value,g=Se(()=>{if(u.value.length!==1)return;const[E]=u.value;y===E||!We(y,E)||(Fe(y,E),g())})}return t({ShowAddNodeDialog:Re,RemoveSelectedNodes:It,SelectedNodes:u,RemoveSelectedEdges:jt,SelectedEdges:a,ResetView:De,AddEdge:Fe,SetAddEdgeMode:Ct,NodeMapTask:S}),(y,g)=>{const E=$t("v-network-graph");return M(),ge(Ut,null,[r.value?(M(),$(E,{key:0,ref_key:"graph",ref:i,"selected-nodes":u.value,"onUpdate:selected-nodes":g[0]||(g[0]=A=>u.value=A),"selected-edges":a.value,"onUpdate:selected-edges":g[1]||(g[1]=A=>a.value=A),layouts:W.value,"onUpdate:layouts":g[2]||(g[2]=A=>W.value=A),class:Lt(s.value?"":"tw-opacity-0"),nodes:N(k),edges:N(T),configs:v,"zoom-level":.75,"event-handlers":N(C)},null,8,["selected-nodes","selected-edges","layouts","class","nodes","edges","zoom-level","event-handlers"])):J("v-if",!0),b(Wt,{modelValue:ye.value,"onUpdate:modelValue":g[5]||(g[5]=A=>ye.value=A),class:"tw-w-screen tw-h-screen",onHide:Ue},{default:F(()=>[b(st,{class:"tw-w-96 q-pa-sm"},{default:F(()=>[b(se,null,{default:F(()=>[on]),_:1}),b(se,null,{default:F(()=>[ue("div",nn,[b(Xo,{modelValue:X.value,"onUpdate:modelValue":g[3]||(g[3]=A=>X.value=A),"org-id":e.orgId},null,8,["modelValue","org-id"]),b(en,{modelValue:Z.value,"onUpdate:modelValue":g[4]||(g[4]=A=>Z.value=A),disabled:X.value===void 0,"project-id":X.value?X.value.id:0,"workflow-id":n.workflowId},null,8,["modelValue","disabled","project-id","workflow-id"])])]),_:1}),b(zt,{align:"around"},{default:F(()=>[b(q,{class:"tw-w-full tw-mx-2 tw-my-3",color:Z.value?"primary":"","text-color":Z.value?"black":"white",disable:!Z.value,onClick:Et},{default:F(()=>[rn]),_:1},8,["color","text-color","disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),b(N(Rt),{ref_key:"viewMenu",ref:l,"touch-position":"","context-menu":""},{default:F(()=>[b(Qt,{dense:""},{default:F(()=>[re((M(),$(H,{key:"add-task",clickable:"",onClick:Re},{default:F(()=>[b(K,null,{default:F(()=>[an]),_:1})]),_:1})),[[ae,!0]]),N(Ft)?re((M(),$(H,{key:"add-edge",clickable:"",onClick:g[6]||(g[6]=()=>Fe(u.value[0],u.value[1]))},{default:F(()=>[b(K,null,{default:F(()=>[P("\u6DFB\u52A0\u6307\u5411\uFF1A"+he(w(u.value)),1)]),_:1})]),_:1})),[[ae,!0]]):J("v-if",!0),a.value.length>0?re((M(),$(H,{key:"remove-edge",clickable:"",onClick:g[7]||(g[7]=()=>$e(a.value))},{default:F(()=>[b(K,null,{default:F(()=>[P(" \u5220\u9664\u6307\u5411\uFF1A"+he(a.value.map(h).map(w).join(", ")),1)]),_:1})]),_:1})),[[ae,!0]]):J("v-if",!0),u.value.length>0?re((M(),$(H,{key:"remove-task",clickable:"",onClick:g[8]||(g[8]=()=>Pe(u.value))},{default:F(()=>[b(K,null,{default:F(()=>[P(" \u5220\u9664\u8282\u70B9\uFF1A"+he(u.value.map(d).join(", ")),1)]),_:1})]),_:1})),[[ae,!0]]):J("v-if",!0),b(it),re((M(),$(H,{key:"reset-view",clickable:"",onClick:De},{default:F(()=>[b(K,null,{default:F(()=>[ln]),_:1})]),_:1})),[[ae,!0]]),re((M(),$(H,{key:"reset",clickable:"",onClick:Le},{default:F(()=>[b(K,null,{default:F(()=>[sn]),_:1})]),_:1})),[[ae,!0]])]),_:1})]),_:1},512)],64)}}});var fn=oe(un,[["__file","/Users/boyan/development/opensource/gopherCronFE/src/components/WorkFlowGraph.vue"]]);const dn={class:"tw-w-full tw-h-full tw-flex tw-flex-col"},cn={class:"tw-flex tw-flex-row tw-gap-4 tw-flex-wrap tw-grow-0"},pn=P(" \u8FD0\u884C "),vn=P(" Kill "),hn=P(" \u4FDD\u5B58 "),gn=P(" \u5237\u65B0 "),wn=P(" \u91CD\u7F6E\u89C6\u56FE "),mn=P(" \u6DFB\u52A0\u65B0\u4EFB\u52A1\u8282\u70B9 "),yn=P(" \u5173\u8054\u8282\u70B9 "),kn=P(" \u5220\u9664\u8282\u70B9\uFF08\u5173\u7CFB\uFF09 "),_n=P(" \u4EFB\u52A1\u8BE6\u60C5 "),xn=P(" \u4EFB\u52A1\u65E5\u5FD7 "),bn={class:"tw-grow tw-w-full tw-overflow-hidden"},Nn=ne({props:{id:{type:Number,required:!0},orgId:{type:String,required:!0}},setup(e){const t=e,{width:o}=ft(),n=D(()=>o.value<1024),r=B(),s=D(()=>r.value===void 0||r.value.SelectedNodes.length===0&&r.value.SelectedEdges.length===0),i=D(()=>{if(!r.value||r.value.SelectedNodes.length!==1)return;const j=r.value.SelectedNodes;return r.value.NodeMapTask.get(j[j.length-1])}),l=B([]),u=B([]),a=me(),d=B(!1),m=B(!1),w=B();async function h(){w.value=await Kt(t.id)}const x=D(()=>w.value!==void 0&&w.value.state!==null&&w.value.state.status==="running");async function p(j){const _=new Map,S=new Map;for(const I of j){const V=a.state.Root.workflowTasks.find(W=>W.id===I.taskId);if(V===void 0)throw new Error(`workflowTasks missing projectId=${I.projectId} taskId=${I.taskId}`);const R=`${I.projectId}_${I.taskId}`;if(S.set(R,V),_.has(R)||_.set(R,[]),I.dependencyProjectId>0&&I.dependencyTaskId!==""){const W=`${I.dependencyProjectId}_${I.dependencyTaskId}`,U=_.get(R);U!==void 0&&_.set(R,[...U,W])}}return Array.from(_.keys()).map(I=>{const T=S.get(I);if(T===void 0)throw new Error(`keyMapTask missing ${I}`);return{name:T.name,id:I,deps:_.get(I),origin:T,state:a.state.Root.workflowTaskStates.find(V=>V.projectId===T.projectId&&V.taskId===T.id)}})}function f(j){const _=[],S=new Map;for(const I of j)S.set(I.id,I.origin);for(const I of j)if(I.deps!==void 0&&I.deps.length>0)for(const T of I.deps){const V=S.get(T);if(V===void 0)throw new Error("original task object missing");_.push({id:0,workflowId:0,createTime:0,projectId:I.origin.projectId,taskId:I.origin.id,dependencyProjectId:V.projectId,dependencyTaskId:V.id})}else _.push({id:0,workflowId:0,createTime:0,projectId:I.origin.projectId,taskId:I.origin.id,dependencyProjectId:0,dependencyTaskId:""});return _}async function c(j=!1){await a.dispatch("fetchWorkflowEdges",{workflowId:t.id});const _=await p(a.state.Root.workflowEdges);j?u.value=_:l.value=_}ie(()=>{console.log("subscribe"),a.dispatch("subscribeTopic",["/workflow/status/"+t.id,"/workflow/task/status/"+t.id]),h(),c(),Y(()=>t.id,async j=>{console.log("subscribe"),a.dispatch("subscribeTopic",["/workflow/status/"+t.id,"/workflow/task/status/"+t.id]),await h(),await c()}),a.watch(j=>[j.Root.eventWorkFlowTask,j.Root.eventWorkFlow],async([j,_])=>{(j===void 0||j.workFlowId!==t.id)&&(_===void 0||_.workFlowId!==t.id)||(await h(),await c(!0))})});const v=D(()=>{const j=_=>_.map(S=>Je(qe({},S),{origin:void 0,state:void 0}));return JSON.stringify(j(l.value))!==JSON.stringify(j(u.value))}),C=B(!1);async function k(){C.value=!0,await a.dispatch("updateWorkFlowEdges",{workflowId:t.id,edges:f(u.value)}),await c(),C.value=!1}return(j,_)=>(M(),ge("div",dn,[b(Ge,{modelValue:d.value,"onUpdate:modelValue":_[0]||(_[0]=S=>d.value=S),content:"\u786E\u5B9A\u8981\u7ACB\u5373\u6267\u884C\u5417\uFF1F",onConfirm:_[1]||(_[1]=()=>N(qt)(N(a).getters.apiv1,t.id).then(()=>{d.value=!1,c()}))},null,8,["modelValue"]),b(Ge,{modelValue:m.value,"onUpdate:modelValue":_[2]||(_[2]=S=>m.value=S),type:"warning",content:"\u786E\u5B9A\u8981\u505C\u6B62\u6267\u884C\u5417\uFF1F",onConfirm:_[3]||(_[3]=()=>N(Jt)(t.id).then(()=>{m.value=!1,c()}))},null,8,["modelValue"]),ue("div",cn,[N(x)?(M(),$(q,{key:1,dense:N(n),color:"red",onClick:_[5]||(_[5]=S=>m.value=!0)},{default:F(()=>[vn]),_:1},8,["dense"])):(M(),$(q,{key:0,dense:N(n),color:"primary","text-color":"black",loading:N(x),onClick:_[4]||(_[4]=S=>d.value=!0)},{default:F(()=>[pn]),_:1},8,["dense","loading"])),b(q,{dense:N(n),color:N(v)?"primary":"","text-color":N(v)?"black":"white",disable:!N(v),loading:C.value,onClick:k},{default:F(()=>[hn]),_:1},8,["dense","color","text-color","disable","loading"]),b(q,{dense:N(n),flat:"",icon:"refresh",title:"\u5237\u65B0",onClick:_[6]||(_[6]=()=>c())},{default:F(()=>[gn]),_:1},8,["dense"]),b(q,{dense:N(n),flat:"",icon:"restart_alt",title:"\u91CD\u7F6E\u89C6\u56FE",onClick:_[7]||(_[7]=()=>r.value.ResetView())},{default:F(()=>[wn]),_:1},8,["dense"]),b(q,{dense:N(n),flat:"",icon:"add",title:"\u6DFB\u52A0\u65B0\u4EFB\u52A1\u8282\u70B9",onClick:_[8]||(_[8]=()=>r.value.ShowAddNodeDialog())},{default:F(()=>[mn]),_:1},8,["dense"]),N(i)!==void 0?(M(),$(q,{key:"create_relationship",dense:N(n),flat:"",icon:"north_east",title:"\u5173\u8054\u8282\u70B9",disable:!r.value||r.value.SelectedNodes.length!==1,onClick:_[9]||(_[9]=()=>{r.value.SetAddEdgeMode(),N(a).getters.$q.notify({type:"info",message:"\u8BF7\u9009\u62E9\u6709\u6548\u7684\u4E0B\u6E38\u8282\u70B9",icon:"tips_and_updates",position:"top-right"})})},{default:F(()=>[yn]),_:1},8,["dense","disable"])):J("v-if",!0),N(i)!==void 0?(M(),$(q,{key:"delete_task_or_relationship",dense:N(n),icon:"delete",disable:N(s),title:"\u5220\u9664\u5DF2\u9009\u7684\u8282\u70B9\u53CA\u8282\u70B9\u5173\u8054\u5173\u7CFB",flat:"",onClick:_[10]||(_[10]=()=>{r.value.SelectedNodes.length>0&&r.value.RemoveSelectedNodes(),r.value.SelectedEdges.length>0&&r.value.RemoveSelectedEdges()})},{default:F(()=>[kn]),_:1},8,["dense","disable"])):J("v-if",!0),N(i)!==void 0?(M(),$(q,{key:"jump_task_detail",dense:N(n),icon:"task_alt",flat:"",to:{name:"workflow_task",params:{projectId:N(i).origin.projectId,taskId:N(i).origin.id}}},{default:F(()=>[_n]),_:1},8,["dense","to"])):J("v-if",!0),N(i)!==void 0?(M(),$(q,{key:"jump_task_logs",dense:N(n),icon:"view_timeline",flat:"",to:{name:"workflow_task_logs",params:{projectId:N(i).origin.projectId,taskId:N(i).origin.id}}},{default:F(()=>[xn]),_:1},8,["dense","to"])):J("v-if",!0)]),ue("div",bn,[b(fn,{ref_key:"workflow",ref:r,modelValue:u.value,"onUpdate:modelValue":_[11]||(_[11]=S=>u.value=S),"org-id":e.orgId,"workflow-id":t.id,tasks:l.value},null,8,["modelValue","org-id","workflow-id","tasks"])])]))}});var Fn=oe(Nn,[["__file","/Users/boyan/development/opensource/gopherCronFE/src/pages/WorkflowGraph.vue"]]);const En={key:0,class:"text-h6"},In={key:1,class:"text-h6"},jn=ne({props:{id:{type:Number,default:0}},setup(e){const t=e,o=B({id:0,title:"",oid:"",cronExpr:"0 0 0 * * * *",remark:"",createTime:0,status:Ht,state:null}),n=Gt(),r=me(),s=D(()=>r.state.WorkFlow.workflows.get(t.id)),i=B(o.value),l=B(!0);Y(s,(f,c)=>{l.value&&(i.value=Object.assign({},s.value||o.value))});function u(){i.value=Object.assign({},s.value||o.value)}const a=B(!1);async function d(){a.value=!0;try{const f=i.value;w.value?(await Zt(r.getters.apiv1,r.getters.currentOrg,f.title.trim(),f.remark.trim(),f.cronExpr.trim(),f.status),n.push({name:"workflows"})):(await eo(r.getters.apiv1,i.value),l.value=!0,r.commit("success",{message:"\u66F4\u65B0\u6210\u529F"}),await h())}catch(f){console.error(f),r.commit("error",{error:f})}a.value=!1}const m=ut(),w=D(()=>m.name&&m.name.toString()==="create_workflow");async function h(){w.value||r.dispatch("WorkFlow/fetchWorkFlow",{id:t.id})}const x=D(()=>JSON.stringify(s.value)!==JSON.stringify(i.value)),p=D(()=>{const{title:f,cronExpr:c}=i.value;return f.trim()!==""&&c.trim()!==""});return ie(()=>{h(),Y(()=>t.id,async f=>{await h()})}),(f,c)=>(M(),$(Xt,{onSubmit:d,onReset:u},{default:F(()=>[b(se,null,{default:F(()=>[N(w)?(M(),ge("div",En,"\u521B\u5EFA\u4EFB\u52A1\u7F16\u6392")):(M(),ge("div",In,"\u4EFB\u52A1\u7F16\u6392\u8BE6\u60C5"))]),_:1}),b(se,null,{default:F(()=>[b(Ee,{modelValue:i.value.title,"onUpdate:modelValue":c[0]||(c[0]=v=>i.value.title=v),type:"text",label:"\u540D\u79F0",square:"",filled:"",class:"tw-mb-4"},null,8,["modelValue"]),b(Ee,{key:"cron",modelValue:i.value.cronExpr,"onUpdate:modelValue":c[1]||(c[1]=v=>i.value.cronExpr=v),label:"\u8C03\u5EA6\u8BA1\u5212 (*\u79D2 *\u5206 *\u65F6 *\u65E5 *\u6708 *\u5468 *\u5E74)",square:"",filled:"",class:"tw-mb-4"},null,8,["modelValue"]),b(Ee,{modelValue:i.value.remark,"onUpdate:modelValue":c[2]||(c[2]=v=>i.value.remark=v),type:"textarea",label:"\u5907\u6CE8",square:"",filled:""},null,8,["modelValue"]),b(Yt,{key:"status",modelValue:i.value.status,"onUpdate:modelValue":c[3]||(c[3]=v=>i.value.status=v),"false-value":2,"true-value":1,label:"\u662F\u5426\u542F\u7528",class:"tw-mb-4"},null,8,["modelValue"])]),_:1}),b(se,{align:"right",class:"tw-flex tw-gap-4 tw-flex-col-reverse lg:tw-flex-row lg:tw-justify-end"},{default:F(()=>[b(q,{type:"reset",flat:"",label:"\u91CD\u7F6E",class:"lg:tw-w-24 tw-w-full",disable:!N(x)},null,8,["disable"]),b(q,{color:"primary","text-color":"black",type:"submit",label:N(w)?"\u521B\u5EFA":"\u4FDD\u5B58",disable:!N(x)||!N(p),loading:a.value,class:"lg:tw-w-24 tw-w-full"},null,8,["label","disable","loading"])]),_:1})]),_:1}))}});var Cn=oe(jn,[["__file","/Users/boyan/development/opensource/gopherCronFE/src/components/WorkFlowDetail.vue"]]);const An=P("\u5F00\u59CB\u65F6\u95F4"),Sn=P("\u7ED3\u675F\u65F6\u95F4"),Vn=ne({props:{id:{type:Number,required:!0}},setup(e){const t=e,o=me(),n=D(()=>o.state.Root.workflowLogs),r=D(()=>o.state.Root.workflowLogsTotal),s=D(()=>o.state.Root.loadingWorkflowLogs),i=B({sortBy:"",descending:!1,page:1,rowsPerPage:5,rowsNumber:0}),l=B();ie(()=>{Ae(()=>{var d;(d=l.value)==null||d.$el.querySelector("table.q-table").classList.add("tw-table-fixed")})});const u=()=>{Ae(()=>{var m;const d=(m=l.value)==null?void 0:m.$el.querySelector(".scroll");d==null||d.scrollTo({top:0})})};function a({pagination:{page:d,rowsPerPage:m}}){const w=i.value;w.page=d,w.rowsPerPage=m,u()}return Se(()=>{const d=i.value;d.rowsNumber=r.value}),ie(async()=>{Se(async()=>{const d=i.value;await o.dispatch("fetchWorkFlowLogs",{workflowId:t.id,page:d.page,pageSize:d.rowsPerPage})})}),(d,m)=>(M(),$(N(oo),{ref_key:"table",ref:l,pagination:i.value,"onUpdate:pagination":m[0]||(m[0]=w=>i.value=w),class:"tw-w-full tw-h-full tw-bg-[#121212]","rows-per-page-options":[5,10,15],title:"\u6267\u884C\u65E5\u5FD7",rows:N(n),loading:N(s),"row-key":"id",color:"primary",flat:"","hide-header":"",onRequest:a},{loading:F(()=>[b(to,{showing:"",color:"primary"})]),body:F(w=>[b(st,{class:"tw-my-4 tw-mx-4",flat:"",bordered:""},{default:F(()=>[b(H,null,{default:F(()=>[b(K,null,{default:F(()=>[b(ke,{overline:""},{default:F(()=>[An]),_:1}),b(ke,null,{default:F(()=>[P(he(N(Ye)(w.row.startTime*1e3)),1)]),_:2},1024)]),_:2},1024),b(K,null,{default:F(()=>[b(ke,{overline:""},{default:F(()=>[Sn]),_:1}),b(ke,null,{default:F(()=>[P(he(N(Ye)(w.row.endTime*1e3)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),b(it),b(se,{class:"tw-w-full tw-overflow-x-auto"},{default:F(()=>[b(ro,{json:w.row.result},null,8,["json"])]),_:2},1024)]),_:2},1024)]),_:1},8,["pagination","rows","loading"]))}});var On=oe(Vn,[["__file","/Users/boyan/development/opensource/gopherCronFE/src/components/WorkFlowLogs.vue"]]);const Tn={class:"lg:tw-px-4 lg:tw-pt-2 tw-w-full tw-h-full tw-flex tw-flex-col tw-box-border"},Bn={class:"tw-flex tw-h-full tw-w-full tw-overflow-hidden"},Mn={class:"tw-hidden lg:tw-block"},Dn=ne({props:{id:{type:Number,default:0},orgId:{type:String,required:!0}},setup(e){const t=e,{width:o}=ft(),n=ut(),r=D(()=>n.name&&n.name.toString()==="create_workflow"),s=D(()=>{var i;if(r.value)return"detail";if(n.name){const l=n.name.toString();if(l==="workflow_logs")return"logs";if(l==="workflow_graph")return"graph";if(l==="workflow_detail")return"detail"}throw new Error(`Unknown route name ${(i=n.name)==null?void 0:i.toString()}`)});return(i,l)=>(M(),ge("div",Tn,[N(r)?J("v-if",!0):(M(),$(He,{key:0,"model-value":N(s),"active-color":"primary",align:"left",class:"lg:tw-hidden tw-display"},{default:F(()=>[b(le,{name:"graph",label:"\u6D41\u7A0B",to:{name:"workflow_graph",params:{workflowId:t.id}},replace:""},null,8,["to"]),b(le,{name:"logs",label:"\u65E5\u5FD7",to:{name:"workflow_logs",params:{workflowId:t.id}},replace:""},null,8,["to"]),b(le,{name:"detail",label:"\u8BE6\u60C5",to:{name:"workflow_detail",params:{workflowId:t.id}},replace:""},null,8,["to"])]),_:1},8,["model-value"])),ue("div",Bn,[b(no,{"model-value":N(s),animated:"",vertical:N(o)>=1024,class:"tw-w-full tw-h-full tw-bg-[#121212] tw-p-0 lg:tw-pr-4 tw-box-border"},{default:F(()=>[b(Ie,{name:"graph"},{default:F(()=>[b(Fn,{id:t.id,"org-id":e.orgId},null,8,["id","org-id"])]),_:1}),b(Ie,{name:"logs"},{default:F(()=>[b(On,{id:t.id},null,8,["id"])]),_:1}),b(Ie,{name:"detail"},{default:F(()=>[b(Cn,{id:t.id},null,8,["id"])]),_:1})]),_:1},8,["model-value","vertical"]),ue("div",Mn,[N(r)?J("v-if",!0):(M(),$(He,{key:0,"model-value":N(s),"active-color":"primary",vertical:"","switch-indicator":"",align:"left"},{default:F(()=>[b(le,{name:"graph",label:"\u6D41\u7A0B",to:{name:"workflow_graph",params:{workflowId:t.id}},replace:""},null,8,["to"]),b(le,{name:"logs",label:"\u65E5\u5FD7",to:{name:"workflow_logs",params:{workflowId:t.id}},replace:""},null,8,["to"]),b(le,{name:"detail",label:"\u8BE6\u60C5",to:{name:"workflow_detail",params:{workflowId:t.id}},replace:""},null,8,["to"])]),_:1},8,["model-value"]))])])]))}});var zn=oe(Dn,[["__file","/Users/boyan/development/opensource/gopherCronFE/src/pages/WorkflowTabs.vue"]]);export{zn as default};
