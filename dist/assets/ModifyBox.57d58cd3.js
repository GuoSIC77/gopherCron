var q=Object.defineProperty,U=Object.defineProperties;var N=Object.getOwnPropertyDescriptors;var f=Object.getOwnPropertySymbols;var O=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable;var y=(u,a,s)=>a in u?q(u,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):u[a]=s,V=(u,a)=>{for(var s in a||(a={}))O.call(a,s)&&y(u,s,a[s]);if(f)for(var s of f(a))S.call(a,s)&&y(u,s,a[s]);return u},b=(u,a)=>U(u,N(a));import{q as j,r as J,c as g,dv as n,y as p,z as c,A as i,B as r,C as B,F as E,W as I,D as m,K as v,E as C,Q as D,J as z,L as K,m as L,dw as R,dx as W}from"./index.1dcbf74c.js";import{Q as $}from"./QForm.8b7788ad.js";const G={class:"text-h6"},H={class:"tw-flex tw-flex-row-reverse tw-gap-4"},Y=j({props:{modelValue:{type:Boolean,default:!1},user:{type:Object,default:null}},emits:["update:modelValue","modify"],setup(u,{emit:a}){const s=u,w=s.user!=null?b(V({},s.user),{password:"",passwordAgain:"",newPassword:""}):{id:void 0,account:"",password:"",newPassword:"",passwordAgain:"",name:""},e=J(Object.assign({},w)),A=g(()=>JSON.stringify(w)===JSON.stringify(e.value)),k=n.getters.isAdmin,x=()=>{e.value=Object.assign({},w)},d=g({get(){return s.modelValue},set(t){t||x(),a("update:modelValue",t)}}),F=async()=>{try{if(e.value.newPassword!==e.value.passwordAgain){n.commit("error",{error:new Error("\u4E24\u6B21\u5BC6\u7801\u4E0D\u4E00\u81F4")});return}(await R({userID:e.value.id?e.value.id:0,password:e.value.password,newPassword:e.value.newPassword})).meta.code===0&&(n.commit("success",{message:"\u4FEE\u6539\u6210\u529F"}),d.value=!1,a("modify",{}))}catch(t){console.log(t)}},P=async()=>{try{if(e.value.password!==e.value.passwordAgain){n.commit("error",{error:new Error("\u4E24\u6B21\u5BC6\u7801\u4E0D\u4E00\u81F4")});return}(await W({account:e.value.account,password:e.value.password,name:e.value.name})).meta.code===0&&(n.commit("success",{message:"\u65B0\u589E\u6210\u529F"}),d.value=!1,a("modify",{}))}catch(t){console.log(t)}},Q=async()=>s.user?await F():await P();return(t,l)=>(p(),c(L,{modelValue:v(d),"onUpdate:modelValue":l[6]||(l[6]=o=>K(d)?d.value=o:null),"no-backdrop-dismiss":!v(A)},{default:i(()=>[r(z,{style:{width:"300px"}},{default:i(()=>[r(B,null,{default:i(()=>[E("div",G,I(u.user?"\u7F16\u8F91":"\u65B0\u589E"),1)]),_:1}),r(B,{class:"q-pt-none"},{default:i(()=>[r($,{class:"tw-w-full",onSubmit:Q},{default:i(()=>[r(m,{key:"name",modelValue:e.value.name,"onUpdate:modelValue":l[0]||(l[0]=o=>e.value.name=o),disable:e.value.id!==void 0,type:"textarea",label:"\u540D\u79F0",autogrow:"",square:"",filled:"",class:"tw-mb-4"},null,8,["modelValue","disable"]),r(m,{key:"account",modelValue:e.value.account,"onUpdate:modelValue":l[1]||(l[1]=o=>e.value.account=o),disable:e.value.id!==void 0,type:"text",label:"\u8D26\u53F7(\u90AE\u7BB1)",square:"",filled:"",class:"tw-mb-4"},null,8,["modelValue","disable"]),e.value.id===void 0||!v(k)?(p(),c(m,{key:"password_again",modelValue:e.value.password,"onUpdate:modelValue":l[2]||(l[2]=o=>e.value.password=o),type:"password",label:e.value.id===void 0?"\u5BC6\u7801":"\u65E7\u5BC6\u7801",square:"",filled:"",class:"tw-mb-4"},null,8,["modelValue","label"])):C("",!0),e.value.id!==void 0?(p(),c(m,{key:"password",modelValue:e.value.newPassword,"onUpdate:modelValue":l[3]||(l[3]=o=>e.value.newPassword=o),type:"password",label:"\u65B0\u5BC6\u7801",square:"",filled:"",class:"tw-mb-4"},null,8,["modelValue"])):C("",!0),r(m,{key:"password_again",modelValue:e.value.passwordAgain,"onUpdate:modelValue":l[4]||(l[4]=o=>e.value.passwordAgain=o),type:"password",label:"\u786E\u8BA4\u65B0\u5BC6\u7801",square:"",filled:"",class:"tw-mb-4"},null,8,["modelValue"]),E("div",H,[r(D,{color:"primary","text-color":"black",type:"submit",label:"\u63D0\u4EA4",class:"lg:tw-w-24 tw-w-full"}),r(D,{flat:"",type:"reset",label:"\u53D6\u6D88",class:"lg:tw-w-24 tw-w-full",onClick:l[5]||(l[5]=o=>d.value=!1)})])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","no-backdrop-dismiss"]))}});export{Y as _};
