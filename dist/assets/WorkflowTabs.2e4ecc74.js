var Vt=Object.defineProperty,St=Object.defineProperties;var Ot=Object.getOwnPropertyDescriptors;var Ue=Object.getOwnPropertySymbols;var Bt=Object.prototype.hasOwnProperty,Tt=Object.prototype.propertyIsEnumerable;var ze=(e,t,n)=>t in e?Vt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,qe=(e,t)=>{for(var n in t||(t={}))Bt.call(t,n)&&ze(e,n,t[n]);if(Ue)for(var n of Ue(t))Tt.call(t,n)&&ze(e,n,t[n]);return e},Je=(e,t)=>St(e,Ot(t));import{Q as Ke,b as Mt,a as re,c as je}from"./QTabPanels.579138ed.js";import{w as ee,b3 as Dt,_ as ne,j as oe,c as T,r as D,u as me,l as M,m as $,q as F,s as b,z as N,A as at,F as P,o as ie,b4 as Pt,aR as He,n as Ve,aB as $t,aS as Lt,E as he,aY as Qt,t as J,J as Wt,k as xe,Q as q,f as ae,I as ve,x as ge,b5 as Rt,b6 as Ut,b7 as zt,b8 as qt,B as Jt,D as lt,b9 as Kt,ba as Ht}from"./index.8ec00635.js";import{u as st,Q as Gt}from"./QToggle.5a0fa396.js";import{C as Ge}from"./Confirm.388454a6.js";import{Q as Yt,b as it,a as se}from"./QDialog.fd4f138b.js";import{Q as Xt,C as le}from"./ClosePopup.229815c6.js";import{a as H,Q as G,b as _e}from"./QItem.fd731537.js";import{Q as ut}from"./QSeparator.91dbf5cf.js";import{Q as Zt}from"./QList.58a4b5dd.js";import{Q as en}from"./QChip.7657ac17.js";import{c as ft,J as tn,Q as nn}from"./JSONViewer.5ccc01f5.js";import{Q as Ie}from"./QInput.18ea454a.js";import{Q as on}from"./QForm.558588c8.js";import{Q as rn}from"./QInnerLoading.dc4d4599.js";import{f as Ye}from"./datetime.6205e5a7.js";import"./uid.42677368.js";import"./touch.8160dcd9.js";import"./use-prevent-scroll.c821079a.js";import"./focus-manager.5de30bde.js";import"./rtl.b51694b1.js";import"./use-key-composition.3f5e825f.js";import"./format.865294d5.js";var an=Object.defineProperty,ln=Object.defineProperties,sn=Object.getOwnPropertyDescriptors,Xe=Object.getOwnPropertySymbols,un=Object.prototype.hasOwnProperty,fn=Object.prototype.propertyIsEnumerable,Ze=(e,t,n)=>t in e?an(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ce=(e,t)=>{for(var n in t||(t={}))un.call(t,n)&&Ze(e,n,t[n]);if(Xe)for(var n of Xe(t))fn.call(t,n)&&Ze(e,n,t[n]);return e},cn=(e,t)=>ln(e,sn(t));function ct(e,t){var n,o=1;e==null&&(e=0),t==null&&(t=0);function r(){var s,i=n.length,l,u=0,a=0;for(s=0;s<i;++s)l=n[s],u+=l.x,a+=l.y;for(u=(u/i-e)*o,a=(a/i-t)*o,s=0;s<i;++s)l=n[s],l.x-=u,l.y-=a}return r.initialize=function(s){n=s},r.x=function(s){return arguments.length?(e=+s,r):e},r.y=function(s){return arguments.length?(t=+s,r):t},r.strength=function(s){return arguments.length?(o=+s,r):o},r}function dn(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return dt(this.cover(t,n),t,n,e)}function dt(e,t,n,o){if(isNaN(t)||isNaN(n))return e;var r,s=e._root,i={data:o},l=e._x0,u=e._y0,a=e._x1,f=e._y1,m,w,h,k,d,c,p,g;if(!s)return e._root=i,e;for(;s.length;)if((d=t>=(m=(l+a)/2))?l=m:a=m,(c=n>=(w=(u+f)/2))?u=w:f=w,r=s,!(s=s[p=c<<1|d]))return r[p]=i,e;if(h=+e._x.call(null,s.data),k=+e._y.call(null,s.data),t===h&&n===k)return i.next=s,r?r[p]=i:e._root=i,e;do r=r?r[p]=new Array(4):e._root=new Array(4),(d=t>=(m=(l+a)/2))?l=m:a=m,(c=n>=(w=(u+f)/2))?u=w:f=w;while((p=c<<1|d)===(g=(k>=w)<<1|h>=m));return r[g]=s,r[p]=i,e}function pn(e){var t,n,o=e.length,r,s,i=new Array(o),l=new Array(o),u=1/0,a=1/0,f=-1/0,m=-1/0;for(n=0;n<o;++n)isNaN(r=+this._x.call(null,t=e[n]))||isNaN(s=+this._y.call(null,t))||(i[n]=r,l[n]=s,r<u&&(u=r),r>f&&(f=r),s<a&&(a=s),s>m&&(m=s));if(u>f||a>m)return this;for(this.cover(u,a).cover(f,m),n=0;n<o;++n)dt(this,i[n],l[n],e[n]);return this}function vn(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,o=this._y0,r=this._x1,s=this._y1;if(isNaN(n))r=(n=Math.floor(e))+1,s=(o=Math.floor(t))+1;else{for(var i=r-n||1,l=this._root,u,a;n>e||e>=r||o>t||t>=s;)switch(a=(t<o)<<1|e<n,u=new Array(4),u[a]=l,l=u,i*=2,a){case 0:r=n+i,s=o+i;break;case 1:n=r-i,s=o+i;break;case 2:r=n+i,o=s-i;break;case 3:n=r-i,o=s-i;break}this._root&&this._root.length&&(this._root=l)}return this._x0=n,this._y0=o,this._x1=r,this._y1=s,this}function hn(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function gn(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function U(e,t,n,o,r){this.node=e,this.x0=t,this.y0=n,this.x1=o,this.y1=r}function wn(e,t,n){var o,r=this._x0,s=this._y0,i,l,u,a,f=this._x1,m=this._y1,w=[],h=this._root,k,d;for(h&&w.push(new U(h,r,s,f,m)),n==null?n=1/0:(r=e-n,s=t-n,f=e+n,m=t+n,n*=n);k=w.pop();)if(!(!(h=k.node)||(i=k.x0)>f||(l=k.y0)>m||(u=k.x1)<r||(a=k.y1)<s))if(h.length){var c=(i+u)/2,p=(l+a)/2;w.push(new U(h[3],c,p,u,a),new U(h[2],i,p,c,a),new U(h[1],c,l,u,p),new U(h[0],i,l,c,p)),(d=(t>=p)<<1|e>=c)&&(k=w[w.length-1],w[w.length-1]=w[w.length-1-d],w[w.length-1-d]=k)}else{var g=e-+this._x.call(null,h.data),C=t-+this._y.call(null,h.data),_=g*g+C*C;if(_<n){var I=Math.sqrt(n=_);r=e-I,s=t-I,f=e+I,m=t+I,o=h.data}}return o}function mn(e){if(isNaN(f=+this._x.call(null,e))||isNaN(m=+this._y.call(null,e)))return this;var t,n=this._root,o,r,s,i=this._x0,l=this._y0,u=this._x1,a=this._y1,f,m,w,h,k,d,c,p;if(!n)return this;if(n.length)for(;;){if((k=f>=(w=(i+u)/2))?i=w:u=w,(d=m>=(h=(l+a)/2))?l=h:a=h,t=n,!(n=n[c=d<<1|k]))return this;if(!n.length)break;(t[c+1&3]||t[c+2&3]||t[c+3&3])&&(o=t,p=c)}for(;n.data!==e;)if(r=n,!(n=n.next))return this;return(s=n.next)&&delete n.next,r?(s?r.next=s:delete r.next,this):t?(s?t[c]=s:delete t[c],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(o?o[p]=n:this._root=n),this):(this._root=s,this)}function yn(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function _n(){return this._root}function kn(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function xn(e){var t=[],n,o=this._root,r,s,i,l,u;for(o&&t.push(new U(o,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(o=n.node,s=n.x0,i=n.y0,l=n.x1,u=n.y1)&&o.length){var a=(s+l)/2,f=(i+u)/2;(r=o[3])&&t.push(new U(r,a,f,l,u)),(r=o[2])&&t.push(new U(r,s,f,a,u)),(r=o[1])&&t.push(new U(r,a,i,l,f)),(r=o[0])&&t.push(new U(r,s,i,a,f))}return this}function bn(e){var t=[],n=[],o;for(this._root&&t.push(new U(this._root,this._x0,this._y0,this._x1,this._y1));o=t.pop();){var r=o.node;if(r.length){var s,i=o.x0,l=o.y0,u=o.x1,a=o.y1,f=(i+u)/2,m=(l+a)/2;(s=r[0])&&t.push(new U(s,i,l,f,m)),(s=r[1])&&t.push(new U(s,f,l,u,m)),(s=r[2])&&t.push(new U(s,i,m,f,a)),(s=r[3])&&t.push(new U(s,f,m,u,a))}n.push(o)}for(;o=n.pop();)e(o.node,o.x0,o.y0,o.x1,o.y1);return this}function Nn(e){return e[0]}function Fn(e){return arguments.length?(this._x=e,this):this._x}function En(e){return e[1]}function jn(e){return arguments.length?(this._y=e,this):this._y}function Be(e,t,n){var o=new Te(t==null?Nn:t,n==null?En:n,NaN,NaN,NaN,NaN);return e==null?o:o.addAll(e)}function Te(e,t,n,o,r,s){this._x=e,this._y=t,this._x0=n,this._y0=o,this._x1=r,this._y1=s,this._root=void 0}function et(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var z=Be.prototype=Te.prototype;z.copy=function(){var e=new Te(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,o;if(!t)return e;if(!t.length)return e._root=et(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var r=0;r<4;++r)(o=t.source[r])&&(o.length?n.push({source:o,target:t.target[r]=new Array(4)}):t.target[r]=et(o));return e};z.add=dn;z.addAll=pn;z.cover=vn;z.data=hn;z.extent=gn;z.find=wn;z.remove=mn;z.removeAll=yn;z.root=_n;z.size=kn;z.visit=xn;z.visitAfter=bn;z.x=Fn;z.y=jn;function L(e){return function(){return e}}function Y(e){return(e()-.5)*1e-6}function In(e){return e.x+e.vx}function Cn(e){return e.y+e.vy}function pt(e){var t,n,o,r=1,s=1;typeof e!="function"&&(e=L(e==null?1:+e));function i(){for(var a,f=t.length,m,w,h,k,d,c,p=0;p<s;++p)for(m=Be(t,In,Cn).visitAfter(l),a=0;a<f;++a)w=t[a],d=n[w.index],c=d*d,h=w.x+w.vx,k=w.y+w.vy,m.visit(g);function g(C,_,I,x,V){var j=C.data,O=C.r,S=d+O;if(j){if(j.index>w.index){var W=h-j.x-j.vx,Q=k-j.y-j.vy,R=W*W+Q*Q;R<S*S&&(W===0&&(W=Y(o),R+=W*W),Q===0&&(Q=Y(o),R+=Q*Q),R=(S-(R=Math.sqrt(R)))/R*r,w.vx+=(W*=R)*(S=(O*=O)/(c+O)),w.vy+=(Q*=R)*S,j.vx-=W*(S=1-S),j.vy-=Q*S)}return}return _>h+S||x<h-S||I>k+S||V<k-S}}function l(a){if(a.data)return a.r=n[a.data.index];for(var f=a.r=0;f<4;++f)a[f]&&a[f].r>a.r&&(a.r=a[f].r)}function u(){if(!!t){var a,f=t.length,m;for(n=new Array(f),a=0;a<f;++a)m=t[a],n[m.index]=+e(m,a,t)}}return i.initialize=function(a,f){t=a,o=f,u()},i.iterations=function(a){return arguments.length?(s=+a,i):s},i.strength=function(a){return arguments.length?(r=+a,i):r},i.radius=function(a){return arguments.length?(e=typeof a=="function"?a:L(+a),u(),i):e},i}function An(e){return e.index}function tt(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function vt(e){var t=An,n=m,o,r=L(30),s,i,l,u,a,f=1;e==null&&(e=[]);function m(c){return 1/Math.min(l[c.source.index],l[c.target.index])}function w(c){for(var p=0,g=e.length;p<f;++p)for(var C=0,_,I,x,V,j,O,S;C<g;++C)_=e[C],I=_.source,x=_.target,V=x.x+x.vx-I.x-I.vx||Y(a),j=x.y+x.vy-I.y-I.vy||Y(a),O=Math.sqrt(V*V+j*j),O=(O-s[C])/O*c*o[C],V*=O,j*=O,x.vx-=V*(S=u[C]),x.vy-=j*S,I.vx+=V*(S=1-S),I.vy+=j*S}function h(){if(!!i){var c,p=i.length,g=e.length,C=new Map(i.map((I,x)=>[t(I,x,i),I])),_;for(c=0,l=new Array(p);c<g;++c)_=e[c],_.index=c,typeof _.source!="object"&&(_.source=tt(C,_.source)),typeof _.target!="object"&&(_.target=tt(C,_.target)),l[_.source.index]=(l[_.source.index]||0)+1,l[_.target.index]=(l[_.target.index]||0)+1;for(c=0,u=new Array(g);c<g;++c)_=e[c],u[c]=l[_.source.index]/(l[_.source.index]+l[_.target.index]);o=new Array(g),k(),s=new Array(g),d()}}function k(){if(!!i)for(var c=0,p=e.length;c<p;++c)o[c]=+n(e[c],c,e)}function d(){if(!!i)for(var c=0,p=e.length;c<p;++c)s[c]=+r(e[c],c,e)}return w.initialize=function(c,p){i=c,a=p,h()},w.links=function(c){return arguments.length?(e=c,h(),w):e},w.id=function(c){return arguments.length?(t=c,w):t},w.iterations=function(c){return arguments.length?(f=+c,w):f},w.strength=function(c){return arguments.length?(n=typeof c=="function"?c:L(+c),k(),w):n},w.distance=function(c){return arguments.length?(r=typeof c=="function"?c:L(+c),d(),w):r},w}var Vn={value:()=>{}};function ht(){for(var e=0,t=arguments.length,n={},o;e<t;++e){if(!(o=arguments[e]+"")||o in n||/[\s.]/.test(o))throw new Error("illegal type: "+o);n[o]=[]}return new ke(n)}function ke(e){this._=e}function Sn(e,t){return e.trim().split(/^|\s+/).map(function(n){var o="",r=n.indexOf(".");if(r>=0&&(o=n.slice(r+1),n=n.slice(0,r)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:o}})}ke.prototype=ht.prototype={constructor:ke,on:function(e,t){var n=this._,o=Sn(e+"",n),r,s=-1,i=o.length;if(arguments.length<2){for(;++s<i;)if((r=(e=o[s]).type)&&(r=On(n[r],e.name)))return r;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<i;)if(r=(e=o[s]).type)n[r]=nt(n[r],e.name,t);else if(t==null)for(r in n)n[r]=nt(n[r],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new ke(e)},call:function(e,t){if((r=arguments.length-2)>0)for(var n=new Array(r),o=0,r,s;o<r;++o)n[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],o=0,r=s.length;o<r;++o)s[o].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var o=this._[e],r=0,s=o.length;r<s;++r)o[r].value.apply(t,n)}};function On(e,t){for(var n=0,o=e.length,r;n<o;++n)if((r=e[n]).name===t)return r.value}function nt(e,t,n){for(var o=0,r=e.length;o<r;++o)if(e[o].name===t){e[o]=Vn,e=e.slice(0,o).concat(e.slice(o+1));break}return n!=null&&e.push({name:t,value:n}),e}var ue=0,de=0,ce=0,gt=1e3,be,pe,Ne=0,te=0,Fe=0,we=typeof performance=="object"&&performance.now?performance:Date,wt=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function mt(){return te||(wt(Bn),te=we.now()+Fe)}function Bn(){te=0}function Se(){this._call=this._time=this._next=null}Se.prototype=yt.prototype={constructor:Se,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?mt():+n)+(t==null?0:+t),!this._next&&pe!==this&&(pe?pe._next=this:be=this,pe=this),this._call=e,this._time=n,Oe()},stop:function(){this._call&&(this._call=null,this._time=1/0,Oe())}};function yt(e,t,n){var o=new Se;return o.restart(e,t,n),o}function Tn(){mt(),++ue;for(var e=be,t;e;)(t=te-e._time)>=0&&e._call.call(void 0,t),e=e._next;--ue}function ot(){te=(Ne=we.now())+Fe,ue=de=0;try{Tn()}finally{ue=0,Dn(),te=0}}function Mn(){var e=we.now(),t=e-Ne;t>gt&&(Fe-=t,Ne=e)}function Dn(){for(var e,t=be,n,o=1/0;t;)t._call?(o>t._time&&(o=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:be=n);pe=e,Oe(o)}function Oe(e){if(!ue){de&&(de=clearTimeout(de));var t=e-te;t>24?(e<1/0&&(de=setTimeout(ot,e-we.now()-Fe)),ce&&(ce=clearInterval(ce))):(ce||(Ne=we.now(),ce=setInterval(Mn,gt)),ue=1,wt(ot))}}const Pn=1664525,$n=1013904223,rt=4294967296;function Ln(){let e=1;return()=>(e=(Pn*e+$n)%rt)/rt}function Qn(e){return e.x}function Wn(e){return e.y}var Rn=10,Un=Math.PI*(3-Math.sqrt(5));function _t(e){var t,n=1,o=.001,r=1-Math.pow(o,1/300),s=0,i=.6,l=new Map,u=yt(m),a=ht("tick","end"),f=Ln();e==null&&(e=[]);function m(){w(),a.call("tick",t),n<o&&(u.stop(),a.call("end",t))}function w(d){var c,p=e.length,g;d===void 0&&(d=1);for(var C=0;C<d;++C)for(n+=(s-n)*r,l.forEach(function(_){_(n)}),c=0;c<p;++c)g=e[c],g.fx==null?g.x+=g.vx*=i:(g.x=g.fx,g.vx=0),g.fy==null?g.y+=g.vy*=i:(g.y=g.fy,g.vy=0);return t}function h(){for(var d=0,c=e.length,p;d<c;++d){if(p=e[d],p.index=d,p.fx!=null&&(p.x=p.fx),p.fy!=null&&(p.y=p.fy),isNaN(p.x)||isNaN(p.y)){var g=Rn*Math.sqrt(.5+d),C=d*Un;p.x=g*Math.cos(C),p.y=g*Math.sin(C)}(isNaN(p.vx)||isNaN(p.vy))&&(p.vx=p.vy=0)}}function k(d){return d.initialize&&d.initialize(e,f),d}return h(),t={tick:w,restart:function(){return u.restart(m),t},stop:function(){return u.stop(),t},nodes:function(d){return arguments.length?(e=d,h(),l.forEach(k),t):e},alpha:function(d){return arguments.length?(n=+d,t):n},alphaMin:function(d){return arguments.length?(o=+d,t):o},alphaDecay:function(d){return arguments.length?(r=+d,t):+r},alphaTarget:function(d){return arguments.length?(s=+d,t):s},velocityDecay:function(d){return arguments.length?(i=1-d,t):1-i},randomSource:function(d){return arguments.length?(f=d,l.forEach(k),t):f},force:function(d,c){return arguments.length>1?(c==null?l.delete(d):l.set(d,k(c)),t):l.get(d)},find:function(d,c,p){var g=0,C=e.length,_,I,x,V,j;for(p==null?p=1/0:p*=p,g=0;g<C;++g)V=e[g],_=d-V.x,I=c-V.y,x=_*_+I*I,x<p&&(j=V,p=x);return j},on:function(d,c){return arguments.length>1?(a.on(d,c),t):a.on(d)}}}function kt(){var e,t,n,o,r=L(-30),s,i=1,l=1/0,u=.81;function a(h){var k,d=e.length,c=Be(e,Qn,Wn).visitAfter(m);for(o=h,k=0;k<d;++k)t=e[k],c.visit(w)}function f(){if(!!e){var h,k=e.length,d;for(s=new Array(k),h=0;h<k;++h)d=e[h],s[d.index]=+r(d,h,e)}}function m(h){var k=0,d,c,p=0,g,C,_;if(h.length){for(g=C=_=0;_<4;++_)(d=h[_])&&(c=Math.abs(d.value))&&(k+=d.value,p+=c,g+=c*d.x,C+=c*d.y);h.x=g/p,h.y=C/p}else{d=h,d.x=d.data.x,d.y=d.data.y;do k+=s[d.data.index];while(d=d.next)}h.value=k}function w(h,k,d,c){if(!h.value)return!0;var p=h.x-t.x,g=h.y-t.y,C=c-k,_=p*p+g*g;if(C*C/u<_)return _<l&&(p===0&&(p=Y(n),_+=p*p),g===0&&(g=Y(n),_+=g*g),_<i&&(_=Math.sqrt(i*_)),t.vx+=p*h.value*o/_,t.vy+=g*h.value*o/_),!0;if(h.length||_>=l)return;(h.data!==t||h.next)&&(p===0&&(p=Y(n),_+=p*p),g===0&&(g=Y(n),_+=g*g),_<i&&(_=Math.sqrt(i*_)));do h.data!==t&&(C=s[h.data.index]*o/_,t.vx+=p*C,t.vy+=g*C);while(h=h.next)}return a.initialize=function(h,k){e=h,n=k,f()},a.strength=function(h){return arguments.length?(r=typeof h=="function"?h:L(+h),f(),a):r},a.distanceMin=function(h){return arguments.length?(i=h*h,a):Math.sqrt(i)},a.distanceMax=function(h){return arguments.length?(l=h*h,a):Math.sqrt(l)},a.theta=function(h){return arguments.length?(u=h*h,a):Math.sqrt(u)},a}function zn(e,t,n){var o,r=L(.1),s,i;typeof e!="function"&&(e=L(+e)),t==null&&(t=0),n==null&&(n=0);function l(a){for(var f=0,m=o.length;f<m;++f){var w=o[f],h=w.x-t||1e-6,k=w.y-n||1e-6,d=Math.sqrt(h*h+k*k),c=(i[f]-d)*s[f]*a/d;w.vx+=h*c,w.vy+=k*c}}function u(){if(!!o){var a,f=o.length;for(s=new Array(f),i=new Array(f),a=0;a<f;++a)i[a]=+e(o[a],a,o),s[a]=isNaN(i[a])?0:+r(o[a],a,o)}}return l.initialize=function(a){o=a,u()},l.strength=function(a){return arguments.length?(r=typeof a=="function"?a:L(+a),u(),l):r},l.radius=function(a){return arguments.length?(e=typeof a=="function"?a:L(+a),u(),l):e},l.x=function(a){return arguments.length?(t=+a,l):t},l.y=function(a){return arguments.length?(n=+a,l):n},l}function qn(e){var t=L(.1),n,o,r;typeof e!="function"&&(e=L(e==null?0:+e));function s(l){for(var u=0,a=n.length,f;u<a;++u)f=n[u],f.vx+=(r[u]-f.x)*o[u]*l}function i(){if(!!n){var l,u=n.length;for(o=new Array(u),r=new Array(u),l=0;l<u;++l)o[l]=isNaN(r[l]=+e(n[l],l,n))?0:+t(n[l],l,n)}}return s.initialize=function(l){n=l,i()},s.strength=function(l){return arguments.length?(t=typeof l=="function"?l:L(+l),i(),s):t},s.x=function(l){return arguments.length?(e=typeof l=="function"?l:L(+l),i(),s):e},s}function Jn(e){var t=L(.1),n,o,r;typeof e!="function"&&(e=L(e==null?0:+e));function s(l){for(var u=0,a=n.length,f;u<a;++u)f=n[u],f.vy+=(r[u]-f.y)*o[u]*l}function i(){if(!!n){var l,u=n.length;for(o=new Array(u),r=new Array(u),l=0;l<u;++l)o[l]=isNaN(r[l]=+e(n[l],l,n))?0:+t(n[l],l,n)}}return s.initialize=function(l){n=l,i()},s.strength=function(l){return arguments.length?(t=typeof l=="function"?l:L(+l),i(),s):t},s.y=function(l){return arguments.length?(e=typeof l=="function"?l:L(+l),i(),s):e},s}var Kn=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",forceCenter:ct,forceCollide:pt,forceLink:vt,forceManyBody:kt,forceRadial:zn,forceSimulation:_t,forceX:qn,forceY:Jn});class Hn{constructor(t={}){this.options=t}activate(t){const{layouts:n,nodes:o,edges:r,emitter:s,svgPanZoom:i}=t;let{nodeLayouts:l,nodeLayoutMap:u}=this.buildNodeLayouts(o.value,n,{x:0,y:0});const a=this.createSimulation(l,this.forceLayoutEdges(r.value));a.on("tick",()=>{var d,c;for(const p of l){const g=n==null?void 0:n[p.id];g&&(g.x=(d=p.x)!=null?d:0,g.y=(c=p.y)!=null?c:0)}});const f=()=>{a.alpha(.1).restart()},m=d=>{for(const[c,p]of Object.entries(d)){const g=u[c];g.fx=p.x,g.fy=p.y}f()},w=d=>{var c;for(const[p,g]of Object.entries(d)){const C=this.getNodeLayout(n,p),_=(c=u==null?void 0:u[p])!=null?c:{x:0,y:0};C.value.fixed||this.options.positionFixedByDrag?(_.fx=g.x,_.fy=g.y,C.value.fixed=!0):(_.x=g.x,_.y=g.y,delete _.fx,delete _.fy)}f()},h=({node:d,event:c})=>{if(this.options.positionFixedByClickWithAltKey&&c.altKey){const p=this.getNodeLayout(n,d);let g=u==null?void 0:u[d];g||(g={id:d,x:0,y:0},u[d]=g),p.value.fixed?(delete p.value.fixed,g.x=g.fx||g.x,g.y=g.fy||g.y,delete g.fx,delete g.fy):(p.value.fixed=!0,g.fx=g.x,g.fy=g.y),f()}},k=ee(()=>[Object.keys(o.value),r.value],()=>{const d=i.getViewArea();({nodeLayouts:l,nodeLayoutMap:u}=this.buildNodeLayouts(o.value,n,d.center)),a.nodes(l);const c=a.force("edge");c&&c.links(this.forceLayoutEdges(r.value)),f()},{deep:!0});s.on("node:dragstart",m),s.on("node:pointermove",m),s.on("node:dragend",w),s.on("node:click",h),this.onDeactivate=()=>{a.stop(),k(),s.off("node:dragstart",m),s.off("node:pointermove",m),s.off("node:dragend",w),s.off("node:click",h)}}deactivate(){this.onDeactivate&&this.onDeactivate()}createSimulation(t,n){if(this.options.createSimulation)return this.options.createSimulation(Kn,t,n);{const o=vt(n).id(r=>r.id);return _t(t).force("edge",o.distance(100)).force("charge",kt()).force("collide",pt(50).strength(.2)).force("center",ct().strength(.05)).alphaMin(.001)}}buildNodeLayouts(t,n,o){const r=Object.keys(t).filter(l=>!(l in n));for(const l of r)n[l]=Ce({},o);const s=this.forceNodeLayouts(n),i=Object.fromEntries(s.map(l=>[l.id,l]));return{nodeLayouts:s,nodeLayoutMap:i}}forceNodeLayouts(t){return Object.entries(t).map(([n,o])=>o.fixed?cn(Ce({id:n},o),{fx:o.x,fy:o.y}):Ce({id:n},o))}forceLayoutEdges(t){return Object.values(t).map(n=>({source:n.source,target:n.target}))}getNodeLayout(t,n){const o=Dt(t,n);return o.value||(o.value={x:0,y:0}),o}}const Gn=P(" No results "),Yn=oe({props:{modelValue:{type:Object,default:null}},emits:["update:modelValue"],setup(e,{emit:t}){const n=e,o=T({get(){return n.modelValue},set(u){t("update:modelValue",u)}}),r=D(""),s=me(),i=T(()=>s.state.Project.projects.filter(u=>u.title.indexOf(r.value)>=0||u.id.toString().indexOf(r.value)>=0)),l=(u,a,f)=>{const m=()=>r.value=u;i.value.length===0?s.dispatch("Project/fetchProjects").then(()=>a(m)):a(m)};return(u,a)=>(M(),$(N(ft),{modelValue:N(o),"onUpdate:modelValue":a[0]||(a[0]=f=>at(o)?o.value=f:null),label:"\u9879\u76EE\u5217\u8868","map-options":"","emit-value":"",behavior:"menu",options:N(i).map(f=>({label:f.title,value:f})),onFilter:l},{"no-option":F(()=>[b(G,null,{default:F(()=>[b(H,{class:"text-grey"},{default:F(()=>[Gn]),_:1})]),_:1})]),_:1},8,["modelValue","options"]))}});var Xn=ne(Yn,[["__file","/Users/boyan/development/opensource/gopherCronFE/src/components/SelectProject.vue"]]);const Zn=oe({props:{modelValue:{type:Object,default:null},projectId:{type:Number,required:!0},workflowId:{type:Number,required:!0},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,{emit:t}){const n=e,o=T({get(){return n.modelValue},set(u){t("update:modelValue",u)}}),r=D(""),s=me(),i=T(()=>{var u;return((u=s.state.WorkFlowTask.tasks.get(n.projectId))==null?void 0:u.filter(a=>(a.workflowId===0||a.workflowId===n.workflowId)&&(a.name.indexOf(r.value)>=0||a.id.indexOf(r.value)>=0)))||[]}),l=(u,a,f)=>{const m=()=>r.value=u;i.value.length===0?s.dispatch("WorkFlowTask/fetchTasks",{projectId:n.projectId}).then(()=>a(m)):a(m)};return ie(()=>{ee(()=>n.projectId,(u,a)=>{t("update:modelValue",void 0)})}),(u,a)=>(M(),$(N(ft),{modelValue:N(o),"onUpdate:modelValue":a[0]||(a[0]=f=>at(o)?o.value=f:null),label:"\u4EFB\u52A1\u5217\u8868","map-options":"","emit-value":"",behavior:"menu",disable:n.disabled,options:N(i).map(f=>({label:f.name,value:f})),onFilter:l},null,8,["modelValue","disable","options"]))}});var eo=ne(Zn,[["__file","/Users/boyan/development/opensource/gopherCronFE/src/components/SelectWorkFlowTask.vue"]]);function Ae(e){const t=Object.assign({},e);return t.deps&&(t.deps=Object.assign([],t.deps)),t}function to(e){const t=new Map,n=new Map;for(const l of e)if(t.set(l.id,l.deps||[]),l.deps)for(const u of l.deps){const a=n.get(u)||[];a.push(l.id),n.set(u,a)}let o=[];const r=new Map;t.forEach((l,u)=>{r.set(u,l.length),r.get(u)===0&&o.push(u)});const s=[];s.push(Object.assign([],o)),o=o.reverse();let i=[];for(;;){const l=o.pop();if(l===void 0){if(i.length===0)break;o=i.reverse(),s.push(Object.assign([],i)),i=[]}else{const u=n.get(l);if(!u)continue;for(const a of u){let f=r.get(a);f!==void 0&&(f--,r.set(a,f),f===0&&i.push(a))}}}return s}const no=ge("div",{class:"text-h6"},"\u6DFB\u52A0\u65B0\u7684\u4EFB\u52A1\u8282\u70B9",-1),oo=P("\u6DFB\u52A0"),ro=P("\u6DFB\u52A0"),ao=P("\u91CD\u7F6E\u89C6\u56FE"),lo=P("\u91CD\u7F6E"),so=oe({props:{workflowId:{type:Number,required:!0},tasks:{type:Object,required:!0},modelValue:{type:Object,default:new Array(0)}},emits:["update:modelValue"],setup(e,{expose:t,emit:n}){const o=e,r=D(!1),s=D(!1),i=D(),l=D(),u=D([]),a=D([]),f=y=>_[y].name||y,m=y=>y.join(" -> "),w=y=>y.map(v=>_[v].name).join(" -> "),h=y=>{const v=y.split(" -> ");if(v.length!==2)throw new Error(`Invalid edge name: ${y}`);return[v[0],v[1]]},k="#99F6e4",d=new Hn,c=y=>y?y.color:k,p=y=>y?y.color:k,g={view:{layoutHandler:d,scalingObjects:!1,fit:!1},node:{selectable:!0,label:{direction:Pt.NORTH,color:c},normal:{color:c},hover:{color:c},focusring:{color:k}},edge:{selectable:!0,normal:{color:p},hover:{color:p},selected:{color:p,width:4,dasharray:"10",linecap:"round",animate:!0,animationSpeed:10},marker:{source:{type:"none",width:4,height:4,margin:-1,units:"strokeWidth",color:null},target:{type:"arrow",width:4,height:4,margin:-1,units:"strokeWidth",color:null}}}},C=T(()=>{const y=()=>{var E;(E=l.value)==null||E.hide()};return{"view:load":()=>{},"view:contextmenu":E=>{const{event:A}=E;A.stopPropagation(),A.preventDefault();const B=l.value;B&&(y(),B.show(A))},"node:select":E=>{y()},"edge:select":E=>{y()}}}),_=He({}),I=y=>{var E;const v=(E=y.state)==null?void 0:E.currentStatus;return v==="done"?k:v==="running"?"green":v==="failed"?"red":v==="starting"?"white":"gray"},x=T(()=>{const y={};for(const v of o.modelValue)y[v.id]={id:v.id,name:v.name,color:I(v)};return y}),V=T(()=>{const y=new Map;for(const v of o.modelValue)y.set(v.id,v);return y});function j(y){for(const v of Object.keys(_))delete _[v];for(const v of Object.keys(y))_[v]=Object.assign({},y[v]);u.value=[]}const O=He({}),S=T(()=>{const y={};for(const v of o.modelValue)if(!!v.deps)for(const E of v.deps)y[m([E,v.id])]={source:E,target:v.id,color:I(v)};return y});function W(y){for(const v of Object.keys(O))delete O[v];for(const v of Object.keys(y))O[v]=Object.assign({},y[v]);a.value=[]}const Q=D({nodes:{}}),R=T(()=>{const y={},v=to(o.modelValue),E=50,A=50;let B=0;for(const Z of v){let fe=0;for(const At of Z)y[At]={x:fe*E+B*E/2,y:B*A,fixed:!1},fe++;B++}return{nodes:y}});function Me(y){const v=Q.value.nodes;for(const E of Object.keys(v))delete v[E];for(const E of Object.keys(y.nodes))v[E]=Object.assign({},y.nodes[E])}function De(){j(x.value),W(S.value),Me(R.value)}function xt(y,v){let E=0,A=!1;for(const B of y){if(B.id===v){y.splice(E,1),A=!0;break}E++}if(!A)throw new Error(`Can not remove node: ${v}`);for(const B of y)if(B.deps!==void 0){const Z=B.deps.indexOf(v,0);Z>-1&&(B.deps.splice(Z,1),B.deps.length===0&&delete B.deps)}}function Pe(y){const v=o.modelValue.map(Ae);y.forEach(E=>xt(v,E)),n("update:modelValue",v)}function Ee(y,v){const E=o.modelValue.map(Ae);for(const A of E)if(A.id===v){A.deps||(A.deps=[]),A.deps.push(y),Nt(),n("update:modelValue",E);return}throw new Error(`Can not add edge: ${m([y,v])}`)}function bt(y,v,E){for(const A of y)if(A.id===E&&A.deps!==void 0){const B=A.deps.indexOf(v,0);if(B>-1){A.deps.splice(B,1),A.deps.length===0&&delete A.deps;return}}throw new Error(`Can not remove edge: ${m([v,E])}`)}function $e(y){const v=o.modelValue.map(Ae);for(const E of y){const[A,B]=h(E);bt(v,A,B)}n("update:modelValue",v)}function Nt(){a.value.splice(0,a.value.length),u.value.splice(0,u.value.length)}function Le(){n("update:modelValue",o.tasks)}const Qe=(y,v)=>O[m([y,v])]===void 0&&O[m([v,y])]===void 0,Ft=T(()=>{const y=u.value;if(y.length===2){const[v,E]=y;return Qe(v,E)}return!1}),ye=D(!1),X=D(),K=D();function We(){ye.value=!0}function Re(){X.value=void 0,K.value=void 0,ye.value=!1}function Et(){var y,v,E;n("update:modelValue",[...o.modelValue,{name:(y=K.value)==null?void 0:y.name,id:`${(v=X.value)==null?void 0:v.id}_${(E=K.value)==null?void 0:E.id}`,origin:K.value}]),Re()}ie(()=>{ee(()=>o.tasks,(E,A)=>{r.value=!1,s.value=!1,v.value=void 0,Le()}),ee(()=>o.modelValue,E=>{j(x.value),W(S.value),JSON.stringify(E)===JSON.stringify(o.tasks)&&Me(R.value),r.value=!0});function y(E,A){try{for(const B of Object.keys(E)){const Z=E[B],fe=A[B];if(Math.abs(Z.x-fe.x)>.5||Math.abs(Z.y-fe.y)>.5)return!1}}catch{return!1}return!0}const v=D();ee(()=>[Q.value,i.value,r.value],([E,A,B])=>{!s.value&&A&&B&&y(E.nodes,v.value)&&setTimeout(()=>{Ve(()=>{A.panToCenter(),s.value=!0})},500),v.value=JSON.parse(JSON.stringify($t(Q.value.nodes)))},{deep:!0})});function jt(){Pe(u.value)}function It(){$e(a.value)}function Ct(){const[y]=u.value,v=xe(()=>{if(u.value.length!==1)return;const[E]=u.value;y===E||!Qe(y,E)||(Ee(y,E),v())})}return t({ShowAddNodeDialog:We,RemoveSelectedNodes:jt,SelectedNodes:u,RemoveSelectedEdges:It,SelectedEdges:a,ResetView:De,AddEdge:Ee,SetAddEdgeMode:Ct,NodeMapTask:V}),(y,v)=>{const E=Lt("v-network-graph");return M(),he(Wt,null,[r.value?(M(),$(E,{key:0,ref_key:"graph",ref:i,"selected-nodes":u.value,"onUpdate:selected-nodes":v[0]||(v[0]=A=>u.value=A),"selected-edges":a.value,"onUpdate:selected-edges":v[1]||(v[1]=A=>a.value=A),layouts:Q.value,"onUpdate:layouts":v[2]||(v[2]=A=>Q.value=A),class:Qt(s.value?"":"tw-opacity-0"),nodes:N(_),edges:N(O),configs:g,"zoom-level":.75,"event-handlers":N(C)},null,8,["selected-nodes","selected-edges","layouts","class","nodes","edges","zoom-level","event-handlers"])):J("v-if",!0),b(Yt,{modelValue:ye.value,"onUpdate:modelValue":v[5]||(v[5]=A=>ye.value=A),class:"tw-w-screen tw-h-screen",onHide:Re},{default:F(()=>[b(it,{class:"tw-w-96 q-pa-sm"},{default:F(()=>[b(se,null,{default:F(()=>[no]),_:1}),b(se,null,{default:F(()=>[b(Xn,{modelValue:X.value,"onUpdate:modelValue":v[3]||(v[3]=A=>X.value=A)},null,8,["modelValue"]),b(eo,{modelValue:K.value,"onUpdate:modelValue":v[4]||(v[4]=A=>K.value=A),disabled:X.value===void 0,"project-id":X.value?X.value.id:0,"workflow-id":o.workflowId},null,8,["modelValue","disabled","project-id","workflow-id"])]),_:1}),b(Xt,{align:"around"},{default:F(()=>[b(q,{class:"tw-w-full tw-mx-2 tw-my-3",color:K.value?"primary":"","text-color":K.value?"black":"white",disable:!K.value,onClick:Et},{default:F(()=>[oo]),_:1},8,["color","text-color","disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),b(N(en),{ref_key:"viewMenu",ref:l,"touch-position":"","context-menu":""},{default:F(()=>[b(Zt,{dense:""},{default:F(()=>[ae((M(),$(G,{key:"add-task",clickable:"",onClick:We},{default:F(()=>[b(H,null,{default:F(()=>[ro]),_:1})]),_:1})),[[le]]),N(Ft)?ae((M(),$(G,{key:"add-edge",clickable:"",onClick:v[6]||(v[6]=()=>Ee(u.value[0],u.value[1]))},{default:F(()=>[b(H,null,{default:F(()=>[P("\u6DFB\u52A0\u6307\u5411\uFF1A"+ve(w(u.value)),1)]),_:1})]),_:1})),[[le]]):J("v-if",!0),a.value.length>0?ae((M(),$(G,{key:"remove-edge",clickable:"",onClick:v[7]||(v[7]=()=>$e(a.value))},{default:F(()=>[b(H,null,{default:F(()=>[P(" \u5220\u9664\u6307\u5411\uFF1A"+ve(a.value.map(h).map(w).join(", ")),1)]),_:1})]),_:1})),[[le]]):J("v-if",!0),u.value.length>0?ae((M(),$(G,{key:"remove-task",clickable:"",onClick:v[8]||(v[8]=()=>Pe(u.value))},{default:F(()=>[b(H,null,{default:F(()=>[P(" \u5220\u9664\u8282\u70B9\uFF1A"+ve(u.value.map(f).join(", ")),1)]),_:1})]),_:1})),[[le]]):J("v-if",!0),b(ut),ae((M(),$(G,{key:"reset-view",clickable:"",onClick:De},{default:F(()=>[b(H,null,{default:F(()=>[ao]),_:1})]),_:1})),[[le]]),ae((M(),$(G,{key:"reset",clickable:"",onClick:Le},{default:F(()=>[b(H,null,{default:F(()=>[lo]),_:1})]),_:1})),[[le]])]),_:1})]),_:1},512)],64)}}});var io=ne(so,[["__file","/Users/boyan/development/opensource/gopherCronFE/src/components/WorkFlowGraph.vue"]]);const uo={class:"tw-w-full tw-h-full tw-flex tw-flex-col"},fo={class:"tw-flex tw-flex-row tw-gap-4 tw-flex-wrap tw-grow-0"},co=P(" \u8FD0\u884C "),po=P(" Kill "),vo=P(" \u4FDD\u5B58 "),ho=P(" \u5237\u65B0 "),go=P(" \u91CD\u7F6E\u89C6\u56FE "),wo=P(" \u6DFB\u52A0\u65B0\u4EFB\u52A1\u8282\u70B9 "),mo=P(" \u5173\u8054\u8282\u70B9 "),yo=P(" \u5220\u9664\u8282\u70B9\uFF08\u5173\u7CFB\uFF09 "),_o=P(" \u4EFB\u52A1\u8BE6\u60C5 "),ko=P(" \u4EFB\u52A1\u65E5\u5FD7 "),xo={class:"tw-grow tw-w-full tw-overflow-hidden"},bo=oe({props:{id:{type:Number,required:!0}},setup(e){const t=e,{width:n}=st(),o=T(()=>n.value<1024),r=D(),s=T(()=>r.value===void 0||r.value.SelectedNodes.length===0&&r.value.SelectedEdges.length===0),i=T(()=>{if(!r.value||r.value.SelectedNodes.length!==1)return;const I=r.value.SelectedNodes;return r.value.NodeMapTask.get(I[I.length-1])}),l=D([]),u=D([]),a=me(),f=D(!1),m=D(!1),w=D();async function h(){w.value=await zt(t.id)}const k=T(()=>w.value!==void 0&&w.value.state!==null&&w.value.state.status==="running");async function d(I){const x=new Map,V=new Map;for(const j of I){const S=a.state.Root.workflowTasks.find(Q=>Q.id===j.taskId);if(S===void 0)throw new Error(`workflowTasks missing projectId=${j.projectId} taskId=${j.taskId}`);const W=`${j.projectId}_${j.taskId}`;if(V.set(W,S),x.has(W)||x.set(W,[]),j.dependencyProjectId>0&&j.dependencyTaskId!==""){const Q=`${j.dependencyProjectId}_${j.dependencyTaskId}`,R=x.get(W);R!==void 0&&x.set(W,[...R,Q])}}return Array.from(x.keys()).map(j=>{const O=V.get(j);if(O===void 0)throw new Error(`keyMapTask missing ${j}`);return{name:O.name,id:j,deps:x.get(j),origin:O,state:a.state.Root.workflowTaskStates.find(S=>S.projectId===O.projectId&&S.taskId===O.id)}})}function c(I){const x=[],V=new Map;for(const j of I)V.set(j.id,j.origin);for(const j of I)if(j.deps!==void 0&&j.deps.length>0)for(const O of j.deps){const S=V.get(O);if(S===void 0)throw new Error("original task object missing");x.push({id:0,workflowId:0,createTime:0,projectId:j.origin.projectId,taskId:j.origin.id,dependencyProjectId:S.projectId,dependencyTaskId:S.id})}else x.push({id:0,workflowId:0,createTime:0,projectId:j.origin.projectId,taskId:j.origin.id,dependencyProjectId:0,dependencyTaskId:""});return x}async function p(I=!1){await a.dispatch("fetchWorkflowEdges",{workflowId:t.id});const x=await d(a.state.Root.workflowEdges);I?u.value=x:l.value=x}ie(()=>{h(),p(),ee(()=>t.id,async I=>{await h(),await p()}),a.watch(I=>[I.Root.eventWorkFlowTask,I.Root.eventWorkFlow],async([I,x])=>{(I===void 0||I.workFlowId!==t.id)&&(x===void 0||x.workFlowId!==t.id)||(await h(),await p(!0))})});const g=T(()=>{const I=x=>x.map(V=>Je(qe({},V),{origin:void 0,state:void 0}));return JSON.stringify(I(l.value))!==JSON.stringify(I(u.value))}),C=D(!1);async function _(){C.value=!0,await a.dispatch("updateWorkFlowEdges",{workflowId:t.id,edges:c(u.value)}),await p(),C.value=!1}return(I,x)=>(M(),he("div",uo,[b(Ge,{modelValue:f.value,"onUpdate:modelValue":x[0]||(x[0]=V=>f.value=V),content:"\u786E\u5B9A\u8981\u7ACB\u5373\u6267\u884C\u5417\uFF1F",onConfirm:x[1]||(x[1]=()=>N(Rt)(N(a).getters.apiv1,t.id).then(()=>{f.value=!1,p()}))},null,8,["modelValue"]),b(Ge,{modelValue:m.value,"onUpdate:modelValue":x[2]||(x[2]=V=>m.value=V),type:"warning",content:"\u786E\u5B9A\u8981\u505C\u6B62\u6267\u884C\u5417\uFF1F",onConfirm:x[3]||(x[3]=()=>N(Ut)(t.id).then(()=>{m.value=!1,p()}))},null,8,["modelValue"]),ge("div",fo,[N(k)?(M(),$(q,{key:1,dense:N(o),color:"red",onClick:x[5]||(x[5]=V=>m.value=!0)},{default:F(()=>[po]),_:1},8,["dense"])):(M(),$(q,{key:0,dense:N(o),color:"primary","text-color":"black",loading:N(k),onClick:x[4]||(x[4]=V=>f.value=!0)},{default:F(()=>[co]),_:1},8,["dense","loading"])),b(q,{dense:N(o),color:N(g)?"primary":"","text-color":N(g)?"black":"white",disable:!N(g),loading:C.value,onClick:_},{default:F(()=>[vo]),_:1},8,["dense","color","text-color","disable","loading"]),b(q,{dense:N(o),flat:"",icon:"refresh",title:"\u5237\u65B0",onClick:x[6]||(x[6]=()=>p())},{default:F(()=>[ho]),_:1},8,["dense"]),b(q,{dense:N(o),flat:"",icon:"restart_alt",title:"\u91CD\u7F6E\u89C6\u56FE",onClick:x[7]||(x[7]=()=>r.value.ResetView())},{default:F(()=>[go]),_:1},8,["dense"]),b(q,{dense:N(o),flat:"",icon:"add",title:"\u6DFB\u52A0\u65B0\u4EFB\u52A1\u8282\u70B9",onClick:x[8]||(x[8]=()=>r.value.ShowAddNodeDialog())},{default:F(()=>[wo]),_:1},8,["dense"]),N(i)!==void 0?(M(),$(q,{key:"create_relationship",dense:N(o),flat:"",icon:"north_east",title:"\u5173\u8054\u8282\u70B9",disable:!r.value||r.value.SelectedNodes.length!==1,onClick:x[9]||(x[9]=()=>{r.value.SetAddEdgeMode(),N(a).getters.$q.notify({type:"info",message:"\u8BF7\u9009\u62E9\u6709\u6548\u7684\u4E0B\u6E38\u8282\u70B9",icon:"tips_and_updates",position:"top-right"})})},{default:F(()=>[mo]),_:1},8,["dense","disable"])):J("v-if",!0),N(i)!==void 0?(M(),$(q,{key:"delete_task_or_relationship",dense:N(o),icon:"delete",disable:N(s),title:"\u5220\u9664\u5DF2\u9009\u7684\u8282\u70B9\u53CA\u8282\u70B9\u5173\u8054\u5173\u7CFB",flat:"",onClick:x[10]||(x[10]=()=>{r.value.SelectedNodes.length>0&&r.value.RemoveSelectedNodes(),r.value.SelectedEdges.length>0&&r.value.RemoveSelectedEdges()})},{default:F(()=>[yo]),_:1},8,["dense","disable"])):J("v-if",!0),N(i)!==void 0?(M(),$(q,{key:"jump_task_detail",dense:N(o),icon:"task_alt",flat:"",to:{name:"workflow_task",params:{projectId:N(i).origin.projectId,taskId:N(i).origin.id}}},{default:F(()=>[_o]),_:1},8,["dense","to"])):J("v-if",!0),N(i)!==void 0?(M(),$(q,{key:"jump_task_logs",dense:N(o),icon:"view_timeline",flat:"",to:{name:"workflow_task_logs",params:{projectId:N(i).origin.projectId,taskId:N(i).origin.id}}},{default:F(()=>[ko]),_:1},8,["dense","to"])):J("v-if",!0)]),ge("div",xo,[b(io,{ref_key:"workflow",ref:r,modelValue:u.value,"onUpdate:modelValue":x[11]||(x[11]=V=>u.value=V),"workflow-id":t.id,tasks:l.value},null,8,["modelValue","workflow-id","tasks"])])]))}});var No=ne(bo,[["__file","/Users/boyan/development/opensource/gopherCronFE/src/pages/WorkflowGraph.vue"]]);const Fo={key:0,class:"text-h6"},Eo={key:1,class:"text-h6"},jo=oe({props:{id:{type:Number,default:0}},setup(e){const t=e,n=T(()=>({id:0,title:"",cronExpr:"0 0 0 * * * *",remark:"",createTime:0,status:qt,state:null})),o=Jt(),r=me(),s=T(()=>r.state.WorkFlow.workflows.get(t.id)),i=D(Object.assign({},s.value||n.value));function l(){i.value=Object.assign({},s.value||n.value)}xe(()=>{i.value=Object.assign({},s.value||n.value)});async function u(){const k=i.value;f.value?(await Kt(r.getters.apiv1,k.title.trim(),k.remark.trim(),k.cronExpr.trim(),k.status),o.push({name:"workflows"})):(await Ht(r.getters.apiv1,i.value),await m())}const a=lt(),f=T(()=>a.name&&a.name.toString()==="create_workflow");async function m(){f.value||r.dispatch("WorkFlow/fetchWorkFlow",{id:t.id})}const w=T(()=>JSON.stringify(s.value)!==JSON.stringify(i.value)),h=T(()=>{const{title:k,cronExpr:d}=i.value;return k.trim()!==""&&d.trim()!==""});return ie(()=>{m(),ee(()=>t.id,async k=>{await m()})}),(k,d)=>(M(),$(on,{onSubmit:u,onReset:l},{default:F(()=>[b(se,null,{default:F(()=>[N(f)?(M(),he("div",Fo,"\u521B\u5EFA\u4EFB\u52A1\u7F16\u6392")):(M(),he("div",Eo,"\u4EFB\u52A1\u7F16\u6392\u8BE6\u60C5"))]),_:1}),b(se,null,{default:F(()=>[b(Ie,{modelValue:i.value.title,"onUpdate:modelValue":d[0]||(d[0]=c=>i.value.title=c),type:"text",label:"\u540D\u79F0",square:"",filled:"",class:"tw-mb-4"},null,8,["modelValue"]),b(Ie,{key:"cron",modelValue:i.value.cronExpr,"onUpdate:modelValue":d[1]||(d[1]=c=>i.value.cronExpr=c),label:"\u8C03\u5EA6\u8BA1\u5212 (*\u79D2 *\u5206 *\u65F6 *\u65E5 *\u6708 *\u5468 *\u5E74)",square:"",filled:"",class:"tw-mb-4"},null,8,["modelValue"]),b(Ie,{modelValue:i.value.remark,"onUpdate:modelValue":d[2]||(d[2]=c=>i.value.remark=c),type:"textarea",label:"\u5907\u6CE8",square:"",filled:""},null,8,["modelValue"]),b(Gt,{key:"status",modelValue:i.value.status,"onUpdate:modelValue":d[3]||(d[3]=c=>i.value.status=c),"false-value":2,"true-value":1,label:"\u662F\u5426\u542F\u7528",class:"tw-mb-4"},null,8,["modelValue"])]),_:1}),b(se,{align:"right",class:"tw-flex tw-gap-4 tw-flex-col-reverse lg:tw-flex-row lg:tw-justify-end"},{default:F(()=>[b(q,{type:"reset",flat:"",label:"\u91CD\u7F6E",class:"lg:tw-w-24 tw-w-full",disable:!N(w)},null,8,["disable"]),b(q,{color:"primary","text-color":"black",type:"submit",label:N(f)?"\u521B\u5EFA":"\u4FDD\u5B58",disable:!N(w)||!N(h),class:"lg:tw-w-24 tw-w-full"},null,8,["label","disable"])]),_:1})]),_:1}))}});var Io=ne(jo,[["__file","/Users/boyan/development/opensource/gopherCronFE/src/components/WorkFlowDetail.vue"]]);const Co=P("\u5F00\u59CB\u65F6\u95F4"),Ao=P("\u7ED3\u675F\u65F6\u95F4"),Vo=oe({props:{id:{type:Number,required:!0}},setup(e){const t=e,n=me(),o=T(()=>n.state.Root.workflowLogs),r=T(()=>n.state.Root.workflowLogsTotal),s=T(()=>n.state.Root.loadingWorkflowLogs),i=D({sortBy:"",descending:!1,page:1,rowsPerPage:5,rowsNumber:0}),l=D();ie(()=>{Ve(()=>{var f;(f=l.value)==null||f.$el.querySelector("table.q-table").classList.add("tw-table-fixed")})});const u=()=>{Ve(()=>{var m;const f=(m=l.value)==null?void 0:m.$el.querySelector(".scroll");f==null||f.scrollTo({top:0})})};function a({pagination:{page:f,rowsPerPage:m}}){const w=i.value;w.page=f,w.rowsPerPage=m,u()}return xe(()=>{const f=i.value;f.rowsNumber=r.value}),ie(async()=>{xe(async()=>{const f=i.value;await n.dispatch("fetchWorkFlowLogs",{workflowId:t.id,page:f.page,pageSize:f.rowsPerPage})})}),(f,m)=>(M(),$(N(nn),{ref_key:"table",ref:l,pagination:i.value,"onUpdate:pagination":m[0]||(m[0]=w=>i.value=w),class:"tw-w-full tw-h-full tw-bg-[#121212]","rows-per-page-options":[5,10,15],title:"\u6267\u884C\u65E5\u5FD7",rows:N(o),loading:N(s),"row-key":"id",color:"primary",flat:"","hide-header":"",onRequest:a},{loading:F(()=>[b(rn,{showing:"",color:"primary"})]),body:F(w=>[b(it,{class:"tw-my-4 tw-mx-4",flat:"",bordered:""},{default:F(()=>[b(G,null,{default:F(()=>[b(H,null,{default:F(()=>[b(_e,{overline:""},{default:F(()=>[Co]),_:1}),b(_e,null,{default:F(()=>[P(ve(N(Ye)(w.row.startTime*1e3)),1)]),_:2},1024)]),_:2},1024),b(H,null,{default:F(()=>[b(_e,{overline:""},{default:F(()=>[Ao]),_:1}),b(_e,null,{default:F(()=>[P(ve(N(Ye)(w.row.endTime*1e3)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),b(ut),b(se,{class:"tw-w-full tw-overflow-x-auto"},{default:F(()=>[b(tn,{json:w.row.result},null,8,["json"])]),_:2},1024)]),_:2},1024)]),_:1},8,["pagination","rows","loading"]))}});var So=ne(Vo,[["__file","/Users/boyan/development/opensource/gopherCronFE/src/components/WorkFlowLogs.vue"]]);const Oo={class:"lg:tw-px-4 lg:tw-pt-2 tw-w-full tw-h-full tw-flex tw-flex-col tw-box-border"},Bo={class:"tw-flex tw-h-full tw-w-full tw-overflow-hidden"},To={class:"tw-hidden lg:tw-block"},Mo=oe({props:{id:{type:Number,default:0}},setup(e){const t=e,{width:n}=st(),o=lt(),r=T(()=>o.name&&o.name.toString()==="create_workflow"),s=T(()=>{var i;if(r.value)return"detail";if(o.name){const l=o.name.toString();if(l==="workflow_logs")return"logs";if(l==="workflow_graph")return"graph";if(l==="workflow_detail")return"detail"}throw new Error(`Unknown route name ${(i=o.name)==null?void 0:i.toString()}`)});return(i,l)=>(M(),he("div",Oo,[N(r)?J("v-if",!0):(M(),$(Ke,{key:0,"model-value":N(s),"active-color":"primary",align:"left",class:"lg:tw-hidden tw-display"},{default:F(()=>[b(re,{name:"graph",label:"\u6D41\u7A0B",to:{name:"workflow_graph",params:{workflowId:t.id}},replace:""},null,8,["to"]),b(re,{name:"logs",label:"\u65E5\u5FD7",to:{name:"workflow_logs",params:{workflowId:t.id}},replace:""},null,8,["to"]),b(re,{name:"detail",label:"\u8BE6\u60C5",to:{name:"workflow_detail",params:{workflowId:t.id}},replace:""},null,8,["to"])]),_:1},8,["model-value"])),ge("div",Bo,[b(Mt,{"model-value":N(s),animated:"",vertical:N(n)>=1024,class:"tw-w-full tw-h-full tw-bg-[#121212] tw-p-0 lg:tw-pr-4 tw-box-border"},{default:F(()=>[b(je,{name:"graph"},{default:F(()=>[b(No,{id:t.id},null,8,["id"])]),_:1}),b(je,{name:"logs"},{default:F(()=>[b(So,{id:t.id},null,8,["id"])]),_:1}),b(je,{name:"detail"},{default:F(()=>[b(Io,{id:t.id},null,8,["id"])]),_:1})]),_:1},8,["model-value","vertical"]),ge("div",To,[N(r)?J("v-if",!0):(M(),$(Ke,{key:0,"model-value":N(s),"active-color":"primary",vertical:"","switch-indicator":"",align:"left"},{default:F(()=>[b(re,{name:"graph",label:"\u6D41\u7A0B",to:{name:"workflow_graph",params:{workflowId:t.id}},replace:""},null,8,["to"]),b(re,{name:"logs",label:"\u65E5\u5FD7",to:{name:"workflow_logs",params:{workflowId:t.id}},replace:""},null,8,["to"]),b(re,{name:"detail",label:"\u8BE6\u60C5",to:{name:"workflow_detail",params:{workflowId:t.id}},replace:""},null,8,["to"])]),_:1},8,["model-value"]))])])]))}});var lr=ne(Mo,[["__file","/Users/boyan/development/opensource/gopherCronFE/src/pages/WorkflowTabs.vue"]]);export{lr as default};
