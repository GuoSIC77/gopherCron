var Fa=Object.defineProperty,Ia=Object.defineProperties;var Ea=Object.getOwnPropertyDescriptors;var Nt=Object.getOwnPropertySymbols;var Va=Object.prototype.hasOwnProperty,qa=Object.prototype.propertyIsEnumerable;var Pt=(e,l,i)=>l in e?Fa(e,l,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[l]=i,B=(e,l)=>{for(var i in l||(l={}))Va.call(l,i)&&Pt(e,i,l[i]);if(Nt)for(var i of Nt(l))qa.call(l,i)&&Pt(e,i,l[i]);return e},je=(e,l)=>Ia(e,Ea(l));import{c as g,P as ta,d as Sa,a as St,r as Y,w as Ie,h as k,T as ze,b as aa,g as Tt,i as Ta,n as rt,Q as R,e as Ya,f as lt,v as Aa,p as Ha,j as Le,u as Ze,o as Ye,k as Ue,l as L,m as se,q as j,s as m,t as oe,x as ne,y as Dt,z as D,A as $a,C as Ba,R as Oa,B as Yt,D as At,E as De,F as te,G as la,H as ua,I as we,J as Ht,K as Qa,L as Ra,M as Na,N as Pa}from"./index.858abf03.js";import{u as za,Q as zt,a as wt,b as Ua,c as Ut}from"./QTabPanels.f701a35a.js";import{T as La,Q as Za}from"./QScrollArea.ce37051a.js";import{Q as _t,u as Ka}from"./QToggle.620acab6.js";import{Q as Wa}from"./QTooltip.5d526b09.js";import{Q as K}from"./QInput.39515e5e.js";import{Q as $t}from"./QForm.44afa5f8.js";import{_ as ut}from"./Confirm.200ef114.js";import{Q as Bt,a as st,b as xt}from"./QDialog.eb528cda.js";import{u as na,a as oa}from"./focus-manager.2ec597e1.js";import{u as ra,a as sa,b as ia}from"./use-key-composition.89abe8dc.js";import{p as O}from"./format.865294d5.js";import{Q as Ja}from"./QChip.48edc830.js";import{u as Xa,a as Ga}from"./QList.53c0d763.js";import{C as bt,Q as da}from"./ClosePopup.411262dd.js";import{a as el,f as nt}from"./datetime.6205e5a7.js";import{Q as tl}from"./QInnerLoading.f7395b79.js";import{Q as ca,a as ot,b as ke}from"./QItem.b0539e07.js";import{Q as ma}from"./QSeparator.d5e61ebf.js";import{_ as va,Q as al}from"./JSONViewer.22fd735d.js";import{G as ll}from"./log.598b2055.js";import{t as ul,b as nl}from"./thumbStyle.856de4cb.js";import"./uid.42677368.js";import"./touch.9357bf86.js";import"./use-prevent-scroll.a5760f87.js";import"./rtl.b51694b1.js";import"./QSelect.b4c9e565.js";const Ee=[-61,9,38,199,426,686,756,818,1111,1181,1210,1635,2060,2097,2192,2262,2324,2394,2456,3178];function ol(e,l,i){return Object.prototype.toString.call(e)==="[object Date]"&&(i=e.getDate(),l=e.getMonth()+1,e=e.getFullYear()),dl(Ot(e,l,i))}function Lt(e,l,i){return ha(il(e,l,i))}function rl(e){return sl(e)===0}function kt(e,l){return l<=6?31:l<=11||rl(e)?30:29}function sl(e){const l=Ee.length;let i=Ee[0],d,o,u,h,r;if(e<i||e>=Ee[l-1])throw new Error("Invalid Jalaali year "+e);for(r=1;r<l&&(d=Ee[r],o=d-i,!(e<d));r+=1)i=d;return h=e-i,o-h<6&&(h=h-o+Z(o+4,33)*33),u=he(he(h+1,33)-1,4),u===-1&&(u=4),u}function fa(e,l){const i=Ee.length,d=e+621;let o=-14,u=Ee[0],h,r,w,A,v;if(e<u||e>=Ee[i-1])throw new Error("Invalid Jalaali year "+e);for(v=1;v<i&&(h=Ee[v],r=h-u,!(e<h));v+=1)o=o+Z(r,33)*8+Z(he(r,33),4),u=h;A=e-u,o=o+Z(A,33)*8+Z(he(A,33)+3,4),he(r,33)===4&&r-A===4&&(o+=1);const f=Z(d,4)-Z((Z(d,100)+1)*3,4)-150,F=20+o-f;return l||(r-A<6&&(A=A-r+Z(r+4,33)*33),w=he(he(A+1,33)-1,4),w===-1&&(w=4)),{leap:w,gy:d,march:F}}function il(e,l,i){const d=fa(e,!0);return Ot(d.gy,3,d.march)+(l-1)*31-Z(l,7)*(l-7)+i-1}function dl(e){const l=ha(e).gy;let i=l-621,d,o,u;const h=fa(i,!1),r=Ot(l,3,h.march);if(u=e-r,u>=0){if(u<=185)return o=1+Z(u,31),d=he(u,31)+1,{jy:i,jm:o,jd:d};u-=186}else i-=1,u+=179,h.leap===1&&(u+=1);return o=7+Z(u,30),d=he(u,30)+1,{jy:i,jm:o,jd:d}}function Ot(e,l,i){let d=Z((e+Z(l-8,6)+100100)*1461,4)+Z(153*he(l+9,12)+2,5)+i-34840408;return d=d-Z(Z(e+100100+Z(l-8,6),100)*3,4)+752,d}function ha(e){let l=4*e+139361631;l=l+Z(Z(4*e+183187720,146097)*3,4)*4-3908;const i=Z(he(l,1461),4)*5+308,d=Z(he(i,153),5)+1,o=he(Z(i,153),12)+1;return{gy:Z(l,1461)-100100+Z(8-o,6),gm:o,gd:d}}function Z(e,l){return~~(e/l)}function he(e,l){return e-~~(e/l)*l}const cl=["gregorian","persian"],ga={modelValue:{required:!0},mask:{type:String},locale:Object,calendar:{type:String,validator:e=>cl.includes(e),default:"gregorian"},landscape:Boolean,color:String,textColor:String,square:Boolean,flat:Boolean,bordered:Boolean,readonly:Boolean,disable:Boolean},ya=["update:modelValue"];function xe(e){return e.year+"/"+O(e.month)+"/"+O(e.day)}function wa(e,l){const i=g(()=>e.disable!==!0&&e.readonly!==!0),d=g(()=>i.value===!0?0:-1),o=g(()=>{const r=[];return e.color!==void 0&&r.push(`bg-${e.color}`),e.textColor!==void 0&&r.push(`text-${e.textColor}`),r.join(" ")});function u(){return e.locale!==void 0?B(B({},l.lang.date),e.locale):l.lang.date}function h(r){const w=new Date,A=r===!0?null:0;if(e.calendar==="persian"){const v=ol(w);return{year:v.jy,month:v.jm,day:v.jd}}return{year:w.getFullYear(),month:w.getMonth()+1,day:w.getDate(),hour:A,minute:A,second:A,millisecond:A}}return{editable:i,tabindex:d,headerClass:o,getLocale:u,getCurrentDate:h}}const pa=864e5,ml=36e5,qt=6e4,ba="YYYY-MM-DDTHH:mm:ss.SSSZ",vl=/\[((?:[^\]\\]|\\]|\\)*)\]|d{1,4}|M{1,4}|m{1,2}|w{1,2}|Qo|Do|D{1,4}|YY(?:YY)?|H{1,2}|h{1,2}|s{1,2}|S{1,3}|Z{1,2}|a{1,2}|[AQExX]/g,fl=/(\[[^\]]*\])|d{1,4}|M{1,4}|m{1,2}|w{1,2}|Qo|Do|D{1,4}|YY(?:YY)?|H{1,2}|h{1,2}|s{1,2}|S{1,3}|Z{1,2}|a{1,2}|[AQExX]|([.*+:?^,\s${}()|\\]+)/g,Et={};function hl(e,l){const i="("+l.days.join("|")+")",d=e+i;if(Et[d]!==void 0)return Et[d];const o="("+l.daysShort.join("|")+")",u="("+l.months.join("|")+")",h="("+l.monthsShort.join("|")+")",r={};let w=0;const A=e.replace(fl,f=>{switch(w++,f){case"YY":return r.YY=w,"(-?\\d{1,2})";case"YYYY":return r.YYYY=w,"(-?\\d{1,4})";case"M":return r.M=w,"(\\d{1,2})";case"MM":return r.M=w,"(\\d{2})";case"MMM":return r.MMM=w,h;case"MMMM":return r.MMMM=w,u;case"D":return r.D=w,"(\\d{1,2})";case"Do":return r.D=w++,"(\\d{1,2}(st|nd|rd|th))";case"DD":return r.D=w,"(\\d{2})";case"H":return r.H=w,"(\\d{1,2})";case"HH":return r.H=w,"(\\d{2})";case"h":return r.h=w,"(\\d{1,2})";case"hh":return r.h=w,"(\\d{2})";case"m":return r.m=w,"(\\d{1,2})";case"mm":return r.m=w,"(\\d{2})";case"s":return r.s=w,"(\\d{1,2})";case"ss":return r.s=w,"(\\d{2})";case"S":return r.S=w,"(\\d{1})";case"SS":return r.S=w,"(\\d{2})";case"SSS":return r.S=w,"(\\d{3})";case"A":return r.A=w,"(AM|PM)";case"a":return r.a=w,"(am|pm)";case"aa":return r.aa=w,"(a\\.m\\.|p\\.m\\.)";case"ddd":return o;case"dddd":return i;case"Q":case"d":case"E":return"(\\d{1})";case"Qo":return"(1st|2nd|3rd|4th)";case"DDD":case"DDDD":return"(\\d{1,3})";case"w":return"(\\d{1,2})";case"ww":return"(\\d{2})";case"Z":return r.Z=w,"(Z|[+-]\\d{2}:\\d{2})";case"ZZ":return r.ZZ=w,"(Z|[+-]\\d{2}\\d{2})";case"X":return r.X=w,"(-?\\d+)";case"x":return r.x=w,"(-?\\d{4,})";default:return w--,f[0]==="["&&(f=f.substring(1,f.length-1)),f.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}}),v={map:r,regex:new RegExp("^"+A)};return Et[d]=v,v}function ka(e,l){return e!==void 0?e:l!==void 0?l.date:Sa.date}function Zt(e,l=""){const i=e>0?"-":"+",d=Math.abs(e),o=Math.floor(d/60),u=d%60;return i+O(o)+l+O(u)}function at(e,l,i,d,o){const u={year:null,month:null,day:null,hour:null,minute:null,second:null,millisecond:null,timezoneOffset:null,dateHash:null,timeHash:null};if(o!==void 0&&Object.assign(u,o),e==null||e===""||typeof e!="string")return u;l===void 0&&(l=ba);const h=ka(i,ta.props),r=h.months,w=h.monthsShort,{regex:A,map:v}=hl(l,h),f=e.match(A);if(f===null)return u;let F="";if(v.X!==void 0||v.x!==void 0){const N=parseInt(f[v.X!==void 0?v.X:v.x],10);if(isNaN(N)===!0||N<0)return u;const P=new Date(N*(v.X!==void 0?1e3:1));u.year=P.getFullYear(),u.month=P.getMonth()+1,u.day=P.getDate(),u.hour=P.getHours(),u.minute=P.getMinutes(),u.second=P.getSeconds(),u.millisecond=P.getMilliseconds()}else{if(v.YYYY!==void 0)u.year=parseInt(f[v.YYYY],10);else if(v.YY!==void 0){const N=parseInt(f[v.YY],10);u.year=N<0?N:2e3+N}if(v.M!==void 0){if(u.month=parseInt(f[v.M],10),u.month<1||u.month>12)return u}else v.MMM!==void 0?u.month=w.indexOf(f[v.MMM])+1:v.MMMM!==void 0&&(u.month=r.indexOf(f[v.MMMM])+1);if(v.D!==void 0){if(u.day=parseInt(f[v.D],10),u.year===null||u.month===null||u.day<1)return u;const N=d!=="persian"?new Date(u.year,u.month,0).getDate():kt(u.year,u.month);if(u.day>N)return u}v.H!==void 0?u.hour=parseInt(f[v.H],10)%24:v.h!==void 0&&(u.hour=parseInt(f[v.h],10)%12,(v.A&&f[v.A]==="PM"||v.a&&f[v.a]==="pm"||v.aa&&f[v.aa]==="p.m.")&&(u.hour+=12),u.hour=u.hour%24),v.m!==void 0&&(u.minute=parseInt(f[v.m],10)%60),v.s!==void 0&&(u.second=parseInt(f[v.s],10)%60),v.S!==void 0&&(u.millisecond=parseInt(f[v.S],10)*10**(3-f[v.S].length)),(v.Z!==void 0||v.ZZ!==void 0)&&(F=v.Z!==void 0?f[v.Z].replace(":",""):f[v.ZZ],u.timezoneOffset=(F[0]==="+"?-1:1)*(60*F.slice(1,3)+1*F.slice(3,5)))}return u.dateHash=O(u.year,6)+"/"+O(u.month)+"/"+O(u.day),u.timeHash=O(u.hour)+":"+O(u.minute)+":"+O(u.second)+F,u}function Kt(e){const l=new Date(e.getFullYear(),e.getMonth(),e.getDate());l.setDate(l.getDate()-(l.getDay()+6)%7+3);const i=new Date(l.getFullYear(),0,4);i.setDate(i.getDate()-(i.getDay()+6)%7+3);const d=l.getTimezoneOffset()-i.getTimezoneOffset();l.setHours(l.getHours()-d);const o=(l-i)/(pa*7);return 1+Math.floor(o)}function Me(e,l,i){const d=new Date(e),o=`set${i===!0?"UTC":""}`;switch(l){case"year":case"years":d[`${o}Month`](0);case"month":case"months":d[`${o}Date`](1);case"day":case"days":case"date":d[`${o}Hours`](0);case"hour":case"hours":d[`${o}Minutes`](0);case"minute":case"minutes":d[`${o}Seconds`](0);case"second":case"seconds":d[`${o}Milliseconds`](0)}return d}function pt(e,l,i){return(e.getTime()-e.getTimezoneOffset()*qt-(l.getTime()-l.getTimezoneOffset()*qt))/i}function Da(e,l,i="days"){const d=new Date(e),o=new Date(l);switch(i){case"years":case"year":return d.getFullYear()-o.getFullYear();case"months":case"month":return(d.getFullYear()-o.getFullYear())*12+d.getMonth()-o.getMonth();case"days":case"day":case"date":return pt(Me(d,"day"),Me(o,"day"),pa);case"hours":case"hour":return pt(Me(d,"hour"),Me(o,"hour"),ml);case"minutes":case"minute":return pt(Me(d,"minute"),Me(o,"minute"),qt);case"seconds":case"second":return pt(Me(d,"second"),Me(o,"second"),1e3)}}function Wt(e){return Da(e,Me(e,"year"),"days")+1}function Jt(e){if(e>=11&&e<=13)return`${e}th`;switch(e%10){case 1:return`${e}st`;case 2:return`${e}nd`;case 3:return`${e}rd`}return`${e}th`}const Xt={YY(e,l,i){const d=this.YYYY(e,l,i)%100;return d>=0?O(d):"-"+O(Math.abs(d))},YYYY(e,l,i){return i!=null?i:e.getFullYear()},M(e){return e.getMonth()+1},MM(e){return O(e.getMonth()+1)},MMM(e,l){return l.monthsShort[e.getMonth()]},MMMM(e,l){return l.months[e.getMonth()]},Q(e){return Math.ceil((e.getMonth()+1)/3)},Qo(e){return Jt(this.Q(e))},D(e){return e.getDate()},Do(e){return Jt(e.getDate())},DD(e){return O(e.getDate())},DDD(e){return Wt(e)},DDDD(e){return O(Wt(e),3)},d(e){return e.getDay()},dd(e,l){return this.dddd(e,l).slice(0,2)},ddd(e,l){return l.daysShort[e.getDay()]},dddd(e,l){return l.days[e.getDay()]},E(e){return e.getDay()||7},w(e){return Kt(e)},ww(e){return O(Kt(e))},H(e){return e.getHours()},HH(e){return O(e.getHours())},h(e){const l=e.getHours();return l===0?12:l>12?l%12:l},hh(e){return O(this.h(e))},m(e){return e.getMinutes()},mm(e){return O(e.getMinutes())},s(e){return e.getSeconds()},ss(e){return O(e.getSeconds())},S(e){return Math.floor(e.getMilliseconds()/100)},SS(e){return O(Math.floor(e.getMilliseconds()/10))},SSS(e){return O(e.getMilliseconds(),3)},A(e){return this.H(e)<12?"AM":"PM"},a(e){return this.H(e)<12?"am":"pm"},aa(e){return this.H(e)<12?"a.m.":"p.m."},Z(e,l,i,d){const o=d==null?e.getTimezoneOffset():d;return Zt(o,":")},ZZ(e,l,i,d){const o=d==null?e.getTimezoneOffset():d;return Zt(o)},X(e){return Math.floor(e.getTime()/1e3)},x(e){return e.getTime()}};function _a(e,l,i,d,o){if(e!==0&&!e||e===1/0||e===-1/0)return;const u=new Date(e);if(isNaN(u))return;l===void 0&&(l=ba);const h=ka(i,ta.props);return l.replace(vl,(r,w)=>r in Xt?Xt[r](u,h,d,o):w===void 0?r:w.split("\\]").join("]"))}const Te=20,gl=["Calendar","Years","Months"],Gt=e=>gl.includes(e),Vt=e=>/^-?[\d]+\/[0-1]\d$/.test(e),Pe=" \u2014 ";function Fe(e){return e.year+"/"+O(e.month)}var yl=St({name:"QDate",props:je(B(B(B({},ga),ra),na),{multiple:Boolean,range:Boolean,title:String,subtitle:String,mask:{default:"YYYY/MM/DD"},defaultYearMonth:{type:String,validator:Vt},yearsInMonthView:Boolean,events:[Array,Function],eventColor:[String,Function],emitImmediately:Boolean,options:[Array,Function],navigationMinYearMonth:{type:String,validator:Vt},navigationMaxYearMonth:{type:String,validator:Vt},noUnset:Boolean,firstDayOfWeek:[String,Number],todayBtn:Boolean,minimal:Boolean,defaultView:{type:String,default:"Calendar",validator:Gt}}),emits:[...ya,"rangeStart","rangeEnd","navigation"],setup(e,{slots:l,emit:i}){const{proxy:d}=Tt(),{$q:o}=d,u=oa(e,o),{getCache:h}=za(),{tabindex:r,headerClass:w,getLocale:A,getCurrentDate:v}=wa(e,o);let f;const F=sa(e),N=ia(F),P=Y(null),I=Y(gt()),E=Y(A()),ie=g(()=>gt()),ae=g(()=>A()),p=g(()=>v()),n=Y(c(I.value,E.value)),_=Y(e.defaultView),ye=o.lang.rtl===!0?"right":"left",pe=Y(ye.value),X=Y(ye.value),q=n.value.year,M=Y(q-q%Te-(q<0?Te:0)),z=Y(null),de=g(()=>{const t=e.landscape===!0?"landscape":"portrait";return`q-date q-date--${t} q-date--${t}-${e.minimal===!0?"minimal":"standard"}`+(u.value===!0?" q-date--dark q-dark":"")+(e.bordered===!0?" q-date--bordered":"")+(e.square===!0?" q-date--square no-border-radius":"")+(e.flat===!0?" q-date--flat no-shadow":"")+(e.disable===!0?" disabled":e.readonly===!0?" q-date--readonly":"")}),re=g(()=>e.color||"primary"),ce=g(()=>e.textColor||"white"),le=g(()=>e.emitImmediately===!0&&e.multiple!==!0&&e.range!==!0),ge=g(()=>Array.isArray(e.modelValue)===!0?e.modelValue:e.modelValue!==null&&e.modelValue!==void 0?[e.modelValue]:[]),G=g(()=>ge.value.filter(t=>typeof t=="string").map(t=>et(t,I.value,E.value)).filter(t=>t.dateHash!==null&&t.day!==null&&t.month!==null&&t.year!==null)),T=g(()=>{const t=a=>et(a,I.value,E.value);return ge.value.filter(a=>Ta(a)===!0&&a.from!==void 0&&a.to!==void 0).map(a=>({from:t(a.from),to:t(a.to)})).filter(a=>a.from.dateHash!==null&&a.to.dateHash!==null&&a.from.dateHash<a.to.dateHash)}),Ae=g(()=>e.calendar!=="persian"?t=>new Date(t.year,t.month-1,t.day):t=>{const a=Lt(t.year,t.month,t.day);return new Date(a.gy,a.gm-1,a.gd)}),Ke=g(()=>e.calendar==="persian"?xe:(t,a,s)=>_a(new Date(t.year,t.month-1,t.day,t.hour,t.minute,t.second,t.millisecond),a===void 0?I.value:a,s===void 0?E.value:s,t.year,t.timezoneOffset)),Ce=g(()=>G.value.length+T.value.reduce((t,a)=>t+1+Da(Ae.value(a.to),Ae.value(a.from)),0)),Ve=g(()=>{if(e.title!==void 0&&e.title!==null&&e.title.length!==0)return e.title;if(z.value!==null){const s=z.value.init,x=Ae.value(s);return E.value.daysShort[x.getDay()]+", "+E.value.monthsShort[s.month-1]+" "+s.day+Pe+"?"}if(Ce.value===0)return Pe;if(Ce.value>1)return`${Ce.value} ${E.value.pluralDay}`;const t=G.value[0],a=Ae.value(t);return isNaN(a.valueOf())===!0?Pe:E.value.headerTitle!==void 0?E.value.headerTitle(a,t):E.value.daysShort[a.getDay()]+", "+E.value.monthsShort[t.month-1]+" "+t.day}),it=g(()=>G.value.concat(T.value.map(a=>a.from)).sort((a,s)=>a.year-s.year||a.month-s.month)[0]),We=g(()=>G.value.concat(T.value.map(a=>a.to)).sort((a,s)=>s.year-a.year||s.month-a.month)[0]),dt=g(()=>{if(e.subtitle!==void 0&&e.subtitle!==null&&e.subtitle.length!==0)return e.subtitle;if(Ce.value===0)return Pe;if(Ce.value>1){const t=it.value,a=We.value,s=E.value.monthsShort;return s[t.month-1]+(t.year!==a.year?" "+t.year+Pe+s[a.month-1]+" ":t.month!==a.month?Pe+s[a.month-1]:"")+" "+a.year}return G.value[0].year}),He=g(()=>{const t=[o.iconSet.datetime.arrowLeft,o.iconSet.datetime.arrowRight];return o.lang.rtl===!0?t.reverse():t}),$e=g(()=>e.firstDayOfWeek!==void 0?Number(e.firstDayOfWeek):E.value.firstDayOfWeek),Je=g(()=>{const t=E.value.daysShort,a=$e.value;return a>0?t.slice(a,7).concat(t.slice(0,a)):t}),be=g(()=>{const t=n.value;return e.calendar!=="persian"?new Date(t.year,t.month,0).getDate():kt(t.year,t.month)}),ct=g(()=>typeof e.eventColor=="function"?e.eventColor:()=>e.eventColor),ee=g(()=>{if(e.navigationMinYearMonth===void 0)return null;const t=e.navigationMinYearMonth.split("/");return{year:parseInt(t[0],10),month:parseInt(t[1],10)}}),ue=g(()=>{if(e.navigationMaxYearMonth===void 0)return null;const t=e.navigationMaxYearMonth.split("/");return{year:parseInt(t[0],10),month:parseInt(t[1],10)}}),Xe=g(()=>{const t={month:{prev:!0,next:!0},year:{prev:!0,next:!0}};return ee.value!==null&&ee.value.year>=n.value.year&&(t.year.prev=!1,ee.value.year===n.value.year&&ee.value.month>=n.value.month&&(t.month.prev=!1)),ue.value!==null&&ue.value.year<=n.value.year&&(t.year.next=!1,ue.value.year===n.value.year&&ue.value.month<=n.value.month&&(t.month.next=!1)),t}),Be=g(()=>{const t={};return G.value.forEach(a=>{const s=Fe(a);t[s]===void 0&&(t[s]=[]),t[s].push(a.day)}),t}),mt=g(()=>{const t={};return T.value.forEach(a=>{const s=Fe(a.from),x=Fe(a.to);if(t[s]===void 0&&(t[s]=[]),t[s].push({from:a.from.day,to:s===x?a.to.day:void 0,range:a}),s<x){let b;const{year:Q,month:C}=a.from,S=C<12?{year:Q,month:C+1}:{year:Q+1,month:1};for(;(b=Fe(S))<=x;)t[b]===void 0&&(t[b]=[]),t[b].push({from:void 0,to:b===x?a.to.day:void 0,range:a}),S.month++,S.month>12&&(S.year++,S.month=1)}}),t}),qe=g(()=>{if(z.value===null)return;const{init:t,initHash:a,final:s,finalHash:x}=z.value,[b,Q]=a<=x?[t,s]:[s,t],C=Fe(b),S=Fe(Q);if(C!==me.value&&S!==me.value)return;const U={};return C===me.value?(U.from=b.day,U.includeFrom=!0):U.from=1,S===me.value?(U.to=Q.day,U.includeTo=!0):U.to=be.value,U}),me=g(()=>Fe(n.value)),Mt=g(()=>{const t={};if(e.options===void 0){for(let s=1;s<=be.value;s++)t[s]=!0;return t}const a=typeof e.options=="function"?e.options:s=>e.options.includes(s);for(let s=1;s<=be.value;s++){const x=me.value+"/"+O(s);t[s]=a(x)}return t}),Ct=g(()=>{const t={};if(e.events===void 0)for(let a=1;a<=be.value;a++)t[a]=!1;else{const a=typeof e.events=="function"?e.events:s=>e.events.includes(s);for(let s=1;s<=be.value;s++){const x=me.value+"/"+O(s);t[s]=a(x)===!0&&ct.value(x)}}return t}),Oe=g(()=>{let t,a;const{year:s,month:x}=n.value;if(e.calendar!=="persian")t=new Date(s,x-1,1),a=new Date(s,x-1,0).getDate();else{const b=Lt(s,x,1);t=new Date(b.gy,b.gm-1,b.gd);let Q=x-1,C=s;Q===0&&(Q=12,C--),a=kt(C,Q)}return{days:t.getDay()-$e.value-1,endDay:a}}),Se=g(()=>{const t=[],{days:a,endDay:s}=Oe.value,x=a<0?a+7:a;if(x<6)for(let C=s-x;C<=s;C++)t.push({i:C,fill:!0});const b=t.length;for(let C=1;C<=be.value;C++){const S={i:C,event:Ct.value[C],classes:[]};Mt.value[C]===!0&&(S.in=!0,S.flat=!0),t.push(S)}if(Be.value[me.value]!==void 0&&Be.value[me.value].forEach(C=>{const S=b+C-1;Object.assign(t[S],{selected:!0,unelevated:!0,flat:!1,color:re.value,textColor:ce.value})}),mt.value[me.value]!==void 0&&mt.value[me.value].forEach(C=>{if(C.from!==void 0){const S=b+C.from-1,U=b+(C.to||be.value)-1;for(let tt=S;tt<=U;tt++)Object.assign(t[tt],{range:C.range,unelevated:!0,color:re.value,textColor:ce.value});Object.assign(t[S],{rangeFrom:!0,flat:!1}),C.to!==void 0&&Object.assign(t[U],{rangeTo:!0,flat:!1})}else if(C.to!==void 0){const S=b+C.to-1;for(let U=b;U<=S;U++)Object.assign(t[U],{range:C.range,unelevated:!0,color:re.value,textColor:ce.value});Object.assign(t[S],{flat:!1,rangeTo:!0})}else{const S=b+be.value-1;for(let U=b;U<=S;U++)Object.assign(t[U],{range:C.range,unelevated:!0,color:re.value,textColor:ce.value})}}),qe.value!==void 0){const C=b+qe.value.from-1,S=b+qe.value.to-1;for(let U=C;U<=S;U++)t[U].color=re.value,t[U].editRange=!0;qe.value.includeFrom===!0&&(t[C].editRangeFrom=!0),qe.value.includeTo===!0&&(t[S].editRangeTo=!0)}n.value.year===p.value.year&&n.value.month===p.value.month&&(t[b+p.value.day-1].today=!0);const Q=t.length%7;if(Q>0){const C=7-Q;for(let S=1;S<=C;S++)t.push({i:S,fill:!0})}return t.forEach(C=>{let S="q-date__calendar-item ";C.fill===!0?S+="q-date__calendar-item--fill":(S+=`q-date__calendar-item--${C.in===!0?"in":"out"}`,C.range!==void 0&&(S+=` q-date__range${C.rangeTo===!0?"-to":C.rangeFrom===!0?"-from":""}`),C.editRange===!0&&(S+=` q-date__edit-range${C.editRangeFrom===!0?"-from":""}${C.editRangeTo===!0?"-to":""}`),(C.range!==void 0||C.editRange===!0)&&(S+=` text-${C.color}`)),C.classes=S}),t}),Qe=g(()=>e.disable===!0?{"aria-disabled":"true"}:e.readonly===!0?{"aria-readonly":"true"}:{});Ie(()=>e.modelValue,t=>{if(f===t)f=0;else{const a=c(I.value,E.value);ve(a.year,a.month,a)}}),Ie(_,()=>{P.value!==null&&d.$el.contains(document.activeElement)===!0&&P.value.focus()}),Ie(()=>n.value.year+"|"+n.value.month,()=>{i("navigation",{year:n.value.year,month:n.value.month})}),Ie(ie,t=>{Rt(t,E.value,"mask"),I.value=t}),Ie(ae,t=>{Rt(I.value,t,"locale"),E.value=t});function vt(){const t=p.value,a=Be.value[Fe(t)];(a===void 0||a.includes(t.day)===!1)&&jt(t),_e(t.year,t.month)}function ft(t){Gt(t)===!0&&(_.value=t)}function ht(t,a){["month","year"].includes(t)&&(t==="month"?V:H)(a===!0?-1:1)}function _e(t,a){_.value="Calendar",ve(t,a)}function Ge(t,a){if(e.range===!1||!t){z.value=null;return}const s=Object.assign(B({},n.value),t),x=a!==void 0?Object.assign(B({},n.value),a):s;z.value={init:s,initHash:xe(s),final:x,finalHash:xe(x)},_e(s.year,s.month)}function gt(){return e.calendar==="persian"?"YYYY/MM/DD":e.mask}function et(t,a,s){return at(t,a,s,e.calendar,{hour:0,minute:0,second:0,millisecond:0})}function c(t,a){const s=Array.isArray(e.modelValue)===!0?e.modelValue:e.modelValue?[e.modelValue]:[];if(s.length===0)return y();const x=s[s.length-1],b=et(x.from!==void 0?x.from:x,t,a);return b.dateHash===null?y():b}function y(){let t,a;if(e.defaultYearMonth!==void 0){const s=e.defaultYearMonth.split("/");t=parseInt(s[0],10),a=parseInt(s[1],10)}else{const s=p.value!==void 0?p.value:v();t=s.year,a=s.month}return{year:t,month:a,day:1,hour:0,minute:0,second:0,millisecond:0,dateHash:t+"/"+O(a)+"/01"}}function V(t){let a=n.value.year,s=Number(n.value.month)+t;s===13?(s=1,a++):s===0&&(s=12,a--),ve(a,s),le.value===!0&&Re("month")}function H(t){const a=Number(n.value.year)+t;ve(a,n.value.month),le.value===!0&&Re("year")}function W(t){ve(t,n.value.month),_.value=e.defaultView==="Years"?"Months":"Calendar",le.value===!0&&Re("year")}function fe(t){ve(n.value.year,t),_.value="Calendar",le.value===!0&&Re("month")}function $(t,a){const s=Be.value[a];(s!==void 0&&s.includes(t.day)===!0?Ft:jt)(t)}function J(t){return{year:t.year,month:t.month,day:t.day}}function ve(t,a,s){if(ee.value!==null&&t<=ee.value.year&&(t=ee.value.year,a<ee.value.month&&(a=ee.value.month)),ue.value!==null&&t>=ue.value.year&&(t=ue.value.year,a>ue.value.month&&(a=ue.value.month)),s!==void 0){const{hour:b,minute:Q,second:C,millisecond:S,timezoneOffset:U,timeHash:tt}=s;Object.assign(n.value,{hour:b,minute:Q,second:C,millisecond:S,timezoneOffset:U,timeHash:tt})}const x=t+"/"+O(a)+"/01";x!==n.value.dateHash&&(pe.value=n.value.dateHash<x==(o.lang.rtl!==!0)?"left":"right",t!==n.value.year&&(X.value=pe.value),rt(()=>{M.value=t-t%Te-(t<0?Te:0),Object.assign(n.value,{year:t,month:a,day:1,dateHash:x})}))}function yt(t,a,s){const x=t!==null&&t.length===1&&e.multiple===!1?t[0]:t;f=x;const{reason:b,details:Q}=Qt(a,s);i("update:modelValue",x,b,Q)}function Re(t){const a=G.value[0]!==void 0&&G.value[0].dateHash!==null?B({},G.value[0]):B({},n.value);rt(()=>{a.year=n.value.year,a.month=n.value.month;const s=e.calendar!=="persian"?new Date(a.year,a.month,0).getDate():kt(a.year,a.month);a.day=Math.min(Math.max(1,a.day),s);const x=Ne(a);f=x;const{details:b}=Qt("",a);i("update:modelValue",x,t,b)})}function Qt(t,a){return a.from!==void 0?{reason:`${t}-range`,details:je(B({},J(a.target)),{from:J(a.from),to:J(a.to)})}:{reason:`${t}-day`,details:J(a)}}function Ne(t,a,s){return t.from!==void 0?{from:Ke.value(t.from,a,s),to:Ke.value(t.to,a,s)}:Ke.value(t,a,s)}function jt(t){let a;if(e.multiple===!0)if(t.from!==void 0){const s=xe(t.from),x=xe(t.to),b=G.value.filter(C=>C.dateHash<s||C.dateHash>x),Q=T.value.filter(({from:C,to:S})=>S.dateHash<s||C.dateHash>x);a=b.concat(Q).concat(t).map(C=>Ne(C))}else{const s=ge.value.slice();s.push(Ne(t)),a=s}else a=Ne(t);yt(a,"add",t)}function Ft(t){if(e.noUnset===!0)return;let a=null;if(e.multiple===!0&&Array.isArray(e.modelValue)===!0){const s=Ne(t);t.from!==void 0?a=e.modelValue.filter(x=>x.from!==void 0?x.from!==s.from&&x.to!==s.to:!0):a=e.modelValue.filter(x=>x!==s),a.length===0&&(a=null)}yt(a,"remove",t)}function Rt(t,a,s){const x=G.value.concat(T.value).map(b=>Ne(b,t,a)).filter(b=>b.from!==void 0?b.from.dateHash!==null&&b.to.dateHash!==null:b.dateHash!==null);i("update:modelValue",(e.multiple===!0?x:x[0])||null,s)}function xa(){if(e.minimal!==!0)return k("div",{class:"q-date__header "+w.value},[k("div",{class:"relative-position"},[k(ze,{name:"q-transition--fade"},()=>k("div",B({key:"h-yr-"+dt.value,class:"q-date__header-subtitle q-date__header-link "+(_.value==="Years"?"q-date__header-link--active":"cursor-pointer"),tabindex:r.value},h("vY",{onClick(){_.value="Years"},onKeyup(t){t.keyCode===13&&(_.value="Years")}})),[dt.value]))]),k("div",{class:"q-date__header-title relative-position flex no-wrap"},[k("div",{class:"relative-position col"},[k(ze,{name:"q-transition--fade"},()=>k("div",B({key:"h-sub"+Ve.value,class:"q-date__header-title-label q-date__header-link "+(_.value==="Calendar"?"q-date__header-link--active":"cursor-pointer"),tabindex:r.value},h("vC",{onClick(){_.value="Calendar"},onKeyup(t){t.keyCode===13&&(_.value="Calendar")}})),[Ve.value]))]),e.todayBtn===!0?k(R,{class:"q-date__header-today self-start",icon:o.iconSet.datetime.today,flat:!0,size:"sm",round:!0,tabindex:r.value,onClick:vt}):null])])}function It({label:t,type:a,key:s,dir:x,goTo:b,boundaries:Q,cls:C}){return[k("div",{class:"row items-center q-date__arrow"},[k(R,B({round:!0,dense:!0,size:"sm",flat:!0,icon:He.value[0],tabindex:r.value,disable:Q.prev===!1},h("go-#"+a,{onClick(){b(-1)}})))]),k("div",{class:"relative-position overflow-hidden flex flex-center"+C},[k(ze,{name:"q-transition--jump-"+x},()=>k("div",{key:s},[k(R,B({flat:!0,dense:!0,noCaps:!0,label:t,tabindex:r.value},h("view#"+a,{onClick:()=>{_.value=a}})))]))]),k("div",{class:"row items-center q-date__arrow"},[k(R,B({round:!0,dense:!0,size:"sm",flat:!0,icon:He.value[1],tabindex:r.value,disable:Q.next===!1},h("go+#"+a,{onClick(){b(1)}})))])]}const Ma={Calendar:()=>[k("div",{key:"calendar-view",class:"q-date__view q-date__calendar"},[k("div",{class:"q-date__navigation row items-center no-wrap"},It({label:E.value.months[n.value.month-1],type:"Months",key:n.value.month,dir:pe.value,goTo:V,boundaries:Xe.value.month,cls:" col"}).concat(It({label:n.value.year,type:"Years",key:n.value.year,dir:X.value,goTo:H,boundaries:Xe.value.year,cls:""}))),k("div",{class:"q-date__calendar-weekdays row items-center no-wrap"},Je.value.map(t=>k("div",{class:"q-date__calendar-item"},[k("div",t)]))),k("div",{class:"q-date__calendar-days-container relative-position overflow-hidden"},[k(ze,{name:"q-transition--slide-"+pe.value},()=>k("div",{key:me.value,class:"q-date__calendar-days fit"},Se.value.map(t=>k("div",{class:t.classes},[t.in===!0?k(R,B({class:t.today===!0?"q-date__today":"",dense:!0,flat:t.flat,unelevated:t.unelevated,color:t.color,textColor:t.textColor,label:t.i,tabindex:r.value},h("day#"+t.i,{onClick:()=>{Ca(t.i)},onMouseover:()=>{ja(t.i)}})),t.event!==!1?()=>k("div",{class:"q-date__event bg-"+t.event}):null):k("div",""+t.i)]))))])])],Months(){const t=n.value.year===p.value.year,a=x=>ee.value!==null&&n.value.year===ee.value.year&&ee.value.month>x||ue.value!==null&&n.value.year===ue.value.year&&ue.value.month<x,s=E.value.monthsShort.map((x,b)=>{const Q=n.value.month===b+1;return k("div",{class:"q-date__months-item flex flex-center"},[k(R,B({class:t===!0&&p.value.month===b+1?"q-date__today":null,flat:Q!==!0,label:x,unelevated:Q,color:Q===!0?re.value:null,textColor:Q===!0?ce.value:null,tabindex:r.value,disable:a(b+1)},h("month#"+b,{onClick:()=>{fe(b+1)}})))])});return e.yearsInMonthView===!0&&s.unshift(k("div",{class:"row no-wrap full-width"},[It({label:n.value.year,type:"Years",key:n.value.year,dir:X.value,goTo:H,boundaries:Xe.value.year,cls:" col"})])),k("div",{key:"months-view",class:"q-date__view q-date__months flex flex-center"},s)},Years(){const t=M.value,a=t+Te,s=[],x=b=>ee.value!==null&&ee.value.year>b||ue.value!==null&&ue.value.year<b;for(let b=t;b<=a;b++){const Q=n.value.year===b;s.push(k("div",{class:"q-date__years-item flex flex-center"},[k(R,B({key:"yr"+b,class:p.value.year===b?"q-date__today":null,flat:!Q,label:b,dense:!0,unelevated:Q,color:Q===!0?re.value:null,textColor:Q===!0?ce.value:null,tabindex:r.value,disable:x(b)},h("yr#"+b,{onClick:()=>{W(b)}})))]))}return k("div",{class:"q-date__view q-date__years flex flex-center"},[k("div",{class:"col-auto"},[k(R,B({round:!0,dense:!0,flat:!0,icon:He.value[0],tabindex:r.value,disable:x(t)},h("y-",{onClick:()=>{M.value-=Te}})))]),k("div",{class:"q-date__years-content col self-stretch row items-center"},s),k("div",{class:"col-auto"},[k(R,B({round:!0,dense:!0,flat:!0,icon:He.value[1],tabindex:r.value,disable:x(a)},h("y+",{onClick:()=>{M.value+=Te}})))])])}};function Ca(t){const a=je(B({},n.value),{day:t});if(e.range===!1){$(a,me.value);return}if(z.value===null){const s=Se.value.find(b=>b.fill!==!0&&b.i===t);if(e.noUnset!==!0&&s.range!==void 0){Ft({target:a,from:s.range.from,to:s.range.to});return}if(s.selected===!0){Ft(a);return}const x=xe(a);z.value={init:a,initHash:x,final:a,finalHash:x},i("rangeStart",J(a))}else{const s=z.value.initHash,x=xe(a),b=s<=x?{from:z.value.init,to:a}:{from:a,to:z.value.init};z.value=null,jt(s===x?a:B({target:a},b)),i("rangeEnd",{from:J(b.from),to:J(b.to)})}}function ja(t){if(z.value!==null){const a=je(B({},n.value),{day:t});Object.assign(z.value,{final:a,finalHash:xe(a)})}}return Object.assign(d,{setToday:vt,setView:ft,offsetCalendar:ht,setCalendarTo:_e,setEditingRange:Ge}),()=>{const t=[k("div",{class:"q-date__content col relative-position"},[k(ze,{name:"q-transition--fade"},Ma[_.value])])],a=aa(l.default);return a!==void 0&&t.push(k("div",{class:"q-date__actions"},a)),e.name!==void 0&&e.disable!==!0&&N(t,"push"),k("div",B({class:de.value},Qe.value),[xa(),k("div",{ref:P,class:"q-date__main col column",tabindex:-1},t)])}}}),ea=St({name:"QPopupProxy",props:je(B({},Xa),{breakpoint:{type:[String,Number],default:450}}),emits:["show","hide"],setup(e,{slots:l,emit:i,attrs:d}){const{proxy:o}=Tt(),{$q:u}=o,h=Y(!1),r=Y(null),w=g(()=>parseInt(e.breakpoint,10)),{canShow:A}=Ga({showing:h});function v(){return u.screen.width<w.value||u.screen.height<w.value?"dialog":"menu"}const f=Y(v()),F=g(()=>f.value==="menu"?{maxHeight:"99vh"}:{});Ie(()=>v(),I=>{h.value!==!0&&(f.value=I)});function N(I){h.value=!0,i("show",I)}function P(I){h.value=!1,f.value=v(),i("hide",I)}return Object.assign(o,{show(I){A(I)===!0&&r.value.show(I)},hide(I){r.value.hide(I)},toggle(I){r.value.toggle(I)}}),Ya(o,"currentComponent",()=>({type:f.value,ref:r.value})),()=>{const I=je(B(B({ref:r},F.value),d),{onShow:N,onHide:P});let E;return f.value==="dialog"?E=Bt:(E=Ja,Object.assign(I,{target:e.target,contextMenu:e.contextMenu,noParentEvent:!0,separateClosePopup:!0})),k(E,I,l.default)}}});function wl(e,l){if(e.hour!==null){if(e.minute===null)return"minute";if(l===!0&&e.second===null)return"second"}return"hour"}function pl(){const e=new Date;return{hour:e.getHours(),minute:e.getMinutes(),second:e.getSeconds(),millisecond:e.getMilliseconds()}}var bl=St({name:"QTime",props:je(B(B(B({},na),ra),ga),{mask:{default:null},format24h:{type:Boolean,default:null},defaultDate:{type:String,validator:e=>/^-?[\d]+\/[0-1]\d\/[0-3]\d$/.test(e)},options:Function,hourOptions:Array,minuteOptions:Array,secondOptions:Array,withSeconds:Boolean,nowBtn:Boolean}),emits:ya,setup(e,{slots:l,emit:i}){const d=Tt(),{$q:o}=d.proxy,u=oa(e,o),{tabindex:h,headerClass:r,getLocale:w,getCurrentDate:A}=wa(e,o),v=sa(e),f=ia(v);let F,N;const P=Y(null),I=g(()=>dt()),E=g(()=>w()),ie=g(()=>He()),ae=at(e.modelValue,I.value,E.value,e.calendar,ie.value),p=Y(wl(ae)),n=Y(ae),_=Y(ae.hour===null||ae.hour<12),ye=g(()=>`q-time q-time--${e.landscape===!0?"landscape":"portrait"}`+(u.value===!0?" q-time--dark q-dark":"")+(e.disable===!0?" disabled":e.readonly===!0?" q-time--readonly":"")+(e.bordered===!0?" q-time--bordered":"")+(e.square===!0?" q-time--square no-border-radius":"")+(e.flat===!0?" q-time--flat no-shadow":"")),pe=g(()=>{const c=n.value;return{hour:c.hour===null?"--":X.value===!0?O(c.hour):String(_.value===!0?c.hour===0?12:c.hour:c.hour>12?c.hour-12:c.hour),minute:c.minute===null?"--":O(c.minute),second:c.second===null?"--":O(c.second)}}),X=g(()=>e.format24h!==null?e.format24h:o.lang.date.format24h),q=g(()=>{const c=p.value==="hour",y=c===!0?12:60,V=n.value[p.value];let W=`rotate(${Math.round(V*(360/y))-180}deg) translateX(-50%)`;return c===!0&&X.value===!0&&n.value.hour>=12&&(W+=" scale(.7)"),{transform:W}}),M=g(()=>n.value.hour!==null),z=g(()=>M.value===!0&&n.value.minute!==null),de=g(()=>e.hourOptions!==void 0?c=>e.hourOptions.includes(c):e.options!==void 0?c=>e.options(c,null,null):null),re=g(()=>e.minuteOptions!==void 0?c=>e.minuteOptions.includes(c):e.options!==void 0?c=>e.options(n.value.hour,c,null):null),ce=g(()=>e.secondOptions!==void 0?c=>e.secondOptions.includes(c):e.options!==void 0?c=>e.options(n.value.hour,n.value.minute,c):null),le=g(()=>{if(de.value===null)return null;const c=Ve(0,11,de.value),y=Ve(12,11,de.value);return{am:c,pm:y,values:c.values.concat(y.values)}}),ge=g(()=>re.value!==null?Ve(0,59,re.value):null),G=g(()=>ce.value!==null?Ve(0,59,ce.value):null),T=g(()=>{switch(p.value){case"hour":return le.value;case"minute":return ge.value;case"second":return G.value}}),Ae=g(()=>{let c,y,V=0,H=1;const W=T.value!==null?T.value.values:void 0;p.value==="hour"?X.value===!0?(c=0,y=23):(c=0,y=11,_.value===!1&&(V=12)):(c=0,y=55,H=5);const fe=[];for(let $=c,J=c;$<=y;$+=H,J++){const ve=$+V,yt=W!==void 0&&W.includes(ve)===!1,Re=p.value==="hour"&&$===0?X.value===!0?"00":"12":$;fe.push({val:ve,index:J,disable:yt,label:Re})}return fe}),Ke=g(()=>[[La,be,void 0,{stop:!0,prevent:!0,mouse:!0}]]);Ie(()=>e.modelValue,c=>{const y=at(c,I.value,E.value,e.calendar,ie.value);(y.dateHash!==n.value.dateHash||y.timeHash!==n.value.timeHash)&&(n.value=y,y.hour===null?p.value="hour":_.value=y.hour<12)}),Ie([I,E],()=>{rt(()=>{Ge()})});function Ce(){const c=B(B({},A()),pl());Ge(c),Object.assign(n.value,c),p.value="hour"}function Ve(c,y,V){const H=Array.apply(null,{length:y+1}).map((W,fe)=>{const $=fe+c;return{index:$,val:V($)===!0}}).filter(W=>W.val===!0).map(W=>W.index);return{min:H[0],max:H[H.length-1],values:H,threshold:y+1}}function it(c,y,V){const H=Math.abs(c-y);return Math.min(H,V-H)}function We(c,{min:y,max:V,values:H,threshold:W}){if(c===y)return y;if(c<y||c>V)return it(c,y,W)<=it(c,V,W)?y:V;const fe=H.findIndex(ve=>c<=ve),$=H[fe-1],J=H[fe];return c-$<=J-c?$:J}function dt(){return e.calendar!=="persian"&&e.mask!==null?e.mask:`HH:mm${e.withSeconds===!0?":ss":""}`}function He(){if(typeof e.defaultDate!="string"){const c=A(!0);return c.dateHash=xe(c),c}return at(e.defaultDate,"YYYY/MM/DD",void 0,e.calendar)}function $e(){return Aa(d)===!0||T.value!==null&&(T.value.values.length===0||p.value==="hour"&&X.value!==!0&&le.value[_.value===!0?"am":"pm"].values.length===0)}function Je(){const c=P.value,{top:y,left:V,width:H}=c.getBoundingClientRect(),W=H/2;return{top:y+W,left:V+W,dist:W*.7}}function be(c){if($e()!==!0){if(c.isFirst===!0){F=Je(),N=ee(c.evt,F);return}N=ee(c.evt,F,N),c.isFinal===!0&&(F=!1,N=null,ct())}}function ct(){p.value==="hour"?p.value="minute":e.withSeconds&&p.value==="minute"&&(p.value="second")}function ee(c,y,V){const H=Ha(c),W=Math.abs(H.top-y.top),fe=Math.sqrt(Math.pow(Math.abs(H.top-y.top),2)+Math.pow(Math.abs(H.left-y.left),2));let $,J=Math.asin(W/fe)*(180/Math.PI);if(H.top<y.top?J=y.left<H.left?90-J:270+J:J=y.left<H.left?J+90:270-J,p.value==="hour"){if($=J/30,le.value!==null){const ve=X.value!==!0?_.value===!0:le.value.am.values.length!==0&&le.value.pm.values.length!==0?fe>=y.dist:le.value.am.values.length!==0;$=We($+(ve===!0?0:12),le.value[ve===!0?"am":"pm"])}else $=Math.round($),X.value===!0?fe<y.dist?$<12&&($+=12):$===12&&($=0):_.value===!0&&$===12?$=0:_.value===!1&&$!==12&&($+=12);X.value===!0&&(_.value=$<12)}else $=Math.round(J/6)%60,p.value==="minute"&&ge.value!==null?$=We($,ge.value):p.value==="second"&&G.value!==null&&($=We($,G.value));return V!==$&&vt[p.value]($),$}const ue={hour(){p.value="hour"},minute(){p.value="minute"},second(){p.value="second"}};function Xe(c){c.keyCode===13&&ft()}function Be(c){c.keyCode===13&&ht()}function mt(c){$e()!==!0&&(o.platform.is.desktop!==!0&&ee(c,Je()),ct())}function qe(c){$e()!==!0&&ee(c,Je())}function me(c){if(c.keyCode===13)p.value="hour";else if([37,39].includes(c.keyCode)){const y=c.keyCode===37?-1:1;if(le.value!==null){const V=X.value===!0?le.value.values:le.value[_.value===!0?"am":"pm"].values;if(V.length===0)return;if(n.value.hour===null)Oe(V[0]);else{const H=(V.length+V.indexOf(n.value.hour)+y)%V.length;Oe(V[H])}}else{const V=X.value===!0?24:12,H=X.value!==!0&&_.value===!1?12:0,W=n.value.hour===null?-y:n.value.hour;Oe(H+(24+W+y)%V)}}}function Mt(c){if(c.keyCode===13)p.value="minute";else if([37,39].includes(c.keyCode)){const y=c.keyCode===37?-1:1;if(ge.value!==null){const V=ge.value.values;if(V.length===0)return;if(n.value.minute===null)Se(V[0]);else{const H=(V.length+V.indexOf(n.value.minute)+y)%V.length;Se(V[H])}}else{const V=n.value.minute===null?-y:n.value.minute;Se((60+V+y)%60)}}}function Ct(c){if(c.keyCode===13)p.value="second";else if([37,39].includes(c.keyCode)){const y=c.keyCode===37?-1:1;if(G.value!==null){const V=G.value.values;if(V.length===0)return;if(n.value.seconds===null)Qe(V[0]);else{const H=(V.length+V.indexOf(n.value.second)+y)%V.length;Qe(V[H])}}else{const V=n.value.second===null?-y:n.value.second;Qe((60+V+y)%60)}}}function Oe(c){n.value.hour!==c&&(n.value.hour=c,_e())}function Se(c){n.value.minute!==c&&(n.value.minute=c,_e())}function Qe(c){n.value.second!==c&&(n.value.second=c,_e())}const vt={hour:Oe,minute:Se,second:Qe};function ft(){_.value===!1&&(_.value=!0,n.value.hour!==null&&(n.value.hour-=12,_e()))}function ht(){_.value===!0&&(_.value=!1,n.value.hour!==null&&(n.value.hour+=12,_e()))}function _e(){if(de.value!==null&&de.value(n.value.hour)!==!0){n.value=at(),p.value="hour";return}if(re.value!==null&&re.value(n.value.minute)!==!0){n.value.minute=null,n.value.second=null,p.value="minute";return}if(e.withSeconds===!0&&ce.value!==null&&ce.value(n.value.second)!==!0){n.value.second=null,p.value="second";return}n.value.hour===null||n.value.minute===null||e.withSeconds===!0&&n.value.second===null||Ge()}function Ge(c){const y=Object.assign(B({},n.value),c),V=e.calendar==="persian"?O(y.hour)+":"+O(y.minute)+(e.withSeconds===!0?":"+O(y.second):""):_a(new Date(y.year,y.month===null?null:y.month-1,y.day,y.hour,y.minute,y.second,y.millisecond),I.value,E.value,y.year,y.timezoneOffset);y.changed=V!==e.modelValue,i("update:modelValue",V,y)}function gt(){const c=[k("div",{class:"q-time__link "+(p.value==="hour"?"q-time__link--active":"cursor-pointer"),tabindex:h.value,onClick:ue.hour,onKeyup:me},pe.value.hour),k("div",":"),k("div",M.value===!0?{class:"q-time__link "+(p.value==="minute"?"q-time__link--active":"cursor-pointer"),tabindex:h.value,onKeyup:Mt,onClick:ue.minute}:{class:"q-time__link"},pe.value.minute)];e.withSeconds===!0&&c.push(k("div",":"),k("div",z.value===!0?{class:"q-time__link "+(p.value==="second"?"q-time__link--active":"cursor-pointer"),tabindex:h.value,onKeyup:Ct,onClick:ue.second}:{class:"q-time__link"},pe.value.second));const y=[k("div",{class:"q-time__header-label row items-center no-wrap",dir:"ltr"},c)];return X.value===!1&&y.push(k("div",{class:"q-time__header-ampm column items-between no-wrap"},[k("div",{class:"q-time__link "+(_.value===!0?"q-time__link--active":"cursor-pointer"),tabindex:h.value,onClick:ft,onKeyup:Xe},"AM"),k("div",{class:"q-time__link "+(_.value!==!0?"q-time__link--active":"cursor-pointer"),tabindex:h.value,onClick:ht,onKeyup:Be},"PM")])),k("div",{class:"q-time__header flex flex-center no-wrap "+r.value},y)}function et(){const c=n.value[p.value];return k("div",{class:"q-time__content col relative-position"},[k(ze,{name:"q-transition--scale"},()=>k("div",{key:"clock"+p.value,class:"q-time__container-parent absolute-full"},[k("div",{ref:P,class:"q-time__container-child fit overflow-hidden"},[lt(k("div",{class:"q-time__clock cursor-pointer non-selectable",onClick:mt,onMousedown:qe},[k("div",{class:"q-time__clock-circle fit"},[k("div",{class:"q-time__clock-pointer"+(n.value[p.value]===null?" hidden":e.color!==void 0?` text-${e.color}`:""),style:q.value}),Ae.value.map(y=>k("div",{class:`q-time__clock-position row flex-center q-time__clock-pos-${y.index}`+(y.val===c?" q-time__clock-position--active "+r.value:y.disable===!0?" q-time__clock-position--disable":"")},[k("span",y.label)]))])]),Ke.value)])])),e.nowBtn===!0?k(R,{class:"q-time__now-button absolute",icon:o.iconSet.datetime.now,unelevated:!0,size:"sm",round:!0,color:e.color,textColor:e.textColor,tabindex:h.value,onClick:Ce}):null])}return d.proxy.setNow=Ce,()=>{const c=[et()],y=aa(l.default);return y!==void 0&&c.push(k("div",{class:"q-time__actions"},y)),e.name!==void 0&&e.disable!==!0&&f(c,"push"),k("div",{class:ye.value,tabindex:-1},[gt(),k("div",{class:"q-time__main col overflow-auto"},c)])}}});const kl=ne("div",{class:"text-h6"},"\u521B\u5EFA\u4EFB\u52A1",-1),Dl={class:"tw-flex tw-gap-2 tw-justify-end tw-mb-2"},_l={class:"row items-center justify-end"},xl={class:"row items-center justify-end"},Ml=Le({props:{modelValue:{type:Boolean,default:!1},task:{type:Object,default:()=>({})}},emits:["update:modelValue"],setup(e,{emit:l}){const i=e,d=g({get:()=>i.modelValue,set:v=>l("update:modelValue",v)}),o=Ze(),u=Y({taskId:i.task.id,projectId:i.task.projectId,command:i.task.command,remark:i.task.remark,noseize:i.task.noseize,scheduleTime:0,timeout:i.task.timeout}),h=Y("");function r(v){h.value=el(v*60,"YYYY-MM-DD HH:mm")}Ye(()=>{Ue(()=>{d.value||(u.value=Object.assign({},{taskId:i.task.id,projectId:i.task.projectId,command:i.task.command,remark:i.task.remark,noseize:i.task.noseize,scheduleTime:0,timeout:i.task.timeout}))})});const w=Y(!1);async function A(){const v=u.value;if(!v.remark){o.commit("error",{error:{message:"\u4EFB\u52A1\u8BF4\u660E\u5FC5\u586B"}});return}if(!v.command){o.commit("error",{error:{message:"\u6267\u884C\u547D\u4EE4\u5FC5\u586B"}});return}w.value=!0;try{const f=await Ba({projectId:v.projectId,taskId:v.taskId,command:v.command,noseize:v.noseize,scheduleTime:Date.parse(h.value)/1e3,remark:v.remark,timeout:v.timeout});f.code!==0?o.commit("error",{error:{message:f.message}}):(o.commit("success",{message:"\u521B\u5EFA\u6210\u529F"}),Oa.push({name:"temporary_tasks",params:{projectId:i.task.projectId}}))}catch{}w.value=!1}return(v,f)=>(L(),se(Bt,{modelValue:D(d),"onUpdate:modelValue":f[10]||(f[10]=F=>$a(d)?d.value=F:null),persistent:""},{default:j(()=>[m(xt,{class:"tw-w-96 q-pa-sm"},{default:j(()=>[m(st,null,{default:j(()=>[kl]),_:1}),m(st,{style:{"max-height":"50vh"},class:"scroll"},{default:j(()=>[e.task?(L(),se(K,{key:"id","model-value":e.task.id,disable:"",label:"\u5173\u8054\u4EFB\u52A1 ID",square:"",filled:"",class:"tw-mb-4"},null,8,["model-value"])):oe("",!0),m(K,{key:"remark",modelValue:u.value.remark,"onUpdate:modelValue":f[0]||(f[0]=F=>u.value.remark=F),type:"textarea",label:"\u4EFB\u52A1\u8BF4\u660E *",autogrow:"",square:"",filled:"",class:"tw-mb-4"},null,8,["modelValue"]),ne("div",Dl,[m(R,{dense:"",unelevated:"",class:"tw-text-xs tw-h-6",color:"warning","text-color":"black",label:"\u4E00\u5206\u949F\u540E",onClick:f[1]||(f[1]=F=>r(1))}),m(R,{dense:"",unelevated:"",class:"tw-text-xs tw-h-6",color:"warning","text-color":"black",label:"\u4E94\u5206\u949F\u540E",onClick:f[2]||(f[2]=F=>r(5))}),m(R,{dense:"",unelevated:"",class:"tw-text-xs tw-h-6",color:"warning","text-color":"black",label:"\u4E00\u5C0F\u65F6\u540E",onClick:f[3]||(f[3]=F=>r(60))})]),m(K,{modelValue:h.value,"onUpdate:modelValue":f[6]||(f[6]=F=>h.value=F),filled:"",square:"",label:"\u8C03\u5EA6\u65F6\u95F4 *",class:"tw-mb-4"},{prepend:j(()=>[m(Dt,{name:"event",class:"cursor-pointer"},{default:j(()=>[m(ea,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:j(()=>[m(yl,{modelValue:h.value,"onUpdate:modelValue":f[4]||(f[4]=F=>h.value=F),"text-color":"black",mask:"YYYY-MM-DD HH:mm"},{default:j(()=>[ne("div",_l,[lt(m(R,{label:"\u5173\u95ED",color:"primary",flat:""},null,512),[[bt]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),append:j(()=>[m(Dt,{name:"access_time",class:"cursor-pointer"},{default:j(()=>[m(ea,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:j(()=>[m(bl,{modelValue:h.value,"onUpdate:modelValue":f[5]||(f[5]=F=>h.value=F),mask:"YYYY-MM-DD HH:mm","text-color":"black",format24h:""},{default:j(()=>[ne("div",xl,[lt(m(R,{label:"\u5173\u95ED",color:"primary",flat:""},null,512),[[bt]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),m(K,{key:"timeout",modelValue:u.value.timeout,"onUpdate:modelValue":f[7]||(f[7]=F=>u.value.timeout=F),modelModifiers:{number:!0},type:"number",label:"\u8D85\u65F6\u65F6\u95F4 * (\u5355\u4F4D:\u79D2 s)",square:"",filled:"",class:"tw-mb-4"},null,8,["modelValue"]),m(K,{key:"command",modelValue:u.value.command,"onUpdate:modelValue":f[8]||(f[8]=F=>u.value.command=F),placeholder:'echo "hello word"',type:"textarea",label:"\u6267\u884C\u6307\u4EE4 *",autogrow:"",square:"",filled:"",class:"tw-mb-4"},null,8,["modelValue"]),m(_t,{key:"noseize",modelValue:u.value.noseize,"onUpdate:modelValue":f[9]||(f[9]=F=>u.value.noseize=F),"false-value":0,"true-value":1,label:"\u5E76\u884C\u8C03\u5EA6",class:"tw-mb-4"},null,8,["modelValue"])]),_:1}),m(da,{align:"right",class:"tw-flex tw-gap-2 tw-flex-col-reverse lg:tw-flex-row lg:tw-justify-end"},{default:j(()=>[lt(m(R,{flat:"",label:"\u53D6\u6D88",class:"lg:tw-w-24 tw-w-full"},null,512),[[bt]]),m(R,{color:"primary","text-color":"black",label:"\u521B\u5EFA",class:"lg:tw-w-24 tw-w-full",loading:w.value,onClick:A},null,8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Cl={class:"tw-h-full tw-w-full tw-flex tw-flex-col"},jl={key:0,class:"tw-flex tw-flex-row-reverse tw-pb-3 tw-flex-wrap tw-gap-2"},Fl=te("\u7ED3\u675F\u8FDB\u7A0B"),Il=te("\u7ACB\u5373\u6267\u884C"),El=te("\u4E34\u65F6\u8C03\u5EA6 "),Vl=te(" \u6307\u5B9A\u65F6\u95F4\u8C03\u5EA6\u4E00\u6B21\u7684\u4EFB\u52A1 "),ql={class:"q-pa-sm"},Sl=Le({props:{id:{type:String,default:""},projectId:{type:Number,required:!0}},setup(e){const l=e,i=g(()=>({id:"",name:"",projectId:l.projectId,command:"",cronExpr:"0 0 0 * * * *",remark:"",timeout:300,createTime:0,status:0,isRunning:-1,noseize:0,exclusion:0,clientIp:"",tmpId:""}));function d(q,M){return!q||!M?!1:q.name===M.name&&q.cronExpr===M.cronExpr&&q.remark===M.remark&&q.timeout===M.timeout&&q.status===M.status&&q.noseize===M.noseize&&q.command===M.command}const o=Ze(),u=g(()=>{var q;return(q=o.state.Task.tasks.get(l.projectId))==null?void 0:q.find(M=>M.id===l.id)}),h=g(()=>o.state.Project.projects.find(q=>q.id===l.projectId)),r=Y(Object.assign({},u.value||i.value));r.value.isRunning=-1,Ue(()=>{l.id!==r.value.id&&(r.value=Object.assign({},u.value||i.value),r.value.isRunning=-1)});const w=g(()=>{var q;return((q=u.value)==null?void 0:q.isRunning)===1?!1:!d(u.value,r.value)}),A=g(()=>{const{name:q,command:M,timeout:z,cronExpr:de}=r.value;return q!==""&&M!==""&&z>0&&de!==""}),v=g(()=>{const{name:q,command:M,timeout:z,cronExpr:de}=r.value;return q===""?"\u4EFB\u52A1\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A":M===""?"\u6267\u884C\u6307\u4EE4\u4E0D\u80FD\u4E3A\u7A7A":z<=0?"\u8D85\u65F6\u65F6\u95F4\u672A\u6307\u5B9A":de===""?"\u8C03\u5EA6\u8BA1\u5212\u672A\u6307\u5B9A":""}),f=Yt();async function F(){if(o.commit("cleanError"),!A.value){o.commit("error",{error:{message:v.value}});return}const q=await o.dispatch("saveTask",{task:r.value});if(ie.value){const M=l.projectId;await o.dispatch("Task/fetchTasks",{projectId:M}),f.push({name:"crontab_task",params:{projectId:M,taskId:q.id}})}}function N(){r.value=Object.assign({},u.value||i.value)}const P=Y(!1);async function I(q,M){if(o.commit("cleanError"),await o.dispatch("deleteTask",{projectId:q,taskId:M}),o.state.Root.currentError===void 0){const z=l.projectId;await o.dispatch("Task/fetchTasks",{projectId:z}),f.push({name:"crontab_tasks",params:{projectId:E.params.projectId}}),P.value=!1}}const E=At(),ie=g(()=>E.name&&E.name.toString()==="create_crontab_task"),ae=Y(!1),p=Y(!1);async function n(q,M){p.value=!1,ae.value=!0;try{await la(o.getters.apiv1,q,M)}catch{ae.value=!1}}Ye(()=>{o.watch(q=>[q.Root.eventTask],([q])=>{!q||q.projectId!==l.projectId||(q.status==="starting"?ae.value=!0:(o.dispatch("Task/fetchTasks",{projectId:l.projectId}),ae.value=!1))})});const _=Y(!1),ye=Y(!1),pe=async()=>{ye.value=!1,_.value=!0;try{await ua({projectId:l.projectId,taskId:l.id})}catch(q){console.error(q)}_.value=!1},X=Y(!1);return(q,M)=>{var z,de,re,ce,le,ge,G;return L(),De("div",Cl,[m(Ml,{modelValue:X.value,"onUpdate:modelValue":M[0]||(M[0]=T=>X.value=T),task:D(u)},null,8,["modelValue","task"]),m(ut,{modelValue:P.value,"onUpdate:modelValue":M[1]||(M[1]=T=>P.value=T),content:"\u662F\u5426\u8981\u5220\u9664\u4EFB\u52A1"+((z=D(u))==null?void 0:z.name)+"?",type:"warning",onConfirm:M[2]||(M[2]=T=>D(h)&&D(u)&&I(D(h).id,D(u).id))},null,8,["modelValue","content"]),m(ut,{modelValue:ye.value,"onUpdate:modelValue":M[3]||(M[3]=T=>ye.value=T),content:"\u786E\u5B9A\u8981\u7ED3\u675F\u8FDB\u7A0B\u5417\uFF1F",type:"warning",onConfirm:pe},null,8,["modelValue"]),m(ut,{modelValue:p.value,"onUpdate:modelValue":M[4]||(M[4]=T=>p.value=T),content:"\u786E\u5B9A\u8981\u7ACB\u5373\u6267\u884C\u5417\uFF1F",onConfirm:M[5]||(M[5]=T=>D(u)&&n(e.projectId,D(u).id))},null,8,["modelValue"]),D(ie)?oe("",!0):(L(),De("div",jl,[m(R,{flat:"",class:"tw-w-24 tw-text-red-300 lg:tw-hidden",icon:"delete",onClick:M[6]||(M[6]=T=>P.value=!0)}),((de=D(u))==null?void 0:de.isRunning)===1?(L(),se(R,{key:0,flat:"","text-color":"red",disable:((re=D(u))==null?void 0:re.isRunning)!==1,class:"tw-w-24 tw-ml-1",loading:_.value,onClick:M[7]||(M[7]=T=>ye.value=!0)},{default:j(()=>[Fl]),_:1},8,["disable","loading"])):oe("",!0),m(R,{color:"primary","text-color":"black",disable:D(w)||((ce=D(u))==null?void 0:ce.isRunning)===1,class:"tw-w-24",loading:ae.value||((le=D(u))==null?void 0:le.isRunning)===1,onClick:M[8]||(M[8]=T=>p.value=!0)},{default:j(()=>[Il]),_:1},8,["disable","loading"]),m(R,{color:"warning","text-color":"black",disable:D(w)||((ge=D(u))==null?void 0:ge.isRunning)===1,class:"tw-w-24 tw-opacity-90",loading:ae.value||((G=D(u))==null?void 0:G.isRunning)===1,onClick:M[9]||(M[9]=T=>X.value=!0)},{default:j(()=>[El,m(Wa,{class:"bg-warning tw-text-black",offset:[10,10]},{default:j(()=>[Vl]),_:1})]),_:1},8,["disable","loading"])])),m($t,{class:"tw-w-full",onSubmit:F,onReset:N},{default:j(()=>[D(u)?(L(),se(K,{key:"id","model-value":D(u).id,disable:"",label:"\u4EFB\u52A1 ID",square:"",filled:"",class:"tw-mb-4"},null,8,["model-value"])):oe("",!0),m(K,{key:"project","model-value":D(h)?D(h).title:"",disable:"",label:"\u6240\u5C5E\u9879\u76EE",square:"",filled:"",class:"tw-mb-4"},null,8,["model-value"]),m(K,{key:"name",modelValue:r.value.name,"onUpdate:modelValue":M[10]||(M[10]=T=>r.value.name=T),label:"\u4EFB\u52A1\u540D\u79F0",square:"",filled:"",class:"tw-mb-4"},null,8,["modelValue"]),m(K,{key:"cron",modelValue:r.value.cronExpr,"onUpdate:modelValue":M[11]||(M[11]=T=>r.value.cronExpr=T),label:"\u8C03\u5EA6\u8BA1\u5212 (*\u79D2 *\u5206 *\u65F6 *\u65E5 *\u6708 *\u5468 *\u5E74)",square:"",filled:"",class:"tw-mb-4"},null,8,["modelValue"]),m(K,{key:"timeout",modelValue:r.value.timeout,"onUpdate:modelValue":M[12]||(M[12]=T=>r.value.timeout=T),modelModifiers:{number:!0},type:"number",label:"\u8D85\u65F6\u65F6\u95F4 (\u5355\u4F4D:\u79D2 s)",square:"",filled:"",class:"tw-mb-4"},null,8,["modelValue"]),m(K,{key:"command",modelValue:r.value.command,"onUpdate:modelValue":M[13]||(M[13]=T=>r.value.command=T),placeholder:'echo "hello word"',type:"textarea",label:"\u6267\u884C\u6307\u4EE4",autogrow:"",square:"",filled:"",class:"tw-mb-4"},null,8,["modelValue"]),m(K,{key:"remark",modelValue:r.value.remark,"onUpdate:modelValue":M[14]||(M[14]=T=>r.value.remark=T),type:"textarea",label:"\u4EFB\u52A1\u5907\u6CE8",autogrow:"",square:"",filled:"",class:"tw-mb-4"},null,8,["modelValue"]),m(_t,{key:"noseize",modelValue:r.value.noseize,"onUpdate:modelValue":M[15]||(M[15]=T=>r.value.noseize=T),"false-value":0,"true-value":1,label:"\u5E76\u884C\u8C03\u5EA6",class:"tw-mb-4"},null,8,["modelValue"]),m(_t,{key:"status",modelValue:r.value.status,"onUpdate:modelValue":M[16]||(M[16]=T=>r.value.status=T),"false-value":0,"true-value":1,label:"\u662F\u5426\u542F\u7528",class:"tw-mb-4"},null,8,["modelValue"]),ne("div",ql,[m(R,{color:"primary","text-color":"black",type:"submit",label:"\u4FDD\u5B58",disable:!D(w),class:"lg:tw-w-24 tw-w-full lg:tw-mr-4 lg:tw-mb-0 tw-mb-4"},null,8,["disable"]),m(R,{color:"primary",type:"reset",label:"\u91CD\u7F6E",flat:"",disable:!D(w),class:"lg:tw-w-24 tw-w-full"},null,8,["disable"])])]),_:1})])}}}),Tl=te("\u8282\u70B9 IP"),Yl=te("\u5F00\u59CB\u65F6\u95F4"),Al=te("\u7ED3\u675F\u65F6\u95F4"),Hl=Le({props:{id:{type:String,required:!0},projectId:{type:Number,required:!0}},emits:["onpage"],setup(e,{emit:l}){const i=e,d=Ze(),o=g(()=>d.state.Root.taskLogs),u=g(()=>d.state.Root.taskLogsTotal),h=g(()=>d.state.Root.loadingTaskLogs),r=Y({sortBy:"",descending:!1,page:1,rowsPerPage:5,rowsNumber:0}),w=Y();Ye(()=>{rt(()=>{var v;(v=w.value)==null||v.$el.querySelector("table.q-table").classList.add("tw-table-fixed")})});function A({pagination:{page:v,rowsPerPage:f}}){const F=r.value;F.page=v,F.rowsPerPage=f,l("onpage")}return Ue(()=>{const v=r.value;v.rowsNumber=u.value}),Ye(async()=>{Ue(async()=>{const v=r.value;await d.dispatch("fetchTaskLogs",{projectId:i.projectId,taskId:i.id,page:v.page,pageSize:v.rowsPerPage})})}),(v,f)=>(L(),se(D(al),{ref_key:"logTable",ref:w,pagination:r.value,"onUpdate:pagination":f[0]||(f[0]=F=>r.value=F),class:"tw-w-full tw-h-full tw-bg-[#121212]","rows-per-page-options":[5,10,15],rows:D(o),loading:D(h),"row-key":"id",color:"primary",flat:"","hide-header":"",onRequest:A},{loading:j(()=>[m(tl,{showing:"",color:"primary"})]),body:j(F=>[m(xt,{class:"tw-my-4 tw-x-full",flat:"",bordered:""},{default:j(()=>[m(ca,null,{default:j(()=>[m(ot,null,{default:j(()=>[m(ke,{overline:""},{default:j(()=>[Tl]),_:1}),m(ke,null,{default:j(()=>[te(we(F.row.clientIp),1)]),_:2},1024)]),_:2},1024),m(ot,null,{default:j(()=>[m(ke,{overline:""},{default:j(()=>[Yl]),_:1}),m(ke,null,{default:j(()=>[te(we(D(nt)(F.row.startTime*1e3)),1)]),_:2},1024)]),_:2},1024),m(ot,null,{default:j(()=>[m(ke,{overline:""},{default:j(()=>[Al]),_:1}),m(ke,null,{default:j(()=>[te(we(D(nt)(F.row.endTime*1e3)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),m(ma),m(st,{class:"tw-w-full tw-overflow-x-auto"},{default:j(()=>[m(va,{json:F.row.result},null,8,["json"])]),_:2},1024)]),_:2},1024)]),_:1},8,["pagination","rows","loading"]))}}),$l=te("\u5F00\u59CB\u65F6\u95F4"),Bl=te("\u7ED3\u675F\u65F6\u95F4"),Ol={class:"tw-flex tw-flex-row-reverse tw-pb-3 tw-flex-wrap tw-gap-1"},Ql=te("\u5220\u9664\u4EFB\u52A1"),Rl=te("\u7ED3\u675F\u8FDB\u7A0B"),Nl=Le({props:{id:{type:Number,default:0,required:!0},projectId:{type:Number,required:!0}},setup(e){const l=e,i=Y(),d=Ze(),o=g(()=>{var I;return(I=d.state.Task.temporaryTasks.get(l.projectId))==null?void 0:I.find(E=>E.id===Number(l.id))}),u=g(()=>d.state.Project.projects.find(I=>I.id===l.projectId)),h=Y(Object.assign({},o.value));Ue(()=>{h.value=Object.assign({},o.value),P()}),Ye(()=>{d.watch(I=>[I.Root.eventTask],([I])=>{!I||I.projectId!==l.projectId||d.dispatch("Task/fetchTemporaryTasks",{projectId:l.projectId})}),P()});const r=Y(!1),w=Y(!1),A=async()=>{if(!!o.value){w.value=!1,r.value=!0;try{await ua({projectId:l.projectId,taskId:o.value.taskId})}catch(I){console.log(I)}r.value=!1}},v=Y(!1),f=Y(!1),F=Yt(),N=async()=>{f.value=!1,v.value=!0;try{await Qa(Number(l.id)),await d.dispatch("Task/fetchTemporaryTasks",{projectId:l.projectId}),F.back()}catch(I){console.log(I)}v.value=!1};async function P(){if(!!o.value){i.value=null;try{i.value=await ll({taskId:o.value.taskId,projectId:o.value.projectId,tmpId:o.value.tmpId})}catch{}}}return(I,E)=>{var ie,ae,p,n;return L(),De(Ht,null,[m(ut,{modelValue:w.value,"onUpdate:modelValue":E[0]||(E[0]=_=>w.value=_),content:"\u786E\u5B9A\u8981\u7ED3\u675F\u8FDB\u7A0B\u5417\uFF1F",type:"warning",onConfirm:A},null,8,["modelValue"]),m(ut,{modelValue:f.value,"onUpdate:modelValue":E[1]||(E[1]=_=>f.value=_),content:"\u786E\u5B9A\u8981\u5220\u9664\u8BE5\u4E34\u65F6\u4EFB\u52A1\u5417\uFF1F",type:"warning",onConfirm:N},null,8,["modelValue"]),i.value?(L(),se(xt,{key:0,class:"tw-mb-4",flat:"",bordered:""},{default:j(()=>[m(ca,null,{default:j(()=>[m(ot,null,{default:j(()=>[m(ke,{overline:""},{default:j(()=>[$l]),_:1}),m(ke,null,{default:j(()=>[te(we(D(nt)(i.value.startTime*1e3)),1)]),_:1})]),_:1}),m(ot,null,{default:j(()=>[m(ke,{overline:""},{default:j(()=>[Bl]),_:1}),m(ke,null,{default:j(()=>[te(we(D(nt)(i.value.endTime*1e3)),1)]),_:1})]),_:1})]),_:1}),m(ma),m(st,{class:"tw-w-full tw-overflow-x-auto"},{default:j(()=>[m(va,{json:i.value.result},null,8,["json"])]),_:1})]),_:1})):oe("",!0),ne("div",Ol,[((ie=D(o))==null?void 0:ie.isRunning)!==1&&!((ae=i.value)!=null&&ae.result)?(L(),se(R,{key:0,"text-color":"red",outline:"",class:"tw-w-24 tw-ml-1",loading:v.value,onClick:E[2]||(E[2]=_=>f.value=!0)},{default:j(()=>[Ql]),_:1},8,["loading"])):oe("",!0),((p=D(o))==null?void 0:p.isRunning)===1?(L(),se(R,{key:1,outline:"","text-color":"red",disable:((n=D(o))==null?void 0:n.isRunning)!==1,class:"tw-w-24 tw-ml-1",loading:r.value,onClick:E[3]||(E[3]=_=>w.value=!0)},{default:j(()=>[Rl]),_:1},8,["disable","loading"])):oe("",!0)]),m($t,{class:"tw-w-full"},{default:j(()=>[D(o)?(L(),se(K,{key:"id","model-value":D(o).taskId+" - "+D(o).tmpId,disable:"",label:"\u4EFB\u52A1 ID",square:"",filled:"",class:"tw-mb-4"},null,8,["model-value"])):oe("",!0),m(K,{key:"project","model-value":D(u)?D(u).title:"",disable:"",label:"\u6240\u5C5E\u9879\u76EE",square:"",filled:"",class:"tw-mb-4"},null,8,["model-value"]),m(K,{key:"remark",modelValue:h.value.remark,"onUpdate:modelValue":E[4]||(E[4]=_=>h.value.remark=_),type:"textarea",label:"\u4EFB\u52A1\u5907\u6CE8",autogrow:"",disable:"",square:"",filled:"",class:"tw-mb-4"},null,8,["modelValue"]),m(K,{key:"cron","model-value":D(nt)(h.value.scheduleTime*1e3,"YYYY-MM-DD HH:mm"),label:"\u8C03\u5EA6\u65F6\u95F4",square:"",disable:"",filled:"",class:"tw-mb-4"},null,8,["model-value"]),m(K,{key:"timeout",modelValue:h.value.timeout,"onUpdate:modelValue":E[5]||(E[5]=_=>h.value.timeout=_),modelModifiers:{number:!0},type:"number",label:"\u8D85\u65F6\u65F6\u95F4 (\u5355\u4F4D:\u79D2 s)",square:"",disable:"",filled:"",class:"tw-mb-4"},null,8,["modelValue"]),m(K,{key:"command",modelValue:h.value.command,"onUpdate:modelValue":E[6]||(E[6]=_=>h.value.command=_),placeholder:'echo "hello word"',type:"textarea",label:"\u6267\u884C\u6307\u4EE4",autogrow:"",disable:"",square:"",filled:"",class:"tw-mb-4"},null,8,["modelValue"]),m(K,{key:"remark","model-value":h.value.noseize===1?"\u662F":"\u5426",type:"textarea",label:"\u5E76\u884C\u8C03\u5EA6",autogrow:"",disable:"",square:"",filled:"",class:"tw-mb-4"},null,8,["model-value"])]),_:1})],64)}}}),Pl={class:"q-ml-sm"},zl={key:0,class:"tw-flex tw-flex-row-reverse tw-pb-3 tw-flex-wrap tw-gap-1"},Ul=te(" \u6267\u884C "),Ll={class:"q-pa-sm"},Zl=Le({props:{id:{type:String,default:""},projectId:{type:Number,required:!0}},setup(e){const l=e,i=g(()=>({id:"",name:"",projectId:l.projectId,command:"",remark:"",timeout:300,createTime:0,noseize:0})),d=Ze(),o=g(()=>{var p;return(p=d.state.WorkFlowTask.tasks.get(l.projectId))==null?void 0:p.find(n=>n.id===l.id)}),u=g(()=>d.state.Project.projects.find(p=>p.id===l.projectId)),h=Y(Object.assign({},o.value||i.value));Ue(()=>{h.value=Object.assign({},o.value||i.value)});const r=g(()=>JSON.stringify(o.value)!==JSON.stringify(h.value)),w=g(()=>{const{name:p,command:n,timeout:_}=h.value;return p!==""&&n!==""&&_>0}),A=g(()=>{const{name:p,command:n,timeout:_}=h.value;return p===""?"\u4EFB\u52A1\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A":n===""?"\u6267\u884C\u6307\u4EE4\u4E0D\u80FD\u4E3A\u7A7A":_<=0?"\u8D85\u65F6\u65F6\u95F4\u672A\u6307\u5B9A":""}),v=Yt();async function f(){if(d.commit("cleanError"),!w.value){d.commit("error",{error:{message:A.value}});return}if(await d.dispatch("saveWorkFlowTask",{task:h.value}),await d.dispatch("WorkFlowTask/fetchTasks",{projectId:l.projectId}),E.value){const p=Object.assign([],d.state.WorkFlowTask.tasks.get(l.projectId)||[]);p.sort((_,ye)=>_.createTime-ye.createTime);const n=p[p.length-1];v.push({name:"workflow_task",params:{projectId:l.projectId,taskId:n.id}})}}function F(){h.value=Object.assign({},o.value||i.value)}const N=Y(!1);async function P(p,n){d.commit("cleanError"),await d.dispatch("deleteWorkFlowTask",{projectId:p,taskId:n}),d.state.Root.currentError===void 0&&(d.dispatch("WorkFlowTask/fetchTasks",B({},l)),v.push({name:"workflow_tasks"}),N.value=!1)}const I=At(),E=g(()=>I.name&&I.name.toString()==="create_workflow_task"),ie=Y(!1);async function ae(p,n){ie.value=!0;try{await la(d.getters.apiv1,p,n)}finally{ie.value=!1}}return Ye(()=>{d.watch(p=>[p.Root.eventWorkFlowTask],([p])=>{!p||p.projectId!==l.projectId||d.dispatch("WorkFlowTask/fetchTasks",{projectId:l.projectId})})}),(p,n)=>(L(),De(Ht,null,[m(Bt,{modelValue:N.value,"onUpdate:modelValue":n[1]||(n[1]=_=>N.value=_)},{default:j(()=>[m(xt,null,{default:j(()=>[m(st,{class:"row items-center"},{default:j(()=>{var _;return[m(Ra,{icon:"delete",color:"primary","text-color":"white"}),ne("span",Pl," \u662F\u5426\u8981\u5220\u9664\u4EFB\u52A1 "+we((_=D(o))==null?void 0:_.name),1)]}),_:1}),m(da,{align:"right"},{default:j(()=>[lt(m(R,{flat:"",label:"\u53D6\u6D88",color:"primary"},null,512),[[bt]]),m(R,{flat:"",label:"\u5220\u9664",color:"red",onClick:n[0]||(n[0]=()=>D(u)&&D(o)&&P(D(u).id,D(o).id))})]),_:1})]),_:1})]),_:1},8,["modelValue"]),D(E)?oe("",!0):(L(),De("div",zl,[m(R,{flat:"",class:"tw-w-24 tw-text-red-300 lg:tw-hidden",icon:"delete",onClick:n[2]||(n[2]=_=>N.value=!0)}),m(R,{color:"primary","text-color":"black",disable:!0,class:"tw-w-24",loading:ie.value,onClick:n[3]||(n[3]=()=>D(o)&&ae(e.projectId,D(o).id))},{default:j(()=>[Ul]),_:1},8,["disable","loading"])])),m($t,{class:"tw-w-full",onSubmit:f,onReset:F},{default:j(()=>[D(o)?(L(),se(K,{key:"id","model-value":D(o).id,disable:"",label:"\u4EFB\u52A1 ID",square:"",filled:"",class:"tw-mb-4"},null,8,["model-value"])):oe("",!0),m(K,{key:"project","model-value":D(u)?D(u).title:"",disable:"",label:"\u6240\u5C5E\u9879\u76EE",square:"",filled:"",class:"tw-mb-4"},null,8,["model-value"]),m(K,{key:"name",modelValue:h.value.name,"onUpdate:modelValue":n[4]||(n[4]=_=>h.value.name=_),label:"\u4EFB\u52A1\u540D\u79F0",square:"",filled:"",class:"tw-mb-4"},null,8,["modelValue"]),m(K,{key:"timeout",modelValue:h.value.timeout,"onUpdate:modelValue":n[5]||(n[5]=_=>h.value.timeout=_),modelModifiers:{number:!0},type:"number",label:"\u8D85\u65F6\u65F6\u95F4 (\u5355\u4F4D:\u79D2 s)",square:"",filled:"",class:"tw-mb-4"},null,8,["modelValue"]),m(K,{key:"command",modelValue:h.value.command,"onUpdate:modelValue":n[6]||(n[6]=_=>h.value.command=_),type:"textarea",placeholder:'echo "hello word"',label:"\u6267\u884C\u6307\u4EE4",autogrow:"",square:"",filled:"",class:"tw-mb-4"},null,8,["modelValue"]),m(K,{key:"remark",modelValue:h.value.remark,"onUpdate:modelValue":n[7]||(n[7]=_=>h.value.remark=_),type:"textarea",label:"\u4EFB\u52A1\u5907\u6CE8",autogrow:"",square:"",filled:"",class:"tw-mb-4"},null,8,["modelValue"]),m(_t,{key:"noseize",modelValue:h.value.noseize,"onUpdate:modelValue":n[8]||(n[8]=_=>h.value.noseize=_),"false-value":0,"true-value":1,label:"\u5E76\u884C\u8C03\u5EA6",class:"tw-mb-4"},null,8,["modelValue"]),ne("div",Ll,[m(R,{color:"primary","text-color":"black",type:"submit",label:"\u4FDD\u5B58",disable:!D(r),class:"lg:tw-w-24 tw-w-full lg:tw-mr-4 lg:tw-mb-0 tw-mb-4"},null,8,["disable"]),m(R,{color:"primary",type:"reset",label:"\u91CD\u7F6E",flat:"",disable:!D(r),class:"lg:tw-w-24 tw-w-full"},null,8,["disable"])])]),_:1})],64))}}),Kl={class:"tw-px-4 tw-pt-2 tw-w-full tw-h-full tw-flex tw-flex-col"},Wl={class:"tw-text-[#7e7e7e] tw-mb-4"},Jl={class:"tw-flex tw-items-center tw-justify-start tw-gap-4 tw-text-lg tw-mb-4"},Xl={key:0,class:"tw-pb-4"},Gl={class:"tw-pb-4"},eu={class:"tw-flex tw-flex-wrap tw-gap-3 tw-px-2 tw-py-1 tw-text-white tw-bg-black"},tu={class:"tw-flex tw-w-full tw-grow"},au={class:"tw-h-full tw-w-full tw-flex tw-flex-col"},lu={key:0,class:"tw-hidden lg:tw-block"},qu=Le({props:{id:{type:String,default:""},projectId:{type:Number,required:!0},type:{type:String,default:"crontab"}},setup(e){const l=e,i=Ze(),d=g(()=>i.state.Project.projects.find(f=>f.id===l.projectId)),o=At(),u=Y(),h=()=>{rt(()=>{var f;(f=u.value)==null||f.setScrollPosition("vertical",0)})},r=g(()=>o.name&&o.name.toString()===`create_${l.type}_task`),w=g(()=>{var f;if(r.value)return"detail";if(o.name){const F=o.name.toString();if(F===`${l.type}_task_logs`)return"logs";if(F===`${l.type}_task`)return"detail"}throw new Error(`Unknown route name ${(f=o.name)==null?void 0:f.toString()}`)}),{width:A}=Ka();Ye(()=>{i.dispatch("Project/fetchProjectClients",{projectId:l.projectId})}),Na(()=>{i.commit("Project/setProjectClients",{clients:[]})});const v=g(()=>i.state.Project.projectClients.get(l.projectId));return(f,F)=>{var N,P;return L(),De("div",Kl,[ne("div",Wl,[ne("div",Jl,[ne("span",null,[m(Dt,{name:"folder"}),te(" "+we((N=D(d))==null?void 0:N.title),1)]),ne("span",null," ID: "+we(e.projectId),1)]),D(d)&&D(d).remark.trim()!==""?(L(),De("div",Xl,we(D(d).remark),1)):oe("",!0),ne("div",null,[ne("div",Gl,[m(Dt,{name:"hive"}),te(" \u5728\u7EBF\u8282\u70B9: "+we(((P=D(v))==null?void 0:P.length)||0),1)]),ne("div",eu,[(L(!0),De(Ht,null,Pa(D(v),I=>(L(),De("div",{key:I},we(I),1))),128))])])]),D(r)?oe("",!0):(L(),se(zt,{key:0,"model-value":D(w),"active-color":"primary",align:"left",class:"lg:tw-hidden tw-display"},{default:j(()=>[m(wt,{name:"detail",label:"\u8BE6\u60C5",to:{name:`${l.type}_task`,params:{taskId:l.id}},replace:""},null,8,["to"]),m(wt,{name:"logs",label:"\u65E5\u5FD7",to:{name:`${l.type}_task_logs`,params:{taskId:l.id}},replace:""},null,8,["to"])]),_:1},8,["model-value"])),ne("div",tu,[ne("div",au,[m(D(Za),{ref_key:"scroll",ref:u,class:"tw-grow","thumb-style":D(ul),"bar-style":D(nl)},{default:j(()=>[m(Ua,{"model-value":D(w),animated:"",vertical:D(A)>=1024,class:"tw-w-full tw-h-full tw-bg-[#121212] tw-p-0 lg:tw-pr-4"},{default:j(()=>[m(Ut,{name:"detail",class:"tw-px-0"},{default:j(()=>[l.type==="crontab"?(L(),se(Sl,{key:0,id:l.id,"project-id":l.projectId},null,8,["id","project-id"])):l.type==="workflow"?(L(),se(Zl,{key:1,id:l.id,"project-id":l.projectId},null,8,["id","project-id"])):oe("",!0),l.type==="temporary"?(L(),se(Nl,{key:2,id:Number(l.id),"project-id":l.projectId},null,8,["id","project-id"])):oe("",!0)]),_:1}),m(Ut,{name:"logs",class:"tw-px-0"},{default:j(()=>[m(Hl,{id:l.id,"project-id":l.projectId,onOnpage:h},null,8,["id","project-id"])]),_:1})]),_:1},8,["model-value","vertical"])]),_:1},8,["thumb-style","bar-style"])]),l.type!="temporary"?(L(),De("div",lu,[D(r)?oe("",!0):(L(),se(zt,{key:0,"model-value":D(w),"active-color":"primary",vertical:"","switch-indicator":"",align:"left"},{default:j(()=>[m(wt,{name:"detail",label:"\u8BE6\u60C5",to:{name:`${l.type}_task`,params:{taskId:l.id}},replace:""},null,8,["to"]),m(wt,{name:"logs",label:"\u65E5\u5FD7",to:{name:`${l.type}_task_logs`,params:{taskId:l.id}},replace:""},null,8,["to"])]),_:1},8,["model-value"]))])):oe("",!0)])])}}});export{qu as default};
