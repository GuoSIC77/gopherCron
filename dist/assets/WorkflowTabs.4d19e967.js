var Ct=Object.defineProperty,Vt=Object.defineProperties;var Ot=Object.getOwnPropertyDescriptors;var ze=Object.getOwnPropertySymbols;var St=Object.prototype.hasOwnProperty,Bt=Object.prototype.propertyIsEnumerable;var We=(e,t,n)=>t in e?Ct(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ue=(e,t)=>{for(var n in t||(t={}))St.call(t,n)&&We(e,n,t[n]);if(ze)for(var n of ze(t))Bt.call(t,n)&&We(e,n,t[n]);return e},qe=(e,t)=>Vt(e,Ot(t));import{Q as Je,b as Mt,a as oe,c as Fe}from"./QTabPanels.f701a35a.js";import{w as ee,aD as Tt,j as ne,c as M,r as D,u as we,l as T,m as P,q as E,s as b,z as N,A as rt,F as $,o as ie,cE as Dt,aw as Ke,E as ve,aI as $t,t as J,J as Pt,n as Ce,aC as Qt,k as ke,bp as Lt,Q as q,f as re,I as pe,x as he,cF as Rt,cG as zt,cH as Wt,cI as Ut,B as qt,D as at,cJ as Jt,cK as Kt}from"./index.858abf03.js";import{u as lt,Q as Ht}from"./QToggle.620acab6.js";import{_ as He}from"./Confirm.200ef114.js";import{Q as Yt,b as it,a as le}from"./QDialog.eb528cda.js";import{Q as Xt,C as ae}from"./ClosePopup.411262dd.js";import{a as H,Q as Y,b as ye}from"./QItem.b0539e07.js";import{Q as st}from"./QSeparator.d5e61ebf.js";import{Q as Gt}from"./QList.53c0d763.js";import{Q as Zt}from"./QChip.48edc830.js";import{Q as ut}from"./QSelect.b4c9e565.js";import{Q as Ie}from"./QInput.39515e5e.js";import{Q as en}from"./QForm.44afa5f8.js";import{Q as tn}from"./QInnerLoading.f7395b79.js";import{_ as nn,Q as on}from"./JSONViewer.22fd735d.js";import{f as Ye}from"./datetime.6205e5a7.js";import"./uid.42677368.js";import"./touch.9357bf86.js";import"./use-prevent-scroll.a5760f87.js";import"./focus-manager.2ec597e1.js";import"./rtl.b51694b1.js";import"./use-key-composition.89abe8dc.js";import"./format.865294d5.js";var rn=Object.defineProperty,an=Object.defineProperties,ln=Object.getOwnPropertyDescriptors,Xe=Object.getOwnPropertySymbols,sn=Object.prototype.hasOwnProperty,un=Object.prototype.propertyIsEnumerable,Ge=(e,t,n)=>t in e?rn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,je=(e,t)=>{for(var n in t||(t={}))sn.call(t,n)&&Ge(e,n,t[n]);if(Xe)for(var n of Xe(t))un.call(t,n)&&Ge(e,n,t[n]);return e},fn=(e,t)=>an(e,ln(t));function ft(e,t){var n,o=1;e==null&&(e=0),t==null&&(t=0);function r(){var i,s=n.length,l,u=0,a=0;for(i=0;i<s;++i)l=n[i],u+=l.x,a+=l.y;for(u=(u/s-e)*o,a=(a/s-t)*o,i=0;i<s;++i)l=n[i],l.x-=u,l.y-=a}return r.initialize=function(i){n=i},r.x=function(i){return arguments.length?(e=+i,r):e},r.y=function(i){return arguments.length?(t=+i,r):t},r.strength=function(i){return arguments.length?(o=+i,r):o},r}function dn(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return dt(this.cover(t,n),t,n,e)}function dt(e,t,n,o){if(isNaN(t)||isNaN(n))return e;var r,i=e._root,s={data:o},l=e._x0,u=e._y0,a=e._x1,f=e._y1,m,w,h,k,c,d,p,g;if(!i)return e._root=s,e;for(;i.length;)if((c=t>=(m=(l+a)/2))?l=m:a=m,(d=n>=(w=(u+f)/2))?u=w:f=w,r=i,!(i=i[p=d<<1|c]))return r[p]=s,e;if(h=+e._x.call(null,i.data),k=+e._y.call(null,i.data),t===h&&n===k)return s.next=i,r?r[p]=s:e._root=s,e;do r=r?r[p]=new Array(4):e._root=new Array(4),(c=t>=(m=(l+a)/2))?l=m:a=m,(d=n>=(w=(u+f)/2))?u=w:f=w;while((p=d<<1|c)===(g=(k>=w)<<1|h>=m));return r[g]=i,r[p]=s,e}function cn(e){var t,n,o=e.length,r,i,s=new Array(o),l=new Array(o),u=1/0,a=1/0,f=-1/0,m=-1/0;for(n=0;n<o;++n)isNaN(r=+this._x.call(null,t=e[n]))||isNaN(i=+this._y.call(null,t))||(s[n]=r,l[n]=i,r<u&&(u=r),r>f&&(f=r),i<a&&(a=i),i>m&&(m=i));if(u>f||a>m)return this;for(this.cover(u,a).cover(f,m),n=0;n<o;++n)dt(this,s[n],l[n],e[n]);return this}function pn(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,o=this._y0,r=this._x1,i=this._y1;if(isNaN(n))r=(n=Math.floor(e))+1,i=(o=Math.floor(t))+1;else{for(var s=r-n||1,l=this._root,u,a;n>e||e>=r||o>t||t>=i;)switch(a=(t<o)<<1|e<n,u=new Array(4),u[a]=l,l=u,s*=2,a){case 0:r=n+s,i=o+s;break;case 1:n=r-s,i=o+s;break;case 2:r=n+s,o=i-s;break;case 3:n=r-s,o=i-s;break}this._root&&this._root.length&&(this._root=l)}return this._x0=n,this._y0=o,this._x1=r,this._y1=i,this}function vn(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function hn(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function W(e,t,n,o,r){this.node=e,this.x0=t,this.y0=n,this.x1=o,this.y1=r}function gn(e,t,n){var o,r=this._x0,i=this._y0,s,l,u,a,f=this._x1,m=this._y1,w=[],h=this._root,k,c;for(h&&w.push(new W(h,r,i,f,m)),n==null?n=1/0:(r=e-n,i=t-n,f=e+n,m=t+n,n*=n);k=w.pop();)if(!(!(h=k.node)||(s=k.x0)>f||(l=k.y0)>m||(u=k.x1)<r||(a=k.y1)<i))if(h.length){var d=(s+u)/2,p=(l+a)/2;w.push(new W(h[3],d,p,u,a),new W(h[2],s,p,d,a),new W(h[1],d,l,u,p),new W(h[0],s,l,d,p)),(c=(t>=p)<<1|e>=d)&&(k=w[w.length-1],w[w.length-1]=w[w.length-1-c],w[w.length-1-c]=k)}else{var g=e-+this._x.call(null,h.data),A=t-+this._y.call(null,h.data),_=g*g+A*A;if(_<n){var j=Math.sqrt(n=_);r=e-j,i=t-j,f=e+j,m=t+j,o=h.data}}return o}function wn(e){if(isNaN(f=+this._x.call(null,e))||isNaN(m=+this._y.call(null,e)))return this;var t,n=this._root,o,r,i,s=this._x0,l=this._y0,u=this._x1,a=this._y1,f,m,w,h,k,c,d,p;if(!n)return this;if(n.length)for(;;){if((k=f>=(w=(s+u)/2))?s=w:u=w,(c=m>=(h=(l+a)/2))?l=h:a=h,t=n,!(n=n[d=c<<1|k]))return this;if(!n.length)break;(t[d+1&3]||t[d+2&3]||t[d+3&3])&&(o=t,p=d)}for(;n.data!==e;)if(r=n,!(n=n.next))return this;return(i=n.next)&&delete n.next,r?(i?r.next=i:delete r.next,this):t?(i?t[d]=i:delete t[d],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(o?o[p]=n:this._root=n),this):(this._root=i,this)}function mn(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function yn(){return this._root}function _n(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function kn(e){var t=[],n,o=this._root,r,i,s,l,u;for(o&&t.push(new W(o,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(o=n.node,i=n.x0,s=n.y0,l=n.x1,u=n.y1)&&o.length){var a=(i+l)/2,f=(s+u)/2;(r=o[3])&&t.push(new W(r,a,f,l,u)),(r=o[2])&&t.push(new W(r,i,f,a,u)),(r=o[1])&&t.push(new W(r,a,s,l,f)),(r=o[0])&&t.push(new W(r,i,s,a,f))}return this}function xn(e){var t=[],n=[],o;for(this._root&&t.push(new W(this._root,this._x0,this._y0,this._x1,this._y1));o=t.pop();){var r=o.node;if(r.length){var i,s=o.x0,l=o.y0,u=o.x1,a=o.y1,f=(s+u)/2,m=(l+a)/2;(i=r[0])&&t.push(new W(i,s,l,f,m)),(i=r[1])&&t.push(new W(i,f,l,u,m)),(i=r[2])&&t.push(new W(i,s,m,f,a)),(i=r[3])&&t.push(new W(i,f,m,u,a))}n.push(o)}for(;o=n.pop();)e(o.node,o.x0,o.y0,o.x1,o.y1);return this}function bn(e){return e[0]}function Nn(e){return arguments.length?(this._x=e,this):this._x}function En(e){return e[1]}function Fn(e){return arguments.length?(this._y=e,this):this._y}function Se(e,t,n){var o=new Be(t==null?bn:t,n==null?En:n,NaN,NaN,NaN,NaN);return e==null?o:o.addAll(e)}function Be(e,t,n,o,r,i){this._x=e,this._y=t,this._x0=n,this._y0=o,this._x1=r,this._y1=i,this._root=void 0}function Ze(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var U=Se.prototype=Be.prototype;U.copy=function(){var e=new Be(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,o;if(!t)return e;if(!t.length)return e._root=Ze(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var r=0;r<4;++r)(o=t.source[r])&&(o.length?n.push({source:o,target:t.target[r]=new Array(4)}):t.target[r]=Ze(o));return e};U.add=dn;U.addAll=cn;U.cover=pn;U.data=vn;U.extent=hn;U.find=gn;U.remove=wn;U.removeAll=mn;U.root=yn;U.size=_n;U.visit=kn;U.visitAfter=xn;U.x=Nn;U.y=Fn;function Q(e){return function(){return e}}function X(e){return(e()-.5)*1e-6}function In(e){return e.x+e.vx}function jn(e){return e.y+e.vy}function ct(e){var t,n,o,r=1,i=1;typeof e!="function"&&(e=Q(e==null?1:+e));function s(){for(var a,f=t.length,m,w,h,k,c,d,p=0;p<i;++p)for(m=Se(t,In,jn).visitAfter(l),a=0;a<f;++a)w=t[a],c=n[w.index],d=c*c,h=w.x+w.vx,k=w.y+w.vy,m.visit(g);function g(A,_,j,x,V){var I=A.data,S=A.r,O=c+S;if(I){if(I.index>w.index){var R=h-I.x-I.vx,L=k-I.y-I.vy,z=R*R+L*L;z<O*O&&(R===0&&(R=X(o),z+=R*R),L===0&&(L=X(o),z+=L*L),z=(O-(z=Math.sqrt(z)))/z*r,w.vx+=(R*=z)*(O=(S*=S)/(d+S)),w.vy+=(L*=z)*O,I.vx-=R*(O=1-O),I.vy-=L*O)}return}return _>h+O||x<h-O||j>k+O||V<k-O}}function l(a){if(a.data)return a.r=n[a.data.index];for(var f=a.r=0;f<4;++f)a[f]&&a[f].r>a.r&&(a.r=a[f].r)}function u(){if(!!t){var a,f=t.length,m;for(n=new Array(f),a=0;a<f;++a)m=t[a],n[m.index]=+e(m,a,t)}}return s.initialize=function(a,f){t=a,o=f,u()},s.iterations=function(a){return arguments.length?(i=+a,s):i},s.strength=function(a){return arguments.length?(r=+a,s):r},s.radius=function(a){return arguments.length?(e=typeof a=="function"?a:Q(+a),u(),s):e},s}function An(e){return e.index}function et(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function pt(e){var t=An,n=m,o,r=Q(30),i,s,l,u,a,f=1;e==null&&(e=[]);function m(d){return 1/Math.min(l[d.source.index],l[d.target.index])}function w(d){for(var p=0,g=e.length;p<f;++p)for(var A=0,_,j,x,V,I,S,O;A<g;++A)_=e[A],j=_.source,x=_.target,V=x.x+x.vx-j.x-j.vx||X(a),I=x.y+x.vy-j.y-j.vy||X(a),S=Math.sqrt(V*V+I*I),S=(S-i[A])/S*d*o[A],V*=S,I*=S,x.vx-=V*(O=u[A]),x.vy-=I*O,j.vx+=V*(O=1-O),j.vy+=I*O}function h(){if(!!s){var d,p=s.length,g=e.length,A=new Map(s.map((j,x)=>[t(j,x,s),j])),_;for(d=0,l=new Array(p);d<g;++d)_=e[d],_.index=d,typeof _.source!="object"&&(_.source=et(A,_.source)),typeof _.target!="object"&&(_.target=et(A,_.target)),l[_.source.index]=(l[_.source.index]||0)+1,l[_.target.index]=(l[_.target.index]||0)+1;for(d=0,u=new Array(g);d<g;++d)_=e[d],u[d]=l[_.source.index]/(l[_.source.index]+l[_.target.index]);o=new Array(g),k(),i=new Array(g),c()}}function k(){if(!!s)for(var d=0,p=e.length;d<p;++d)o[d]=+n(e[d],d,e)}function c(){if(!!s)for(var d=0,p=e.length;d<p;++d)i[d]=+r(e[d],d,e)}return w.initialize=function(d,p){s=d,a=p,h()},w.links=function(d){return arguments.length?(e=d,h(),w):e},w.id=function(d){return arguments.length?(t=d,w):t},w.iterations=function(d){return arguments.length?(f=+d,w):f},w.strength=function(d){return arguments.length?(n=typeof d=="function"?d:Q(+d),k(),w):n},w.distance=function(d){return arguments.length?(r=typeof d=="function"?d:Q(+d),c(),w):r},w}var Cn={value:()=>{}};function vt(){for(var e=0,t=arguments.length,n={},o;e<t;++e){if(!(o=arguments[e]+"")||o in n||/[\s.]/.test(o))throw new Error("illegal type: "+o);n[o]=[]}return new _e(n)}function _e(e){this._=e}function Vn(e,t){return e.trim().split(/^|\s+/).map(function(n){var o="",r=n.indexOf(".");if(r>=0&&(o=n.slice(r+1),n=n.slice(0,r)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:o}})}_e.prototype=vt.prototype={constructor:_e,on:function(e,t){var n=this._,o=Vn(e+"",n),r,i=-1,s=o.length;if(arguments.length<2){for(;++i<s;)if((r=(e=o[i]).type)&&(r=On(n[r],e.name)))return r;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++i<s;)if(r=(e=o[i]).type)n[r]=tt(n[r],e.name,t);else if(t==null)for(r in n)n[r]=tt(n[r],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new _e(e)},call:function(e,t){if((r=arguments.length-2)>0)for(var n=new Array(r),o=0,r,i;o<r;++o)n[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],o=0,r=i.length;o<r;++o)i[o].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var o=this._[e],r=0,i=o.length;r<i;++r)o[r].value.apply(t,n)}};function On(e,t){for(var n=0,o=e.length,r;n<o;++n)if((r=e[n]).name===t)return r.value}function tt(e,t,n){for(var o=0,r=e.length;o<r;++o)if(e[o].name===t){e[o]=Cn,e=e.slice(0,o).concat(e.slice(o+1));break}return n!=null&&e.push({name:t,value:n}),e}var se=0,de=0,fe=0,ht=1e3,xe,ce,be=0,te=0,Ne=0,ge=typeof performance=="object"&&performance.now?performance:Date,gt=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function wt(){return te||(gt(Sn),te=ge.now()+Ne)}function Sn(){te=0}function Ve(){this._call=this._time=this._next=null}Ve.prototype=mt.prototype={constructor:Ve,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?wt():+n)+(t==null?0:+t),!this._next&&ce!==this&&(ce?ce._next=this:xe=this,ce=this),this._call=e,this._time=n,Oe()},stop:function(){this._call&&(this._call=null,this._time=1/0,Oe())}};function mt(e,t,n){var o=new Ve;return o.restart(e,t,n),o}function Bn(){wt(),++se;for(var e=xe,t;e;)(t=te-e._time)>=0&&e._call.call(void 0,t),e=e._next;--se}function nt(){te=(be=ge.now())+Ne,se=de=0;try{Bn()}finally{se=0,Tn(),te=0}}function Mn(){var e=ge.now(),t=e-be;t>ht&&(Ne-=t,be=e)}function Tn(){for(var e,t=xe,n,o=1/0;t;)t._call?(o>t._time&&(o=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:xe=n);ce=e,Oe(o)}function Oe(e){if(!se){de&&(de=clearTimeout(de));var t=e-te;t>24?(e<1/0&&(de=setTimeout(nt,e-ge.now()-Ne)),fe&&(fe=clearInterval(fe))):(fe||(be=ge.now(),fe=setInterval(Mn,ht)),se=1,gt(nt))}}const Dn=1664525,$n=1013904223,ot=4294967296;function Pn(){let e=1;return()=>(e=(Dn*e+$n)%ot)/ot}function Qn(e){return e.x}function Ln(e){return e.y}var Rn=10,zn=Math.PI*(3-Math.sqrt(5));function yt(e){var t,n=1,o=.001,r=1-Math.pow(o,1/300),i=0,s=.6,l=new Map,u=mt(m),a=vt("tick","end"),f=Pn();e==null&&(e=[]);function m(){w(),a.call("tick",t),n<o&&(u.stop(),a.call("end",t))}function w(c){var d,p=e.length,g;c===void 0&&(c=1);for(var A=0;A<c;++A)for(n+=(i-n)*r,l.forEach(function(_){_(n)}),d=0;d<p;++d)g=e[d],g.fx==null?g.x+=g.vx*=s:(g.x=g.fx,g.vx=0),g.fy==null?g.y+=g.vy*=s:(g.y=g.fy,g.vy=0);return t}function h(){for(var c=0,d=e.length,p;c<d;++c){if(p=e[c],p.index=c,p.fx!=null&&(p.x=p.fx),p.fy!=null&&(p.y=p.fy),isNaN(p.x)||isNaN(p.y)){var g=Rn*Math.sqrt(.5+c),A=c*zn;p.x=g*Math.cos(A),p.y=g*Math.sin(A)}(isNaN(p.vx)||isNaN(p.vy))&&(p.vx=p.vy=0)}}function k(c){return c.initialize&&c.initialize(e,f),c}return h(),t={tick:w,restart:function(){return u.restart(m),t},stop:function(){return u.stop(),t},nodes:function(c){return arguments.length?(e=c,h(),l.forEach(k),t):e},alpha:function(c){return arguments.length?(n=+c,t):n},alphaMin:function(c){return arguments.length?(o=+c,t):o},alphaDecay:function(c){return arguments.length?(r=+c,t):+r},alphaTarget:function(c){return arguments.length?(i=+c,t):i},velocityDecay:function(c){return arguments.length?(s=1-c,t):1-s},randomSource:function(c){return arguments.length?(f=c,l.forEach(k),t):f},force:function(c,d){return arguments.length>1?(d==null?l.delete(c):l.set(c,k(d)),t):l.get(c)},find:function(c,d,p){var g=0,A=e.length,_,j,x,V,I;for(p==null?p=1/0:p*=p,g=0;g<A;++g)V=e[g],_=c-V.x,j=d-V.y,x=_*_+j*j,x<p&&(I=V,p=x);return I},on:function(c,d){return arguments.length>1?(a.on(c,d),t):a.on(c)}}}function _t(){var e,t,n,o,r=Q(-30),i,s=1,l=1/0,u=.81;function a(h){var k,c=e.length,d=Se(e,Qn,Ln).visitAfter(m);for(o=h,k=0;k<c;++k)t=e[k],d.visit(w)}function f(){if(!!e){var h,k=e.length,c;for(i=new Array(k),h=0;h<k;++h)c=e[h],i[c.index]=+r(c,h,e)}}function m(h){var k=0,c,d,p=0,g,A,_;if(h.length){for(g=A=_=0;_<4;++_)(c=h[_])&&(d=Math.abs(c.value))&&(k+=c.value,p+=d,g+=d*c.x,A+=d*c.y);h.x=g/p,h.y=A/p}else{c=h,c.x=c.data.x,c.y=c.data.y;do k+=i[c.data.index];while(c=c.next)}h.value=k}function w(h,k,c,d){if(!h.value)return!0;var p=h.x-t.x,g=h.y-t.y,A=d-k,_=p*p+g*g;if(A*A/u<_)return _<l&&(p===0&&(p=X(n),_+=p*p),g===0&&(g=X(n),_+=g*g),_<s&&(_=Math.sqrt(s*_)),t.vx+=p*h.value*o/_,t.vy+=g*h.value*o/_),!0;if(h.length||_>=l)return;(h.data!==t||h.next)&&(p===0&&(p=X(n),_+=p*p),g===0&&(g=X(n),_+=g*g),_<s&&(_=Math.sqrt(s*_)));do h.data!==t&&(A=i[h.data.index]*o/_,t.vx+=p*A,t.vy+=g*A);while(h=h.next)}return a.initialize=function(h,k){e=h,n=k,f()},a.strength=function(h){return arguments.length?(r=typeof h=="function"?h:Q(+h),f(),a):r},a.distanceMin=function(h){return arguments.length?(s=h*h,a):Math.sqrt(s)},a.distanceMax=function(h){return arguments.length?(l=h*h,a):Math.sqrt(l)},a.theta=function(h){return arguments.length?(u=h*h,a):Math.sqrt(u)},a}function Wn(e,t,n){var o,r=Q(.1),i,s;typeof e!="function"&&(e=Q(+e)),t==null&&(t=0),n==null&&(n=0);function l(a){for(var f=0,m=o.length;f<m;++f){var w=o[f],h=w.x-t||1e-6,k=w.y-n||1e-6,c=Math.sqrt(h*h+k*k),d=(s[f]-c)*i[f]*a/c;w.vx+=h*d,w.vy+=k*d}}function u(){if(!!o){var a,f=o.length;for(i=new Array(f),s=new Array(f),a=0;a<f;++a)s[a]=+e(o[a],a,o),i[a]=isNaN(s[a])?0:+r(o[a],a,o)}}return l.initialize=function(a){o=a,u()},l.strength=function(a){return arguments.length?(r=typeof a=="function"?a:Q(+a),u(),l):r},l.radius=function(a){return arguments.length?(e=typeof a=="function"?a:Q(+a),u(),l):e},l.x=function(a){return arguments.length?(t=+a,l):t},l.y=function(a){return arguments.length?(n=+a,l):n},l}function Un(e){var t=Q(.1),n,o,r;typeof e!="function"&&(e=Q(e==null?0:+e));function i(l){for(var u=0,a=n.length,f;u<a;++u)f=n[u],f.vx+=(r[u]-f.x)*o[u]*l}function s(){if(!!n){var l,u=n.length;for(o=new Array(u),r=new Array(u),l=0;l<u;++l)o[l]=isNaN(r[l]=+e(n[l],l,n))?0:+t(n[l],l,n)}}return i.initialize=function(l){n=l,s()},i.strength=function(l){return arguments.length?(t=typeof l=="function"?l:Q(+l),s(),i):t},i.x=function(l){return arguments.length?(e=typeof l=="function"?l:Q(+l),s(),i):e},i}function qn(e){var t=Q(.1),n,o,r;typeof e!="function"&&(e=Q(e==null?0:+e));function i(l){for(var u=0,a=n.length,f;u<a;++u)f=n[u],f.vy+=(r[u]-f.y)*o[u]*l}function s(){if(!!n){var l,u=n.length;for(o=new Array(u),r=new Array(u),l=0;l<u;++l)o[l]=isNaN(r[l]=+e(n[l],l,n))?0:+t(n[l],l,n)}}return i.initialize=function(l){n=l,s()},i.strength=function(l){return arguments.length?(t=typeof l=="function"?l:Q(+l),s(),i):t},i.y=function(l){return arguments.length?(e=typeof l=="function"?l:Q(+l),s(),i):e},i}var Jn=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",forceCenter:ft,forceCollide:ct,forceLink:pt,forceManyBody:_t,forceRadial:Wn,forceSimulation:yt,forceX:Un,forceY:qn});class Kn{constructor(t={}){this.options=t}activate(t){const{layouts:n,nodes:o,edges:r,emitter:i,svgPanZoom:s}=t;let{nodeLayouts:l,nodeLayoutMap:u}=this.buildNodeLayouts(o.value,n,{x:0,y:0});const a=this.createSimulation(l,this.forceLayoutEdges(r.value));a.on("tick",()=>{var c,d;for(const p of l){const g=n==null?void 0:n[p.id];g&&(g.x=(c=p.x)!=null?c:0,g.y=(d=p.y)!=null?d:0)}});const f=()=>{a.alpha(.1).restart()},m=c=>{for(const[d,p]of Object.entries(c)){const g=u[d];g.fx=p.x,g.fy=p.y}f()},w=c=>{var d;for(const[p,g]of Object.entries(c)){const A=this.getNodeLayout(n,p),_=(d=u==null?void 0:u[p])!=null?d:{x:0,y:0};A.value.fixed||this.options.positionFixedByDrag?(_.fx=g.x,_.fy=g.y,A.value.fixed=!0):(_.x=g.x,_.y=g.y,delete _.fx,delete _.fy)}f()},h=({node:c,event:d})=>{if(this.options.positionFixedByClickWithAltKey&&d.altKey){const p=this.getNodeLayout(n,c);let g=u==null?void 0:u[c];g||(g={id:c,x:0,y:0},u[c]=g),p.value.fixed?(delete p.value.fixed,g.x=g.fx||g.x,g.y=g.fy||g.y,delete g.fx,delete g.fy):(p.value.fixed=!0,g.fx=g.x,g.fy=g.y),f()}},k=ee(()=>[Object.keys(o.value),r.value],()=>{const c=s.getViewArea();({nodeLayouts:l,nodeLayoutMap:u}=this.buildNodeLayouts(o.value,n,c.center)),a.nodes(l);const d=a.force("edge");d&&d.links(this.forceLayoutEdges(r.value)),f()},{deep:!0});i.on("node:dragstart",m),i.on("node:pointermove",m),i.on("node:dragend",w),i.on("node:click",h),this.onDeactivate=()=>{a.stop(),k(),i.off("node:dragstart",m),i.off("node:pointermove",m),i.off("node:dragend",w),i.off("node:click",h)}}deactivate(){this.onDeactivate&&this.onDeactivate()}createSimulation(t,n){if(this.options.createSimulation)return this.options.createSimulation(Jn,t,n);{const o=pt(n).id(r=>r.id);return yt(t).force("edge",o.distance(100)).force("charge",_t()).force("collide",ct(50).strength(.2)).force("center",ft().strength(.05)).alphaMin(.001)}}buildNodeLayouts(t,n,o){const r=Object.keys(t).filter(l=>!(l in n));for(const l of r)n[l]=je({},o);const i=this.forceNodeLayouts(n),s=Object.fromEntries(i.map(l=>[l.id,l]));return{nodeLayouts:i,nodeLayoutMap:s}}forceNodeLayouts(t){return Object.entries(t).map(([n,o])=>o.fixed?fn(je({id:n},o),{fx:o.x,fy:o.y}):je({id:n},o))}forceLayoutEdges(t){return Object.values(t).map(n=>({source:n.source,target:n.target}))}getNodeLayout(t,n){const o=Tt(t,n);return o.value||(o.value={x:0,y:0}),o}}const Hn=$(" No results "),Yn=ne({props:{modelValue:{type:Object,default:null}},emits:["update:modelValue"],setup(e,{emit:t}){const n=e,o=M({get(){return n.modelValue},set(u){t("update:modelValue",u)}}),r=D(""),i=we(),s=M(()=>i.state.Project.projects.filter(u=>u.title.indexOf(r.value)>=0||u.id.toString().indexOf(r.value)>=0)),l=(u,a,f)=>{const m=()=>r.value=u;s.value.length===0?i.dispatch("Project/fetchProjects").then(()=>a(m)):a(m)};return(u,a)=>(T(),P(N(ut),{modelValue:N(o),"onUpdate:modelValue":a[0]||(a[0]=f=>rt(o)?o.value=f:null),label:"\u9879\u76EE\u5217\u8868","map-options":"","emit-value":"",behavior:"menu",options:N(s).map(f=>({label:f.title,value:f})),onFilter:l},{"no-option":E(()=>[b(Y,null,{default:E(()=>[b(H,{class:"text-grey"},{default:E(()=>[Hn]),_:1})]),_:1})]),_:1},8,["modelValue","options"]))}}),Xn=ne({props:{modelValue:{type:Object,default:null},projectId:{type:Number,required:!0},workflowId:{type:Number,required:!0},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,{emit:t}){const n=e,o=M({get(){return n.modelValue},set(u){t("update:modelValue",u)}}),r=D(""),i=we(),s=M(()=>{var u;return((u=i.state.WorkFlowTask.tasks.get(n.projectId))==null?void 0:u.filter(a=>(a.workflowId===0||a.workflowId===n.workflowId)&&(a.name.indexOf(r.value)>=0||a.id.indexOf(r.value)>=0)))||[]}),l=(u,a,f)=>{const m=()=>r.value=u;s.value.length===0?i.dispatch("WorkFlowTask/fetchTasks",{projectId:n.projectId}).then(()=>a(m)):a(m)};return ie(()=>{ee(()=>n.projectId,(u,a)=>{t("update:modelValue",void 0)})}),(u,a)=>(T(),P(N(ut),{modelValue:N(o),"onUpdate:modelValue":a[0]||(a[0]=f=>rt(o)?o.value=f:null),label:"\u4EFB\u52A1\u5217\u8868","map-options":"","emit-value":"",behavior:"menu",disable:n.disabled,options:N(s).map(f=>({label:f.name,value:f})),onFilter:l},null,8,["modelValue","disable","options"]))}});function Ae(e){const t=Object.assign({},e);return t.deps&&(t.deps=Object.assign([],t.deps)),t}function Gn(e){const t=new Map,n=new Map;for(const l of e)if(t.set(l.id,l.deps||[]),l.deps)for(const u of l.deps){const a=n.get(u)||[];a.push(l.id),n.set(u,a)}let o=[];const r=new Map;t.forEach((l,u)=>{r.set(u,l.length),r.get(u)===0&&o.push(u)});const i=[];i.push(Object.assign([],o)),o=o.reverse();let s=[];for(;;){const l=o.pop();if(l===void 0){if(s.length===0)break;o=s.reverse(),i.push(Object.assign([],s)),s=[]}else{const u=n.get(l);if(!u)continue;for(const a of u){let f=r.get(a);f!==void 0&&(f--,r.set(a,f),f===0&&s.push(a))}}}return i}const Zn=he("div",{class:"text-h6"},"\u6DFB\u52A0\u65B0\u7684\u4EFB\u52A1\u8282\u70B9",-1),eo=$("\u6DFB\u52A0"),to=$("\u6DFB\u52A0"),no=$("\u91CD\u7F6E\u89C6\u56FE"),oo=$("\u91CD\u7F6E"),ro=ne({props:{workflowId:{type:Number,required:!0},tasks:{type:Object,required:!0},modelValue:{type:Object,default:new Array(0)}},emits:["update:modelValue"],setup(e,{expose:t,emit:n}){const o=e,r=D(!1),i=D(!1),s=D(),l=D(),u=D([]),a=D([]),f=y=>_[y].name||y,m=y=>y.join(" -> "),w=y=>y.map(v=>_[v].name).join(" -> "),h=y=>{const v=y.split(" -> ");if(v.length!==2)throw new Error(`Invalid edge name: ${y}`);return[v[0],v[1]]},k="#99F6e4",c=new Kn,d=y=>y?y.color:k,p=y=>y?y.color:k,g={view:{layoutHandler:c,scalingObjects:!1,fit:!1},node:{selectable:!0,label:{direction:Dt.NORTH,color:d},normal:{color:d},hover:{color:d},focusring:{color:k}},edge:{selectable:!0,normal:{color:p},hover:{color:p},selected:{color:p,width:4,dasharray:"10",linecap:"round",animate:!0,animationSpeed:10},marker:{source:{type:"none",width:4,height:4,margin:-1,units:"strokeWidth",color:null},target:{type:"arrow",width:4,height:4,margin:-1,units:"strokeWidth",color:null}}}},A=M(()=>{const y=()=>{var F;(F=l.value)==null||F.hide()};return{"view:load":()=>{},"view:contextmenu":F=>{const{event:C}=F;C.stopPropagation(),C.preventDefault();const B=l.value;B&&(y(),B.show(C))},"node:select":F=>{y()},"edge:select":F=>{y()}}}),_=Ke({}),j=y=>{var F;const v=(F=y.state)==null?void 0:F.currentStatus;return v==="done"?k:v==="running"?"green":v==="failed"?"red":v==="starting"?"white":"gray"},x=M(()=>{const y={};for(const v of o.modelValue)y[v.id]={id:v.id,name:v.name,color:j(v)};return y}),V=M(()=>{const y=new Map;for(const v of o.modelValue)y.set(v.id,v);return y});function I(y){for(const v of Object.keys(_))delete _[v];for(const v of Object.keys(y))_[v]=Object.assign({},y[v]);u.value=[]}const S=Ke({}),O=M(()=>{const y={};for(const v of o.modelValue)if(!!v.deps)for(const F of v.deps)y[m([F,v.id])]={source:F,target:v.id,color:j(v)};return y});function R(y){for(const v of Object.keys(S))delete S[v];for(const v of Object.keys(y))S[v]=Object.assign({},y[v]);a.value=[]}const L=D({nodes:{}}),z=M(()=>{const y={},v=Gn(o.modelValue),F=50,C=50;let B=0;for(const Z of v){let ue=0;for(const At of Z)y[At]={x:ue*F+B*F/2,y:B*C,fixed:!1},ue++;B++}return{nodes:y}});function Me(y){const v=L.value.nodes;for(const F of Object.keys(v))delete v[F];for(const F of Object.keys(y.nodes))v[F]=Object.assign({},y.nodes[F])}function Te(){I(x.value),R(O.value),Me(z.value)}function kt(y,v){let F=0,C=!1;for(const B of y){if(B.id===v){y.splice(F,1),C=!0;break}F++}if(!C)throw new Error(`Can not remove node: ${v}`);for(const B of y)if(B.deps!==void 0){const Z=B.deps.indexOf(v,0);Z>-1&&(B.deps.splice(Z,1),B.deps.length===0&&delete B.deps)}}function De(y){const v=o.modelValue.map(Ae);y.forEach(F=>kt(v,F)),n("update:modelValue",v)}function Ee(y,v){const F=o.modelValue.map(Ae);for(const C of F)if(C.id===v){C.deps||(C.deps=[]),C.deps.push(y),bt(),n("update:modelValue",F);return}throw new Error(`Can not add edge: ${m([y,v])}`)}function xt(y,v,F){for(const C of y)if(C.id===F&&C.deps!==void 0){const B=C.deps.indexOf(v,0);if(B>-1){C.deps.splice(B,1),C.deps.length===0&&delete C.deps;return}}throw new Error(`Can not remove edge: ${m([v,F])}`)}function $e(y){const v=o.modelValue.map(Ae);for(const F of y){const[C,B]=h(F);xt(v,C,B)}n("update:modelValue",v)}function bt(){a.value.splice(0,a.value.length),u.value.splice(0,u.value.length)}function Pe(){n("update:modelValue",o.tasks)}const Qe=(y,v)=>S[m([y,v])]===void 0&&S[m([v,y])]===void 0,Nt=M(()=>{const y=u.value;if(y.length===2){const[v,F]=y;return Qe(v,F)}return!1}),me=D(!1),G=D(),K=D();function Le(){me.value=!0}function Re(){G.value=void 0,K.value=void 0,me.value=!1}function Et(){var y,v,F;n("update:modelValue",[...o.modelValue,{name:(y=K.value)==null?void 0:y.name,id:`${(v=G.value)==null?void 0:v.id}_${(F=K.value)==null?void 0:F.id}`,origin:K.value}]),Re()}ie(()=>{ee(()=>o.tasks,(F,C)=>{r.value=!1,i.value=!1,v.value=void 0,Pe()}),ee(()=>o.modelValue,F=>{I(x.value),R(O.value),JSON.stringify(F)===JSON.stringify(o.tasks)&&Me(z.value),r.value=!0});function y(F,C){try{for(const B of Object.keys(F)){const Z=F[B],ue=C[B];if(Math.abs(Z.x-ue.x)>.5||Math.abs(Z.y-ue.y)>.5)return!1}}catch{return!1}return!0}const v=D();ee(()=>[L.value,s.value,r.value],([F,C,B])=>{!i.value&&C&&B&&y(F.nodes,v.value)&&setTimeout(()=>{Ce(()=>{C.panToCenter(),i.value=!0})},500),v.value=JSON.parse(JSON.stringify(Qt(L.value.nodes)))},{deep:!0})});function Ft(){De(u.value)}function It(){$e(a.value)}function jt(){const[y]=u.value,v=ke(()=>{if(u.value.length!==1)return;const[F]=u.value;y===F||!Qe(y,F)||(Ee(y,F),v())})}return t({ShowAddNodeDialog:Le,RemoveSelectedNodes:Ft,SelectedNodes:u,RemoveSelectedEdges:It,SelectedEdges:a,ResetView:Te,AddEdge:Ee,SetAddEdgeMode:jt,NodeMapTask:V}),(y,v)=>{const F=Lt("v-network-graph");return T(),ve(Pt,null,[r.value?(T(),P(F,{key:0,ref_key:"graph",ref:s,"selected-nodes":u.value,"onUpdate:selected-nodes":v[0]||(v[0]=C=>u.value=C),"selected-edges":a.value,"onUpdate:selected-edges":v[1]||(v[1]=C=>a.value=C),layouts:L.value,"onUpdate:layouts":v[2]||(v[2]=C=>L.value=C),class:$t(i.value?"":"tw-opacity-0"),nodes:N(_),edges:N(S),configs:g,"zoom-level":.75,"event-handlers":N(A)},null,8,["selected-nodes","selected-edges","layouts","class","nodes","edges","zoom-level","event-handlers"])):J("",!0),b(Yt,{modelValue:me.value,"onUpdate:modelValue":v[5]||(v[5]=C=>me.value=C),class:"tw-w-screen tw-h-screen",onHide:Re},{default:E(()=>[b(it,{class:"tw-w-96 q-pa-sm"},{default:E(()=>[b(le,null,{default:E(()=>[Zn]),_:1}),b(le,null,{default:E(()=>[b(Yn,{modelValue:G.value,"onUpdate:modelValue":v[3]||(v[3]=C=>G.value=C)},null,8,["modelValue"]),b(Xn,{modelValue:K.value,"onUpdate:modelValue":v[4]||(v[4]=C=>K.value=C),disabled:G.value===void 0,"project-id":G.value?G.value.id:0,"workflow-id":o.workflowId},null,8,["modelValue","disabled","project-id","workflow-id"])]),_:1}),b(Xt,{align:"around"},{default:E(()=>[b(q,{class:"tw-w-full tw-mx-2 tw-my-3",color:K.value?"primary":"","text-color":K.value?"black":"white",disable:!K.value,onClick:Et},{default:E(()=>[eo]),_:1},8,["color","text-color","disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),b(N(Zt),{ref_key:"viewMenu",ref:l,"touch-position":"","context-menu":""},{default:E(()=>[b(Gt,{dense:""},{default:E(()=>[re((T(),P(Y,{key:"add-task",clickable:"",onClick:Le},{default:E(()=>[b(H,null,{default:E(()=>[to]),_:1})]),_:1})),[[ae]]),N(Nt)?re((T(),P(Y,{key:"add-edge",clickable:"",onClick:v[6]||(v[6]=()=>Ee(u.value[0],u.value[1]))},{default:E(()=>[b(H,null,{default:E(()=>[$("\u6DFB\u52A0\u6307\u5411\uFF1A"+pe(w(u.value)),1)]),_:1})]),_:1})),[[ae]]):J("",!0),a.value.length>0?re((T(),P(Y,{key:"remove-edge",clickable:"",onClick:v[7]||(v[7]=()=>$e(a.value))},{default:E(()=>[b(H,null,{default:E(()=>[$(" \u5220\u9664\u6307\u5411\uFF1A"+pe(a.value.map(h).map(w).join(", ")),1)]),_:1})]),_:1})),[[ae]]):J("",!0),u.value.length>0?re((T(),P(Y,{key:"remove-task",clickable:"",onClick:v[8]||(v[8]=()=>De(u.value))},{default:E(()=>[b(H,null,{default:E(()=>[$(" \u5220\u9664\u8282\u70B9\uFF1A"+pe(u.value.map(f).join(", ")),1)]),_:1})]),_:1})),[[ae]]):J("",!0),b(st),re((T(),P(Y,{key:"reset-view",clickable:"",onClick:Te},{default:E(()=>[b(H,null,{default:E(()=>[no]),_:1})]),_:1})),[[ae]]),re((T(),P(Y,{key:"reset",clickable:"",onClick:Pe},{default:E(()=>[b(H,null,{default:E(()=>[oo]),_:1})]),_:1})),[[ae]])]),_:1})]),_:1},512)],64)}}}),ao={class:"tw-w-full tw-h-full tw-flex tw-flex-col"},lo={class:"tw-flex tw-flex-row tw-gap-4 tw-flex-wrap tw-grow-0"},io=$(" \u8FD0\u884C "),so=$(" Kill "),uo=$(" \u4FDD\u5B58 "),fo=$(" \u5237\u65B0 "),co=$(" \u91CD\u7F6E\u89C6\u56FE "),po=$(" \u6DFB\u52A0\u65B0\u4EFB\u52A1\u8282\u70B9 "),vo=$(" \u5173\u8054\u8282\u70B9 "),ho=$(" \u5220\u9664\u8282\u70B9\uFF08\u5173\u7CFB\uFF09 "),go=$(" \u4EFB\u52A1\u8BE6\u60C5 "),wo=$(" \u4EFB\u52A1\u65E5\u5FD7 "),mo={class:"tw-grow tw-w-full tw-overflow-hidden"},yo=ne({props:{id:{type:Number,required:!0}},setup(e){const t=e,{width:n}=lt(),o=M(()=>n.value<1024),r=D(),i=M(()=>r.value===void 0||r.value.SelectedNodes.length===0&&r.value.SelectedEdges.length===0),s=M(()=>{if(!r.value||r.value.SelectedNodes.length!==1)return;const j=r.value.SelectedNodes;return r.value.NodeMapTask.get(j[j.length-1])}),l=D([]),u=D([]),a=we(),f=D(!1),m=D(!1),w=D();async function h(){w.value=await Wt(t.id)}const k=M(()=>w.value!==void 0&&w.value.state!==null&&w.value.state.status==="running");async function c(j){const x=new Map,V=new Map;for(const I of j){const O=a.state.Root.workflowTasks.find(L=>L.id===I.taskId);if(O===void 0)throw new Error(`workflowTasks missing projectId=${I.projectId} taskId=${I.taskId}`);const R=`${I.projectId}_${I.taskId}`;if(V.set(R,O),x.has(R)||x.set(R,[]),I.dependencyProjectId>0&&I.dependencyTaskId!==""){const L=`${I.dependencyProjectId}_${I.dependencyTaskId}`,z=x.get(R);z!==void 0&&x.set(R,[...z,L])}}return Array.from(x.keys()).map(I=>{const S=V.get(I);if(S===void 0)throw new Error(`keyMapTask missing ${I}`);return{name:S.name,id:I,deps:x.get(I),origin:S,state:a.state.Root.workflowTaskStates.find(O=>O.projectId===S.projectId&&O.taskId===S.id)}})}function d(j){const x=[],V=new Map;for(const I of j)V.set(I.id,I.origin);for(const I of j)if(I.deps!==void 0&&I.deps.length>0)for(const S of I.deps){const O=V.get(S);if(O===void 0)throw new Error("original task object missing");x.push({id:0,workflowId:0,createTime:0,projectId:I.origin.projectId,taskId:I.origin.id,dependencyProjectId:O.projectId,dependencyTaskId:O.id})}else x.push({id:0,workflowId:0,createTime:0,projectId:I.origin.projectId,taskId:I.origin.id,dependencyProjectId:0,dependencyTaskId:""});return x}async function p(j=!1){await a.dispatch("fetchWorkflowEdges",{workflowId:t.id});const x=await c(a.state.Root.workflowEdges);j?u.value=x:l.value=x}ie(()=>{h(),p(),ee(()=>t.id,async j=>{a.dispatch("subscribeTopic",["/workflow/status/"+t.id,"/workflow/task/status/"+t.id]),await h(),await p()}),a.watch(j=>[j.Root.eventWorkFlowTask,j.Root.eventWorkFlow],async([j,x])=>{(j===void 0||j.workFlowId!==t.id)&&(x===void 0||x.workFlowId!==t.id)||(await h(),await p(!0))})});const g=M(()=>{const j=x=>x.map(V=>qe(Ue({},V),{origin:void 0,state:void 0}));return JSON.stringify(j(l.value))!==JSON.stringify(j(u.value))}),A=D(!1);async function _(){A.value=!0,await a.dispatch("updateWorkFlowEdges",{workflowId:t.id,edges:d(u.value)}),await p(),A.value=!1}return(j,x)=>(T(),ve("div",ao,[b(He,{modelValue:f.value,"onUpdate:modelValue":x[0]||(x[0]=V=>f.value=V),content:"\u786E\u5B9A\u8981\u7ACB\u5373\u6267\u884C\u5417\uFF1F",onConfirm:x[1]||(x[1]=()=>N(Rt)(N(a).getters.apiv1,t.id).then(()=>{f.value=!1,p()}))},null,8,["modelValue"]),b(He,{modelValue:m.value,"onUpdate:modelValue":x[2]||(x[2]=V=>m.value=V),type:"warning",content:"\u786E\u5B9A\u8981\u505C\u6B62\u6267\u884C\u5417\uFF1F",onConfirm:x[3]||(x[3]=()=>N(zt)(t.id).then(()=>{m.value=!1,p()}))},null,8,["modelValue"]),he("div",lo,[N(k)?(T(),P(q,{key:1,dense:N(o),color:"red",onClick:x[5]||(x[5]=V=>m.value=!0)},{default:E(()=>[so]),_:1},8,["dense"])):(T(),P(q,{key:0,dense:N(o),color:"primary","text-color":"black",loading:N(k),onClick:x[4]||(x[4]=V=>f.value=!0)},{default:E(()=>[io]),_:1},8,["dense","loading"])),b(q,{dense:N(o),color:N(g)?"primary":"","text-color":N(g)?"black":"white",disable:!N(g),loading:A.value,onClick:_},{default:E(()=>[uo]),_:1},8,["dense","color","text-color","disable","loading"]),b(q,{dense:N(o),flat:"",icon:"refresh",title:"\u5237\u65B0",onClick:x[6]||(x[6]=()=>p())},{default:E(()=>[fo]),_:1},8,["dense"]),b(q,{dense:N(o),flat:"",icon:"restart_alt",title:"\u91CD\u7F6E\u89C6\u56FE",onClick:x[7]||(x[7]=()=>r.value.ResetView())},{default:E(()=>[co]),_:1},8,["dense"]),b(q,{dense:N(o),flat:"",icon:"add",title:"\u6DFB\u52A0\u65B0\u4EFB\u52A1\u8282\u70B9",onClick:x[8]||(x[8]=()=>r.value.ShowAddNodeDialog())},{default:E(()=>[po]),_:1},8,["dense"]),N(s)!==void 0?(T(),P(q,{key:"create_relationship",dense:N(o),flat:"",icon:"north_east",title:"\u5173\u8054\u8282\u70B9",disable:!r.value||r.value.SelectedNodes.length!==1,onClick:x[9]||(x[9]=()=>{r.value.SetAddEdgeMode(),N(a).getters.$q.notify({type:"info",message:"\u8BF7\u9009\u62E9\u6709\u6548\u7684\u4E0B\u6E38\u8282\u70B9",icon:"tips_and_updates",position:"top-right"})})},{default:E(()=>[vo]),_:1},8,["dense","disable"])):J("",!0),N(s)!==void 0?(T(),P(q,{key:"delete_task_or_relationship",dense:N(o),icon:"delete",disable:N(i),title:"\u5220\u9664\u5DF2\u9009\u7684\u8282\u70B9\u53CA\u8282\u70B9\u5173\u8054\u5173\u7CFB",flat:"",onClick:x[10]||(x[10]=()=>{r.value.SelectedNodes.length>0&&r.value.RemoveSelectedNodes(),r.value.SelectedEdges.length>0&&r.value.RemoveSelectedEdges()})},{default:E(()=>[ho]),_:1},8,["dense","disable"])):J("",!0),N(s)!==void 0?(T(),P(q,{key:"jump_task_detail",dense:N(o),icon:"task_alt",flat:"",to:{name:"workflow_task",params:{projectId:N(s).origin.projectId,taskId:N(s).origin.id}}},{default:E(()=>[go]),_:1},8,["dense","to"])):J("",!0),N(s)!==void 0?(T(),P(q,{key:"jump_task_logs",dense:N(o),icon:"view_timeline",flat:"",to:{name:"workflow_task_logs",params:{projectId:N(s).origin.projectId,taskId:N(s).origin.id}}},{default:E(()=>[wo]),_:1},8,["dense","to"])):J("",!0)]),he("div",mo,[b(ro,{ref_key:"workflow",ref:r,modelValue:u.value,"onUpdate:modelValue":x[11]||(x[11]=V=>u.value=V),"workflow-id":t.id,tasks:l.value},null,8,["modelValue","workflow-id","tasks"])])]))}}),_o={key:0,class:"text-h6"},ko={key:1,class:"text-h6"},xo=ne({props:{id:{type:Number,default:0}},setup(e){const t=e,n=M(()=>({id:0,title:"",cronExpr:"0 0 0 * * * *",remark:"",createTime:0,status:Ut,state:null})),o=qt(),r=we(),i=M(()=>r.state.WorkFlow.workflows.get(t.id)),s=D(Object.assign({},i.value||n.value));function l(){s.value=Object.assign({},i.value||n.value)}ke(()=>{s.value=Object.assign({},i.value||n.value)});async function u(){const k=s.value;f.value?(await Jt(r.getters.apiv1,k.title.trim(),k.remark.trim(),k.cronExpr.trim(),k.status),o.push({name:"workflows"})):(await Kt(r.getters.apiv1,s.value),await m())}const a=at(),f=M(()=>a.name&&a.name.toString()==="create_workflow");async function m(){f.value||r.dispatch("WorkFlow/fetchWorkFlow",{id:t.id})}const w=M(()=>JSON.stringify(i.value)!==JSON.stringify(s.value)),h=M(()=>{const{title:k,cronExpr:c}=s.value;return k.trim()!==""&&c.trim()!==""});return ie(()=>{m(),ee(()=>t.id,async k=>{await m()})}),(k,c)=>(T(),P(en,{onSubmit:u,onReset:l},{default:E(()=>[b(le,null,{default:E(()=>[N(f)?(T(),ve("div",_o,"\u521B\u5EFA\u4EFB\u52A1\u7F16\u6392")):(T(),ve("div",ko,"\u4EFB\u52A1\u7F16\u6392\u8BE6\u60C5"))]),_:1}),b(le,null,{default:E(()=>[b(Ie,{modelValue:s.value.title,"onUpdate:modelValue":c[0]||(c[0]=d=>s.value.title=d),type:"text",label:"\u540D\u79F0",square:"",filled:"",class:"tw-mb-4"},null,8,["modelValue"]),b(Ie,{key:"cron",modelValue:s.value.cronExpr,"onUpdate:modelValue":c[1]||(c[1]=d=>s.value.cronExpr=d),label:"\u8C03\u5EA6\u8BA1\u5212 (*\u79D2 *\u5206 *\u65F6 *\u65E5 *\u6708 *\u5468 *\u5E74)",square:"",filled:"",class:"tw-mb-4"},null,8,["modelValue"]),b(Ie,{modelValue:s.value.remark,"onUpdate:modelValue":c[2]||(c[2]=d=>s.value.remark=d),type:"textarea",label:"\u5907\u6CE8",square:"",filled:""},null,8,["modelValue"]),b(Ht,{key:"status",modelValue:s.value.status,"onUpdate:modelValue":c[3]||(c[3]=d=>s.value.status=d),"false-value":2,"true-value":1,label:"\u662F\u5426\u542F\u7528",class:"tw-mb-4"},null,8,["modelValue"])]),_:1}),b(le,{align:"right",class:"tw-flex tw-gap-4 tw-flex-col-reverse lg:tw-flex-row lg:tw-justify-end"},{default:E(()=>[b(q,{type:"reset",flat:"",label:"\u91CD\u7F6E",class:"lg:tw-w-24 tw-w-full",disable:!N(w)},null,8,["disable"]),b(q,{color:"primary","text-color":"black",type:"submit",label:N(f)?"\u521B\u5EFA":"\u4FDD\u5B58",disable:!N(w)||!N(h),class:"lg:tw-w-24 tw-w-full"},null,8,["label","disable"])]),_:1})]),_:1}))}}),bo=$("\u5F00\u59CB\u65F6\u95F4"),No=$("\u7ED3\u675F\u65F6\u95F4"),Eo=ne({props:{id:{type:Number,required:!0}},setup(e){const t=e,n=we(),o=M(()=>n.state.Root.workflowLogs),r=M(()=>n.state.Root.workflowLogsTotal),i=M(()=>n.state.Root.loadingWorkflowLogs),s=D({sortBy:"",descending:!1,page:1,rowsPerPage:5,rowsNumber:0}),l=D();ie(()=>{Ce(()=>{var f;(f=l.value)==null||f.$el.querySelector("table.q-table").classList.add("tw-table-fixed")})});const u=()=>{Ce(()=>{var m;const f=(m=l.value)==null?void 0:m.$el.querySelector(".scroll");f==null||f.scrollTo({top:0})})};function a({pagination:{page:f,rowsPerPage:m}}){const w=s.value;w.page=f,w.rowsPerPage=m,u()}return ke(()=>{const f=s.value;f.rowsNumber=r.value}),ie(async()=>{ke(async()=>{const f=s.value;await n.dispatch("fetchWorkFlowLogs",{workflowId:t.id,page:f.page,pageSize:f.rowsPerPage})})}),(f,m)=>(T(),P(N(on),{ref_key:"table",ref:l,pagination:s.value,"onUpdate:pagination":m[0]||(m[0]=w=>s.value=w),class:"tw-w-full tw-h-full tw-bg-[#121212]","rows-per-page-options":[5,10,15],title:"\u6267\u884C\u65E5\u5FD7",rows:N(o),loading:N(i),"row-key":"id",color:"primary",flat:"","hide-header":"",onRequest:a},{loading:E(()=>[b(tn,{showing:"",color:"primary"})]),body:E(w=>[b(it,{class:"tw-my-4 tw-mx-4",flat:"",bordered:""},{default:E(()=>[b(Y,null,{default:E(()=>[b(H,null,{default:E(()=>[b(ye,{overline:""},{default:E(()=>[bo]),_:1}),b(ye,null,{default:E(()=>[$(pe(N(Ye)(w.row.startTime*1e3)),1)]),_:2},1024)]),_:2},1024),b(H,null,{default:E(()=>[b(ye,{overline:""},{default:E(()=>[No]),_:1}),b(ye,null,{default:E(()=>[$(pe(N(Ye)(w.row.endTime*1e3)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),b(st),b(le,{class:"tw-w-full tw-overflow-x-auto"},{default:E(()=>[b(nn,{json:w.row.result},null,8,["json"])]),_:2},1024)]),_:2},1024)]),_:1},8,["pagination","rows","loading"]))}}),Fo={class:"lg:tw-px-4 lg:tw-pt-2 tw-w-full tw-h-full tw-flex tw-flex-col tw-box-border"},Io={class:"tw-flex tw-h-full tw-w-full tw-overflow-hidden"},jo={class:"tw-hidden lg:tw-block"},Zo=ne({props:{id:{type:Number,default:0}},setup(e){const t=e,{width:n}=lt(),o=at(),r=M(()=>o.name&&o.name.toString()==="create_workflow"),i=M(()=>{var s;if(r.value)return"detail";if(o.name){const l=o.name.toString();if(l==="workflow_logs")return"logs";if(l==="workflow_graph")return"graph";if(l==="workflow_detail")return"detail"}throw new Error(`Unknown route name ${(s=o.name)==null?void 0:s.toString()}`)});return(s,l)=>(T(),ve("div",Fo,[N(r)?J("",!0):(T(),P(Je,{key:0,"model-value":N(i),"active-color":"primary",align:"left",class:"lg:tw-hidden tw-display"},{default:E(()=>[b(oe,{name:"graph",label:"\u6D41\u7A0B",to:{name:"workflow_graph",params:{workflowId:t.id}},replace:""},null,8,["to"]),b(oe,{name:"logs",label:"\u65E5\u5FD7",to:{name:"workflow_logs",params:{workflowId:t.id}},replace:""},null,8,["to"]),b(oe,{name:"detail",label:"\u8BE6\u60C5",to:{name:"workflow_detail",params:{workflowId:t.id}},replace:""},null,8,["to"])]),_:1},8,["model-value"])),he("div",Io,[b(Mt,{"model-value":N(i),animated:"",vertical:N(n)>=1024,class:"tw-w-full tw-h-full tw-bg-[#121212] tw-p-0 lg:tw-pr-4 tw-box-border"},{default:E(()=>[b(Fe,{name:"graph"},{default:E(()=>[b(yo,{id:t.id},null,8,["id"])]),_:1}),b(Fe,{name:"logs"},{default:E(()=>[b(Eo,{id:t.id},null,8,["id"])]),_:1}),b(Fe,{name:"detail"},{default:E(()=>[b(xo,{id:t.id},null,8,["id"])]),_:1})]),_:1},8,["model-value","vertical"]),he("div",jo,[N(r)?J("",!0):(T(),P(Je,{key:0,"model-value":N(i),"active-color":"primary",vertical:"","switch-indicator":"",align:"left"},{default:E(()=>[b(oe,{name:"graph",label:"\u6D41\u7A0B",to:{name:"workflow_graph",params:{workflowId:t.id}},replace:""},null,8,["to"]),b(oe,{name:"logs",label:"\u65E5\u5FD7",to:{name:"workflow_logs",params:{workflowId:t.id}},replace:""},null,8,["to"]),b(oe,{name:"detail",label:"\u8BE6\u60C5",to:{name:"workflow_detail",params:{workflowId:t.id}},replace:""},null,8,["to"])]),_:1},8,["model-value"]))])])]))}});export{Zo as default};
